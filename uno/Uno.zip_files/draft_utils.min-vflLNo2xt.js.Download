define(["require","exports","draft-js","punycode","immutable"],function(e,t,n,r,o){"use strict";function a(e){return 0===e.getCurrentContent().getPlainText().length}function c(e){return e.getSelection().getHasFocus()}function i(e,t){return n.EditorState.forceSelection(n.EditorState.push(e,t,"insert-fragment"),t.getSelectionAfter())}function u(e,t,r,o,a,c){return n.Modifier.replaceText(e,n.SelectionState.createEmpty(t).merge({anchorOffset:r,focusOffset:o}),a,void 0,c)}function l(e,t,n){for(var r,o,a,c=t.getText();null!==(r=e.exec(c));)o=r.index,a=r[0].length,c=c.substring(o+a),n(o,o+a)}function d(e,r){var o=null,a=null,c=e.start,i=e.end,u=null,l=null,d=0;if(r.getBlockMap().forEach(function(e,n){if(e&&"atomic"!==e.getType()){var r=t.decodeUnicode(e.getText());if(n&&null===o&&c<d+r.length){o=n;var f=c-d;u=t.encodeUnicode(r.slice(0,f)).length}if(n&&null===a&&i<=d+r.length){a=n;var f=i-d;l=t.encodeUnicode(r.slice(0,f)).length}d+=r.length}return o&&a}),!o||!a)throw"Bad range";return n.SelectionState.createEmpty(o).merge({anchorKey:o,anchorOffset:u,focusKey:a,focusOffset:l})}function f(e){return e.match(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}function s(e){if("img"===e.tagName.toLowerCase()){var t=e.getAttribute("data-emoji-ch");if(t){var n=document.createElement("span");return n.textContent=t,n}}return e}function g(e){var t=e.style,n=e.tagName.toLowerCase(),r=[];return(parseInt(t.fontWeight||"0")>=600||"bold"===t.fontWeight||"b"===n||"strong"===n)&&(r=r.concat(["BOLD"])),"underline"!==t.textDecoration&&"u"!==n||(r=r.concat(["UNDERLINE"])),"strikethrough"!==t.textDecoration&&"s"!==n&&"strike"!==n||(r=r.concat(["STRIKETHROUGH"])),"italic"!==t.fontStyle&&"i"!==n&&"em"!==n||(r=r.concat(["ITALIC"])),r}function h(e,t,n){if(e.hasAttribute("data-entity-key")&&e.getAttribute("data-editor")===n){var r=e.getAttribute("data-entity-key");try{return t.getEntity(r),r}catch(e){return null}}}function m(e){var t=e.html,r=e.contentState,a=e.editorKey,c=e.elementMappers,i=void 0===c?[]:c,u=document.createElement("body");u.innerHTML=t;var l=[],d=u.textContent||"",f=Array(d.length),s=[0,0],m="",y=function(e){void 0===e&&(e="unstyled");var t=f.slice(s[0],s[1]);l=l.concat([(new n.ContentBlock).merge({type:e,key:n.genKey(),text:m,characterList:o.List(t)})]),m="",s=[s[1],s[1]]},p=function(e){return function(t){switch(t.nodeType){case Node.TEXT_NODE:if(t.textContent){var c=n.CharacterMetadata.create(e),u=t.textContent;m+=u;for(var l=0;l<u.length;l++,s[1]++)f[s[1]]=c}break;case Node.ELEMENT_NODE:var d=i.reduce(function(e,t){return t(e)},t);if(d.childNodes.length){var E=e?e.style.toArray():[],v=e?e.entity:null,x=d.tagName.toLowerCase(),b="true"===d.getAttribute("data-block")||["p","li","blockquote","pre"].concat([1,2,3,4,5,6].map(function(e){return"h"+e})).indexOf(x)!==-1;E=E.concat(g(d)),v=h(d,r,a)||v;var T={style:o.OrderedSet(E)};v&&(T.entity=v),Array.from(d.childNodes).forEach(p(T)),b&&y()}}}};return Array.from(u.childNodes).forEach(p()),0===l.length&&y(),o.OrderedMap(l.map(function(e){return[e.getKey(),e]}))}Object.defineProperty(t,"__esModule",{value:!0}),t.contentIsEmpty=a,t.hasFocus=c,t.replaceContent=i,t.replaceText=u,t.findWithRegex=l,t.locationToSelection=d,t.parseEmail=f,t.decodeUnicode=function(e){return r.ucs2.decode(e)},t.encodeUnicode=function(e){return r.ucs2.encode(e)},t.paperEmojiMapper=s,t.htmlToFragment=m,t.mergeBlockDataByKey=function(e,t,r){var o,a=e.getCurrentContent(),c=a.getBlockForKey(t).mergeIn(["data"],r),i=a.getBlockMap().merge((o={},o[t]=c,o));return n.EditorState.push(e,a.merge({blockMap:i}),"change-block-data")}});
//# sourceMappingURL=draft_utils.min.js-vflYVpDW5.map