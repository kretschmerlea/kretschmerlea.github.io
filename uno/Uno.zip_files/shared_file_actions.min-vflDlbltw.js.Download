define(["require","exports","tslib","external/prop-types","react","modules/clean/abuse/report_flag","modules/clean/previews/util","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/more_dropdown","modules/clean/react/size_class/constants","modules/clean/react/open_in_app/button","modules/clean/react/paper/open_in_paper_button","modules/clean/react/share_download/button","modules/clean/react/share_download/util","modules/clean/cloud_docs/edit_now_button","modules/clean/react/sign_in/button","modules/clean/react/title_bar/controls_container","modules/clean/react/user_notifications/dropdown","modules/clean/sharing/api/client","modules/clean/sharing/delete_link_modal","modules/core/browser","modules/clean/react/paper/utils","modules/clean/sharing/constants","modules/clean/react/extensions/extensions_menu_component"],function(e,n,t,o,r,i,a,l,s,u,c,p,d,h,m,f,_,k,w,v,P,g,C,y,L){"use strict";function B(e){return function(){return l.logUserAction(e,s.UserActionContext.TitleBarMain)}}Object.defineProperty(n,"__esModule",{value:!0}),o=t.__importDefault(o),r=t.__importDefault(r),g=t.__importStar(g);var I=(function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.removeShareLink=function(){var e=new v.ShareApiClient({userId:n.props.sharePermission.canRemoveLinkUids[0]});return P.deleteLinkWithConfirmLegacy({client:e,contentName:n.props.file.filename,onCancel:null,onDeleteLink:function(){return g.redirect("/home")},tkey:n.getTkey()})},n}return t.__extends(n,e),n.prototype.getTkey=function(){return this.props.sharePermission&&this.props.sharePermission.canRemoveLinkUids.length>0?this.props.shareToken.linkKey:null},n.prototype.render=function(){var e=this.props,n=e.sizeClass,t=e.file,o=e.shouldDisplayActionButtons,i=e.user,a=e.sharePermission,l=e.sharedLinkInfo,s=e.shareToken;return n!==c.SizeClass.Large?r.default.createElement(u.MoreDropdown,{allowRemoveLink:!!this.getTkey()&&o,file:t,isPrivate:!1,onRemoveShareLink:this.removeShareLink,renderSignIn:!i,sizeClass:n,shareDownloadOptions:o?m.getDownloadOptions(a,l,s,t,this.context.authModalKind||null):[]}):r.default.createElement(u.MoreDropdown,{allowRemoveLink:!!this.getTkey(),file:t,isPrivate:!1,onRemoveShareLink:this.removeShareLink,sizeClass:n,user:i||void 0,sharedLink:l.url,showOpenInPaper:C.getOpenInPaperButtonVariant({file:t,user:i,sharedLink:l.url})===C.OpenInPaperButtonVariant.Ellipsis})},n})(r.default.PureComponent);n.SharedFileMoreDropdown=I;var D=(function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={openInPaperButtonVariant:C.OpenInPaperButtonVariant.Off},n.isDownloadAllowed=function(){return n.props.sharePermission&&n.props.sharePermission.canDownloadRoles.length>0&&!a.isCloudDocPreview(n.props.file)},n}return t.__extends(n,e),n.prototype.componentDidMount=function(){this.setState({openInPaperButtonVariant:C.getOpenInPaperButtonVariant({file:this.props.file,user:this.props.user,sharedLink:this.props.sharedLinkInfo.url})})},n.prototype.render=function(){var e=this.props,n=e.file,o=e.sharedLinkInfo,l=e.sharePermission,u=e.shareToken,m=e.showOpenInAppButton,v=e.shouldDisplayActionButtons,P=e.sizeClass,g=e.user;if(P!==c.SizeClass.Large)return r.default.createElement(I,t.__assign({},this.props));var D=this.isDownloadAllowed()&&this.state.openInPaperButtonVariant===C.OpenInPaperButtonVariant.Button?r.default.createElement(d.OpenInPaperButton,{file:n,user:g,sharedLink:o.url,hideCallout:!1}):null,E=g?r.default.createElement("div",{className:"control__button"},r.default.createElement(L.ExtensionsMenuNoUnity,{file:n,user:g})):null,S=function(e){return e.linkType===y.SharedLinkType.Content};return r.default.createElement(k.TitleBarControlsContainer,null,o.hasPublicAudienceOrVisibility!==!1?r.default.createElement(i.ReportFlag,{sharedLink:o.url}):null,m&&v?r.default.createElement(p.OpenInAppButton,{urls:this.props.file.open_in_app_data,userActionContext:s.UserActionContext.TitleBarMain}):null,!g&&a.isCloudDocPreview(n)?r.default.createElement(f.EditNowButton,{isPrimaryButton:!m,onClick:B(s.UserAction.SignIn),hideCallOut:!1}):null,g||a.isCloudDocPreview(n)?null:r.default.createElement(_.SignInButton,{isPrimaryButton:!m,onClick:B(s.UserAction.SignIn)}),v&&S(u)?E:null,v?D:null,u&&l&&v&&!a.isCloudDocPreview(n)?r.default.createElement(h.ShareDownloadButton,{copyable:n,location:s.FileViewerPane.PreviewContent,sharedLinkInfo:o,sharePermission:l,shareToken:u,user:g}):null,r.default.createElement(I,t.__assign({},this.props)),g?r.default.createElement("div",{className:"react-title-bar__divider"}):null,g&&!g.is_guest_admin?r.default.createElement(w.UserNotificationsDropdown,{isPagelet:!1,onClick:B(s.UserAction.ClickNotifications)}):null)},n.defaultProps={user:null},n.contextTypes={authModalKind:o.default.oneOf(["download","immediate",null])},n})(r.default.Component);n.SharedFileActions=D});
//# sourceMappingURL=shared_file_actions.min.js-vflk6859k.map