define(["require","exports","tslib","react","draft-js","spectrum_comments/comment_editor/components/readonly_draft_component","spectrum_comments/comment_editor/core/editor_component"],function(t,e,n,o,r,i,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s;(function(t){t[t.ENTER=13]="ENTER",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN"})(s||(s={}));var l=[s.ESC,s.SPACE,s.UP,s.RIGHT,s.DOWN],d=(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollClassName="sc-comment-editor-draft",e.onChange=function(t){e.triggers.draft.change(t)},e.handleReturn=function(t,n){if(t.metaKey||t.ctrlKey){return!(""===n.getCurrentContent().getPlainText().trim())&&e.triggers.comment&&(e.blurEditor(),e.triggers.comment.post(n)),"handled"}return e.triggers.draft.returnKey(t).editorState!==n||e.status.macro.active?(t.preventDefault(),"handled"):"not-handled"},e.onScroll=function(t){if(e.status.macro.macroRef){var n=e.triggers.macro.updateVisibility,o=t.target;n(e.getMacroVisibilityFromScrollEl(o))}},e.keyBindingFn=function(t){if(e.isNavigationalKeyboardEvent(t)){var n=e.status.suggestion;if(!e.isVacuousSuggestion(n)&&(e.triggers.draft.key(t),n!==e.status.suggestion))return t.preventDefault(),null}return r.getDefaultKeyBinding(t)},e.handleKeyCommand=function(t,n){return e.triggers.draft.keyCommand(t).editorState===n?"not-handled":"handled"},e.handleBeforeInput=function(t,n){return e.triggers.draft.input(t).editorState===n?"not-handled":"handled"},e.handlePastedText=function(t,n,o){var r=o;return r=e.triggers.draft.pasteText(t).editorState,n&&r===o&&(r=e.triggers.draft.pasteHTML({text:t,html:n}).editorState),r===o?"not-handled":"handled"},e.handleCompositionStart=function(t){e.triggers.draft.compositionStart(t)},e.handleCompositionEnd=function(t){e.triggers.draft.compositionEnd(t)},e.onKeyDown=function(t){if(e.isNavigationalKeyboardEvent(t)){var n=e.status.suggestion;e.triggers.draft.key(t),e.status.suggestion!==n&&t.preventDefault()}else t.which===s.SPACE?e.triggers.draft.key(t):t.which===s.ENTER&&e.status.macro.active&&t.preventDefault()},e.onFocus=function(t){e.triggers.macro.updateVisibility(e.getMacroVisibilityFromScrollEl(e.getScrollEl(t.target))),e.triggers.draft.focus(t)},e.onBlur=function(t){e.triggers.macro.updateVisibility(!1),e.triggers.draft.blur(t)},e.onTab=function(t){e.triggers.draft.key(t)},e.blockRendererFn=function(t){var n=t.getType();if(n&&e.status.draft.blockRenderers[n])return e.status.draft.blockRenderers[n](t)},e}return n.__extends(e,t),e.prototype.blurEditor=function(){this.editor.blur()},e.prototype.focusEditor=function(){this.editor.focus()},e.prototype.getMacroVisibilityFromScrollEl=function(t){if(!this.status.macro.macroRef)return!1;var e=t.getBoundingClientRect(),n=this.status.macro.macroRef.getBoundingClientRect();return n.bottom<e.bottom&&n.top>e.top},e.prototype.getScrollEl=function(t){if(null===t)throw new Error("Unable to find scroll element");return t.classList.contains(this.scrollClassName)?t:this.getScrollEl(t.parentElement)},e.prototype.isVacuousSuggestion=function(t){return 0===t.totalSuggestions},e.prototype.isNavigationalKeyboardEvent=function(t){var e=t.which;return l.indexOf(e)>-1},e.prototype.componentDidUpdate=function(t){var e=t.shouldFocus;this.props.shouldFocus&&!e&&this.editor&&this.focusEditor()},e.prototype.render=function(){var t=this,e=this.status.draft,r=e.editorState,a=e.readOnly,s=e.placeholder,l=e.isComposing,d=this.props,c=d.annotation,u=d.spellCheck,g=d.a11yEditorLabel,f={ariaLabel:g,readOnly:a,onFocus:this.onFocus,onBlur:this.onBlur,onChange:this.onChange,onTab:this.onTab,handleReturn:this.handleReturn,keyBindingFn:this.keyBindingFn,handleKeyCommand:this.handleKeyCommand,handleBeforeInput:this.handleBeforeInput,handlePastedText:this.handlePastedText,blockRendererFn:this.blockRendererFn},h=""===r.getCurrentContent().getPlainText(),m=h&&!l?o.createElement("span",{className:"sc-comment-editor-placeholder"},s):void 0;return o.createElement("div",{className:this.scrollClassName,onScroll:this.onScroll,onKeyDown:this.onKeyDown,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd},o.createElement(i.ReadonlyDraftComponent,n.__assign({draftRef:function(e){t.editor=e}},f,{annotation:c,editorPlaceholder:m,spellCheck:u})))},e})(a.EditorComponent);e.DraftComponent=d});
//# sourceMappingURL=draft_component.min.js-vfl9cIAJm.map