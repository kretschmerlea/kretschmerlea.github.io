define(["require","exports","tslib","react","external/react-redux","modules/clean/react/file_viewer/logging","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/more_dropdown","modules/clean/react/file_viewer/open_button/open_button","modules/clean/react/title_bar/controls_container","modules/clean/react/user_notifications/dropdown","modules/clean/sharing/api/client","modules/clean/sharing/delete_link_modal","modules/clean/react/size_class/constants","modules/core/browser_detection","modules/clean/react/paper/utils","modules/clean/react/app_actions/app_actions_menu","modules/clean/react/extensions/client","modules/clean/react/file_viewer/data/selectors","modules/clean/react/file_viewer_sidebar/render_utils/call_to_action","modules/clean/react/file_viewer/share_button"],function(e,t,n,i,o,r,a,s,l,u,c,p,d,f,h,m,_,v,C,S,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=n.__importDefault(i);var w=function(e){return{extensionsConfig:C.getExtensionsConfig(e)}},I=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.cancelGetSharedLinkInfo=function(){},t.handleShareMenuItemClick=function(){k.handleShareClick(t.props.file,t.props.user)},t.removeShareLink=function(){var e=new p.ShareApiClient({userId:t.props.user.id}),n=t.state.linkMetadata,i=n.name,o=n.url;d.deleteLinkWithConfirm({client:e,contentName:i,onCancel:null,onDeleteLink:function(){return t.setState({linkMetadata:void 0})},url:o})},t}return n.__extends(t,e),t.prototype.setupShare=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,i,o;return n.__generator(this,function(n){switch(n.label){case 0:return e=!1,this.cancelGetSharedLinkInfo=function(){e=!0},t=new p.ShareApiClient({userId:this.props.user.id}),[4,t.sharedLinkInfo({fileIdOrPath:this.props.file.fq_path})];case 1:return i=n.sent(),o=i[0],e||this.setState({linkMetadata:o}),this.cancelGetSharedLinkInfo=function(){},[2]}})})},t.prototype.componentDidMount=function(){this.setupShare()},t.prototype.componentDidUpdate=function(e){e.file!==this.props.file&&(this.cancelGetSharedLinkInfo(),this.setState({linkMetadata:void 0}),this.setupShare())},t.prototype.componentWillUnmount=function(){this.cancelGetSharedLinkInfo()},t.prototype.render=function(){var e=this.props,t=e.file,n=e.extensionsConfig,o=e.sizeClass,r=e.user,a=!!this.state.linkMetadata&&this.state.linkMetadata.link_permissions.can_revoke,l=o===f.SizeClass.Small,u=m.getOpenInPaperButtonVariant({file:t,user:r});return i.default.createElement(s.MoreDropdown,{allowRemoveLink:a,isPrivate:!0,file:t,onClickShareLink:this.handleShareMenuItemClick,onRemoveShareLink:this.removeShareLink,sizeClass:o,user:r,showOpenInPaper:u===m.OpenInPaperButtonVariant.Ellipsis&&!l,extensionsConfig:n})},t})(i.default.PureComponent);t.UnconnectedMountedFileMoreDropdown=I,t.MountedFileMoreDropdown=o.connect(w)(I);var M=(function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(o,e),o.getDerivedStateFromProps=function(e){return{openInPaperButtonVariant:m.getOpenInPaperButtonVariant({file:e.file,user:e.user})}},o.prototype.logUserActionInTitleBarFactory=function(e){return function(){return r.logUserAction(e,a.UserActionContext.TitleBarMain)}},o.prototype.render=function(){var e=this.props,n=e.file,o=e.extensionsConfig,r=e.sizeClass,s=e.shouldDisplayActionButtons,p=e.user;if(r!==f.SizeClass.Large){var d=null;return s&&!h.is_mobile_or_tablet()&&r!==f.SizeClass.Small&&(o.displayState===v.DisplayState.ENABLED?d=i.default.createElement("div",{className:"control__button"},i.default.createElement(_.ExtensionsMenu,{user:p,file:n,showAsButtonIfDownloadOnly:!0,hasOpenInPaperSupport:this.state.openInPaperButtonVariant===m.OpenInPaperButtonVariant.Dropdown,telemetryContext:{surface:"previews"},showBigTooltip:!0,onPresentInZoom:function(){return k.handlePresentInZoom(n,p)}})):o.displayState===v.DisplayState.DISABLED&&(d=i.default.createElement(l.OpenButton,{file:n,location:a.FileViewerPane.TitleBar,user:p}))),i.default.createElement(u.TitleBarControlsContainer,null,d,i.default.createElement(t.MountedFileMoreDropdown,{file:this.props.file,user:this.props.user,sizeClass:this.props.sizeClass}))}var C;s&&(C=S.renderMountedFileActions(n,p,r,o));var w=p.is_guest_admin?"":i.default.createElement(c.UserNotificationsDropdown,{isPagelet:!1,onClick:this.logUserActionInTitleBarFactory(a.UserAction.ClickNotifications)});return i.default.createElement(u.TitleBarControlsContainer,null,C,i.default.createElement(t.MountedFileMoreDropdown,{file:this.props.file,user:this.props.user,sizeClass:this.props.sizeClass}),i.default.createElement("div",{className:"react-title-bar__divider"}),w)},o})(i.default.Component);t.UnconnectedMountedFileActions=M,t.MountedFileActions=o.connect(w)(M)});
//# sourceMappingURL=mounted_file_actions.min.js-vflDlNljf.map