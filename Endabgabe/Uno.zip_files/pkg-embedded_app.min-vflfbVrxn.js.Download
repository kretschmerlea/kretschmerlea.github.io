define("external/deep-freeze",["require","exports","module"],function(e,t,r){r.exports=function e(t){return Object.freeze(t),Object.getOwnPropertyNames(t).forEach(function(r){!t.hasOwnProperty(r)||null===t[r]||"object"!=typeof t[r]&&"function"!=typeof t[r]||Object.isFrozen(t[r])||e(t[r])}),t}}.bind(Object.create(null))),define("modules/clean/accessibility/utils",["require","exports","modules/clean/keycode"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.accessibleColorPalette=["#006AFF","#0073E1","#007BC3","#007F9B","#008578","#008750","#008928","#008800","#0573EB","#0579C3","#0580A0","#05857D","#058655","#058932","#05890A","#0A71F0","#0A78CD","#0A7FAA","#0A8487","#0A855F","#0A8737","#0A880F","#0F6EF5","#0F76D7","#0F7DB4","#0F818C","#0F8669","#0F8741","#0F8819","#146DFF","#1475DC","#147BBE","#14819B","#148473","#14864B","#148723","#1969FF","#1972E1","#1979C3","#1980A0","#198278","#198550","#198728","#198700","#1E70E6","#1E79C8","#1E7FA5","#1E837D","#1E8555","#1E8832","#1E880A","#236EEB","#2376D2","#237CAF","#238187","#23845F","#23883C","#238914","#286DF5","#2876D7","#287CB4","#28808C","#288469","#288541","#288619","#2D6AFA","#2D73DC","#2D7BB9","#2D8096","#2D836E","#2D8446","#2D8823","#3267FF","#3271E1","#3279C3","#327D9B","#328378","#328550","#328528","#328600","#376EE6","#3777C8","#377DA5","#37807D","#37855A","#378632","#37860A","#3C6CEB","#3C74CD","#3C7BAA","#3C8087","#3C835F","#3C8437","#3C8614","#416AF5","#4173D7","#4179B9","#417E91","#418069","#418341","#418419","#4667FA","#466FDC","#4676BE","#467B9B","#468073","#46824B","#468423","#4B63FF","#4B6DE1","#4B75BE","#4B7B9B","#4B8078","#4B8150","#4B8228","#4B8300","#5069E6","#5072C8","#5079A5","#507C7D","#50815A","#508232","#50830A","#5567F0","#556FD2","#5575AA","#557A87","#557E5F","#55823C","#558314","#5A65F5","#5A6DD7","#5A75B4","#5A7A91","#5A7D69","#5A7F41","#5A821E","#5F61FA","#5F69DC","#5F71BE","#5F779B","#5F7E50","#5F7F28","#5F8100","#6466E6","#646DC3","#6475A5","#647D55","#647E2D","#648005","#6964EB","#696BC8","#6972A5","#697C55","#697E2D","#697F05","#6E62EB","#6E6AC8","#6E71A5","#6E7C46","#6E7E1E","#7358FF","#7363E1","#736ABE","#7372A0","#785CEB","#7864CD","#786DAF","#7D53FF","#7D5EE1","#7D66C3","#7D6EA0","#8255F5","#825FD7","#8268B9","#826D91","#8756F0","#8760D2","#8766AA","#8C4AFF","#8C56E6","#8C60C8","#8C66A0","#914BF5","#9157DC","#9160BE","#916596","#964BEB","#9655D2","#965EAF","#966691","#9B47F0","#9B51D2","#9B5CB4","#9B6191","#A041F5","#A04EDC","#A058B9","#A06196","#A53BF5","#A548DC","#A553BE","#A55A96","#AA34FA","#AA42E6","#AA4FC8","#AA58A0","#AA5F78","#AA614B","#AA6623","#AF29FF","#AF38E6","#AF47D2","#AF52AF","#AF5782","#AF5E5A","#AF622D","#AF6400","#B42CF0","#B43CD7","#B447B4","#B45291","#B45864","#B45D37","#B45D05","#B919FF","#B92CE6","#B93BC8","#B94AAA","#B9547D","#B95B4B","#B95A14","#BE0CF0","#BE1FEB","#BE31CD","#BE41B4","#BE4C87","#BE5455","#BE561E","#C307EB","#C31AE1","#C32CC8","#C33DB4","#C3488C","#C34F5A","#C35428","#C803E1","#C816E1","#C826C3","#C836AF","#C8428C","#C8495F","#C84F32","#C85200","#CD11C8","#CD22C8","#CD31AF","#CD3B87","#CD4664","#CD4B37","#CD4D0A","#D20CC3","#D21CB4","#D229A0","#D23587","#D23E64","#D23F37","#D2430F","#D708AF","#D716A0","#D72291","#D73087","#D7355F","#D73A3C","#D73A14","#DC0596","#DC119B","#DC1D91","#DC256E","#DC2E5A","#DC343C","#DC3419","#E1027D","#E10C87","#E11882","#E11B5A","#E12755","#E12A37","#E12919","#E13200","#E6075F","#E60C4B","#E61655","#E61D46","#E62132","#E61B14","#E61A00","#EB0232","#EB0214","#EB0D30"],t.accessibleTriggerProps=function(e,t){return void 0===t&&(t="button"),{role:t,tabIndex:0,onClick:function(t){return e(t)},onKeyDown:function(t){if(t.keyCode===r.KeyCode.ENTER||t.keyCode===r.KeyCode.SPACE)return e(t)}}}}),define("modules/clean/ajax_minimal",["require","exports"],function(e,t){"use strict";function r(e){var t=document.cookie.match("(^|; )"+e+"=([^;]*)");return t?t[2]:""}function n(e,t){var n=new XMLHttpRequest;n.open("POST",e),n.withCredentials=!0,n.setRequestHeader("X-CSRF-Token",r("__Host-js_csrf")),n.send(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.post=n}),define("modules/clean/browse_uri_interface",["require","exports","modules/clean/previews/data/preview_type_util","modules/clean/react/browse/uri_helper","modules/clean/viewer","modules/core/uri"],function(e,t,r,n,s,o){"use strict";function i(e){return n.browse_root(s.Viewer.get_viewer(),e)}function a(e,t){return"/"!==t.charAt(0)&&(t="/"+t),new o.URI({scheme:"https",authority:"www.dropbox.com",path:"/preview"+t,query:{role:e.role}})}function c(e,t){var n;if(t.is_dir&&(n=i(e)+o.URI.encode_parts(t.fq_path)),t.preview&&r.isCloudDoc(t.preview)){n=t.preview.content.exit_url||t.href}return n||(n=a(e,t.fq_path).toString()),n}function l(e,t){return new o.URI({scheme:"https",authority:"www.dropbox.com",path:""+i(e)+t})}Object.defineProperty(t,"__esModule",{value:!0}),t.get_browse_root=i,t.preview_uri_for_fq_path=a,t.href_for_file=c,t.browse_uri_for_fq_path=l}),define("modules/clean/filetypes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.FILE=1]="FILE",e[e.FOLDER=2]="FOLDER",e[e.PACKAGE=3]="PACKAGE",e[e.SHARED_FOLDER=4]="SHARED_FOLDER",e[e.SANDBOX=5]="SANDBOX",e[e.TEAM_SHARED_FOLDER=6]="TEAM_SHARED_FOLDER",e[e.TEAM_MEMBER_FOLDER=7]="TEAM_MEMBER_FOLDER"})(t.FileTypes||(t.FileTypes={}))}),define("modules/clean/history",["require","exports","tslib","external/lodash","modules/core/exception","modules/core/uri","modules/clean/ux_analytics/UxAnalyticsDispatcher","modules/core/browser"],function(e,t,r,n,s,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),a=r.__importStar(a);var c=(function(){function e(){i.UxAnalyticsDispatcher.dispatchHistoryChange(a.get_href())}var t=new RegExp("#|;|\\?|:|@|&|=|\\+|\\$"),r=function(){var e=window.location.pathname,r=window.location.search;return e.search(t)!==-1&&(e=String(new o.URI({path:e}))),e+r},c=function(){var e=o.URI.parse(r());return e.setPath(o.URI.encode_parts(e.getPath())),e},l=function(e,t){return null==t&&(t=void 0),String(o.URI.parse(e).setQuery(t))},u=function(e){return void 0===e&&(e=r()),{url:e,path:e.split("?")[0],qargs:o.URI.parse(e).getQuery()}},_={},p={},d=r(),h=null,E="",S=function(e){return E+"/"+e.substring(E.length).split("/")[1]},m=function(e){return E=e},f=function(e){var t=d,r=u(t),n=S(r.path);if(n in e){var s=r.path.substr(n.length+1);return Array.from(e[n]).map(function(e){return e(s,r.qargs)})}},g=function(){return f(_)},C=function(){return f(p)},R=function(e,t,r){if(r[e]){var n=r[e].indexOf(t);return r[e].splice(n,1)}},I=function(e,t){if(S(e)!==S(t))return C()},T=function(){var t=r();t!==d&&(I(d,t),d=t,g(),e())};return i.UxAnalyticsDispatcher.initUrl(a.get_href()),{init:function(){if(!h)return d=r(),h=setInterval(T,50)},_add_callback:function(e,t,r){return this.init(),s.assert("string"==typeof e,"DBHistory prefix is not a string"),s.assert(0===e.indexOf("/"),"DBHistory prefix must be absolute"),s.assert(e.substring(E.length).indexOf("/",1)===-1,"multi-component prefixes arent supported"),r[e]||(r[e]=[]),r[e].push(t)},add_callback:function(e,t,r){if(void 0===r&&(r=!1),this._add_callback(e,t,_),!r)return g()},remove_callback:function(e,t){return R(e,t,_)},remove_exit_callback:function(e,t){return R(e,t,p)},add_exit_callback:function(e,t){return this._add_callback(e,t,p)},fire_callbacks:function(){return g()},fire_exit_callbacks:function(){return C()},_build_url_for_state_change:function(e,t){return s.assert("string"==typeof e,"DBHistory path is not a string"),s.assert(0===e.indexOf("/"),"DBHistory path must be absolute"),s.assert(e.indexOf("//")===-1,"DBHistory path contains //"),l(e,t)},_pre_state_change:function(e){return e!==d&&(I(d,e),!0)},_post_state_change:function(e){if(void 0===e&&(e=!0),d=r(),e)return g()},replace_state:function(t,r,s){void 0===s&&(s={}),s=n.defaults(s,{immediatelyRestoreState:!0});var o=this._build_url_for_state_change(t,r);this._pre_state_change(o)&&window.history.replaceState&&(window.history.replaceState(null,null,o),this._post_state_change(s.immediatelyRestoreState),e())},push_state:function(t,r,o){null==o&&(o={}),o=n.defaults(o,{immediatelyRestoreState:!0}),s.assert(t.indexOf("?")===-1,"DBHistory path contains ?"),s.assert(t.indexOf("#")===-1,"DBHistory path contains #");var i=this._build_url_for_state_change(t,r);this._pre_state_change(i)&&(window.history.pushState(null,null,i),this._post_state_change(o.immediatelyRestoreState),e())},update_query_param:function(e,t){var r=this.deconstruct_url();return r.qargs[e]=t,this.replace_state(r.path,r.qargs)},remove_query_param:function(e){var t=this.deconstruct_url();return delete t.qargs[e],this.replace_state(t.path,t.qargs)},reset:function(){[_,p].forEach(function(e){Object.keys(e).forEach(function(t){e[t].forEach(function(r){R(t,r,e)})})}),d=r(),h=null,E=""},get_url:r,get_uri:c,construct_url:l,deconstruct_url:u,set_base_prefix:m,URL_ESCAPE_REGEX:t}})();t.default=c}),define("modules/clean/immutability_helper",["require","exports","tslib","external/deep-freeze"],function(e,t,r,n){"use strict";function s(e){if(null==e)throw new TypeError("Cannot thaw null/undefined object");if(Array.isArray(e))return S.call(e);for(var t=Object.create(Object.getPrototypeOf(e)),r=Object.getOwnPropertyNames(e),n=0,s=r;n<s.length;n++){var o=s[n],i=Object.getOwnPropertyDescriptor(e,o);i&&(i.get||i.set)?(i.configurable=!0,Object.defineProperty(t,o,i)):t[o]=e[o]}return t}function o(e,t){var r=s(e);return t(r),n.default(r)}function i(e,t){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));return t.reduce(function(e,t){return null==e?null:e[t]},e)}function a(e,t,r){if(null==e)throw new TypeError("Object to `set` cannot be null");if(e[t]===r)return e;var o=s(e);return o[t]=r,n.default(o)}function c(e,t,r){return a(e,t,r(e[t]))}function l(e,t,r){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));if(null==e)throw new TypeError("Target object cannot be null");var n=t[0];return 1===t.length?c(e,n,r):a(e,n,l(e[n],t.slice(1),r))}function u(e,t,r){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));if(null==e)throw new TypeError("Target object cannot be null");var n=t[0];switch(t.length){case 1:return a(e,n,r);default:return a(e,n,u(e[n]||{},t.slice(1),r))}}function _(e,t){if(null==e||null==t)throw new TypeError("Both target and source cannot be null");var r=Object.keys(t).reduce(function(r,n){return t[n]!==e[n]&&r.push(n),r},[]);if(r.length){for(var o=s(e),i=0,a=r;i<a.length;i++){var c=a[i],l=Object.getOwnPropertyDescriptor(t,c);void 0!==l&&Object.defineProperty(o,c,l)}return n.default(o)}return e}function p(e,t,r){if(null==e||null==r)throw new TypeError("Both target and source cannot be null");return l(e,t,function(e){return _(e,r)})}function d(e,t,r){for(var s=[],o=3;o<arguments.length;o++)s[o-3]=arguments[o];var i=S.call(e);return i.splice.apply(i,[t,r].concat(s)),n.default(i)}function h(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var s=S.call(e);return s.unshift.apply(s,t),n.default(s)}function E(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var s=S.call(e);return s.push.apply(s,t),n.default(s)}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var S=Array.prototype.slice;t.thaw=s,t.withMutations=o,t.getIn=i,t.set=a,t.update=c,t.updateIn=l,t.setIn=u,t.merge=_,t.mergeIn=p,t.splice=d,t.unshift=h,t.push=E}),define("modules/clean/previews/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.Archive="archive",e.Audio="audio",e.CloudDoc="cloud_doc",e.Excel="excel",e.HTML="html",e.Image="image",e.Linkfile="linkfile",e.Other="other",e.SsrDoc="ssr_doc",e.RawHTML="raw_html",e.Restricted="restricted",e.Video="video",e.Doc="doc",e.Photo="photo",e.Text="text"})(t.PreviewType||(t.PreviewType={})),t.IworkExtensions=["key","pages","numbers","kth"],t.MAX_ARCHIVE_FILE_SIZE_B=536870912,t.MAX_PPT_FILE_SIZE_B=301989888,t.MAX_WORD_DOC_FILE_SIZE_B=167772160}),define("modules/clean/previews/data/preview_type_util",["require","exports","modules/clean/previews/constants"],function(e,t,r){"use strict";function n(e){return function(t){var r=s(t);return!!r&&r===e}}function s(e){if(e&&e.content)return e.content[".tag"]}Object.defineProperty(t,"__esModule",{value:!0}),t.isArchive=n(r.PreviewType.Archive),t.isRawHtml=n(r.PreviewType.RawHTML),t.isExcel=n(r.PreviewType.Excel),t.isVideo=n(r.PreviewType.Video),t.isAudio=n(r.PreviewType.Audio),t.isLinkfile=n(r.PreviewType.Linkfile),t.isHtml=n(r.PreviewType.HTML),t.isSsrDoc=n(r.PreviewType.SsrDoc),t.isImage=n(r.PreviewType.Image),t.isCloudDoc=n(r.PreviewType.CloudDoc),t.isRestricted=n(r.PreviewType.Restricted),t.isOther=n(r.PreviewType.Other),t.getPreviewType=s}),define("modules/clean/prompt/api/rendering",["require","exports"],function(e,t){"use strict";function r(e){return void 0!==e.remindMeLaterText}Object.defineProperty(t,"__esModule",{value:!0}),t.isHomeModalContent=r}),define("modules/clean/react/badge",["require","exports","tslib","react","external/classnames","modules/clean/react/css","modules/core/i18n"],function(e,t,r,n,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importDefault(s);var a;(function(e){e.NEW="new",e.PRO="pro",e.BETA="beta",e.PLUS="plus",e.ALPHA="alpha"})(a=t.BadgeVariant||(t.BadgeVariant={}));var c;(function(e){e.NEON_GREEN="neon-green",e.STONE_FORTY="stone-forty",e.SQUASH="squash",e.PINK="pink",e.PINK_OUTLINE="pink-outline"})(c=t.BadgeColor||(t.BadgeColor={}));var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e,t=this.props,o=t.variant,c=t.color,l=t.absolute,u=t.className,_=t.onClick,p={};_&&(p.onClick=_);var d=(e={},e[a.NEW]=i._("New"),e[a.PRO]=i._("Pro"),e[a.BETA]=i._("Beta"),e[a.PLUS]=i._("Plus"),e[a.ALPHA]=i._("Alpha"),e);return n.default.createElement("span",r.__assign({className:s.default("badge","badge--variant-"+o,"badge--color-"+c,{"badge--absolute":l},u)},p),d[o]||null)},t.defaultProps={color:c.NEON_GREEN,absolute:!1},t})(n.default.Component);t.Badge=o.requireCssWithComponent(l,["/static/css/react/badge-vfl4JD5sn.css"])}),define("modules/clean/react/browse/constants",["require","exports","modules/core/i18n"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.NotReady=0]="NotReady",e[e.NotLive=1]="NotLive",e[e.Live=2]="Live"})(t.BrowseBoltClientStatus||(t.BrowseBoltClientStatus={})),t.BROWSE_FILE_VIEWER_ELEMENT_ID="browse-react-file-viewer-container";var n={IMAGE:["bmp","cr2","gif","ico","jpeg","jpg","nef","png","psd","tif","tiff","svg","svgz"],VIDEO:["3gp","3gpp","3gpp2","avi","dv","flv","m2t","m4v","mkv","mov","mp4","mpeg","mpg","mts","ts","vob","wmv"],AUDIO:["aif","flac","m4a","m4p","mp3","ogg","wav","wma"],DOCUMENT:["ai","cdr","csv","doc","docx","docm","eps","fla","gdoc","gsheet","gslides","indd","keynote","numbers","otf","pages","paper","papert","pdf","ppt","pptx","pptm","pps","ppsx","ppsm","ps","rtf","swf","txt","wpd","xls","xlsx","xlsm"],COMPRESSED_FILE:["7z","bz2","gz","gzip","rar","tar","zip"],CODE:["as","as3","asm","aspx","bat","c","cc","cmake","coffee","cpp","cs","css","cxx","diff","erb","erl","groovy","gry","h","haml","hh","hpp","html","htm","hxx","java","js","json","jsx","less","lst","m","make","mk","ml","mm","msg","out","patch","php","pl","pm","plist","properties","py","rb","sass","scala","scm","script","scss","sh","sml","sql","vb","vi","vim","xhtml","xml","xsd","xsl","y","yaml","yml","yxx"],DISK_IMAGE:["dmg","iso"],EXECUTABLE:["exe"],SHORTCUT:["lnk","web"],LINK:["url","webloc"],FONT:["ttf"]};t.FileTypeCategoryTranslations={FILE:r._("File"),FOLDER:r._("Folder"),SHARED_FOLDER:r._("Shared folder"),TEAM_SHARED_FOLDER:r._("Team folder"),TEAM_MEMBER_FOLDER:r._("Member folder"),PUBLIC_FOLDER:r._("Folder"),IMAGE:r._("Image"),VIDEO:r._("Video"),AUDIO:r._("Audio"),DOCUMENT:r._("Document"),COMPRESSED_FILE:r._("Archive",{project:"file-types"}),CODE:r._("Code"),DISK_IMAGE:r._("Disk image"),EXECUTABLE:r._("Executable"),SHORTCUT:r._("Shortcut"),LINK:r._("Link",{project:"file-types",comment:"A noun describing a url link"}),FONT:r._("Font"),SANDBOX:r._("App folder")},t.FileTypeCapitalizedCategoryTranslations={FILE:r._("FILE"),FOLDER:r._("FOLDER"),SHARED_FOLDER:r._("SHARED FOLDER"),TEAM_SHARED_FOLDER:r._("TEAM FOLDER"),TEAM_MEMBER_FOLDER:r._("MEMBER FOLDER"),PUBLIC_FOLDER:r._("FOLDER"),IMAGE:r._("IMAGE"),VIDEO:r._("VIDEO"),AUDIO:r._("AUDIO"),DOCUMENT:r._("DOCUMENT"),COMPRESSED_FILE:r._("ARCHIVE"),CODE:r._("CODE"),DISK_IMAGE:r._("DISK IMAGE"),EXECUTABLE:r._("EXECUTABLE"),SHORTCUT:r._("SHORTCUT"),LINK:r._("LINK",{comment:"A noun describing a url link"}),FONT:r._("FONT"),SANDBOX:r._("APP FOLDER")},t.DeletedFileTypeCategoryTranslations={FILE:r._("Deleted file"),FOLDER:r._("Deleted folder"),SHARED_FOLDER:r._("Deleted shared folder"),TEAM_SHARED_FOLDER:r._("Deleted team folder"),TEAM_MEMBER_FOLDER:r._("Deleted member folder"),PUBLIC_FOLDER:r._("Deleted folder"),IMAGE:r._("Deleted image"),VIDEO:r._("Deleted video"),AUDIO:r._("Deleted audio"),DOCUMENT:r._("Deleted document"),COMPRESSED_FILE:r._("Deleted archive"),CODE:r._("Deleted code"),DISK_IMAGE:r._("Deleted disk image"),EXECUTABLE:r._("Deleted executable"),SHORTCUT:r._("Deleted shortcut"),LINK:r._("Deleted link"),FONT:r._("Deleted font"),SANDBOX:r._("Deleted app folder")},t.DeletedFileTypeCapitalizedCategoryTranslations={FILE:r._("DELETED FILE"),FOLDER:r._("DELETED FOLDER"),SHARED_FOLDER:r._("DELETED SHARED FOLDER"),TEAM_SHARED_FOLDER:r._("DELETED TEAM FOLDER"),TEAM_MEMBER_FOLDER:r._("DELETED MEMBER FOLDER"),PUBLIC_FOLDER:r._("DELETED FOLDER"),IMAGE:r._("DELETED IMAGE"),VIDEO:r._("DELETED VIDEO"),AUDIO:r._("DELETED AUDIO"),DOCUMENT:r._("DELETED DOCUMENT"),COMPRESSED_FILE:r._("DELETED ARCHIVE"),CODE:r._("DELETED CODE"),DISK_IMAGE:r._("DELETED DISK IMAGE"),EXECUTABLE:r._("DELETED EXECUTABLE"),SHORTCUT:r._("DELETED SHORTCUT"),LINK:r._("DELETED LINK"),FONT:r._("DELETED FONT"),SANDBOX:r._("DELETED APP FOLDER")},t.ExtensionCategories={};for(var s=0,o=Object.keys(n);s<o.length;s++)for(var i=o[s],a=n[i],c=0,l=a;c<l.length;c++){var u=l[c];t.ExtensionCategories[u]=i}(function(e){e.SET_SHARED_FOLDER_DATA="SET_SHARED_FOLDER_DATA",e.SET_SHARED_LINK_DATA="SET_SHARED_LINK_DATA",e.SET_SHARED_LINK_INFO_FOR_PARENT_PATH="SET_SHARED_LINK_INFO_FOR_PARENT_PATH",e.SET_SHARED_FILE_DATA="SET_SHARED_FILE_DATA",e.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE="SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE",e.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE="SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE",e.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE="SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE",e.CLEAR_SHARED_FOLDER_DATA_FOR_NS="CLEAR_SHARED_FOLDER_DATA_FOR_NS",e.REMOVE_SHARED_LINK_DATA="REMOVE_SHARED_LINK_DATA",e.BROWSE_FILES_UPDATED="BROWSE_FILES_UPDATED",e.BROWSE_FILES_LOADED="BROWSE_FILES_LOADED",e.INIT_INTEGRATION_DATA="INIT_INTEGRATION_DATA"})(t.SharedWithActionType||(t.SharedWithActionType={})),t.MAX_FOLDERS_PER_CALL=100,t.MAX_FOLDER_SIZE_QUEUE_SIZE=50,t.MAX_FOLDER_SIZE_ITERATIONS=1e3,t.BROWSE_SORT_COOKIE_NAME="browse_current_sort";(function(e){e.RELEVANCE="RELEVANCE",e.LAST_MODIFIED_TIME="LAST_MODIFIED_TIME"})(t.SEARCH_ORDER_BY_TYPE||(t.SEARCH_ORDER_BY_TYPE={}));(function(e){e.TRUE="true",e.FALSE="false"})(t.SEARCH_REVERSE_ORDER_TYPE||(t.SEARCH_REVERSE_ORDER_TYPE={}));var _;(function(e){e.country_override="country_override",e.cProfile="cProfile",e.d="d",e.last_fq_path="last_fq_path",e.path="path",e.preview="preview",e.public_mode_override="public_mode_override",e.query="query",e.query_unnormalized="query_unnormalized",e.search_session_id="search_session_id",e.search_token="search_token",e.select="select",e.activity="activity",e.rewind="rewind",e.from_desktop_client="from_desktop_client",e.rewind_optin="rewind_optin",e.stormcrow_override="stormcrow_override",e.stormcrow_override_data_field="stormcrow_override_data_field",e.stormcrow_override_population="stormcrow_override_population",e.stormcrow_override_ttl="stormcrow_override_ttl",e.stormcrow_panel="stormcrow_panel",e.uncompressed_js="uncompressed_js",e.use_packages="use_packages",e.file_categories="file_categories",e.preselected_for_showcase="preselected_for_showcase",e.search_from="search_from",e.share="share",e.reload="reload",e.folder_overview="folder_overview",e.search_order_by="search_order_by",e.search_reverse_order="search_reverse_order",e.search_type="search_type",e.rewind_tip="rewind_tip"})(_=t.BrowseQueryArg||(t.BrowseQueryArg={})),t.FRAMEWORK_ARGS=[[_.country_override],[_.cProfile],[_.public_mode_override],[_.stormcrow_override],[_.stormcrow_override_data_field],[_.stormcrow_override_population],[_.stormcrow_override_ttl],[_.stormcrow_panel],[_.uncompressed_js],[_.use_packages]],t.DEFAULT_PAGE_HEADER_HEIGHT=96,t.COMPACT_PAGE_HEADER_HEIGHT=76}),define("modules/clean/react/browse/data/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.APP_INIT="BROWSE/APP_INIT",e.PUSH_BOLT_IGNORE="BROWSE/PUSH_BOLT_IGNORE",e.POP_BOLT_IGNORE="BROWSE/POP_BOLT_IGNORE",e.SELECT_FILES_BY_FQ_PATH="BROWSE/SELECT_FILES_BY_FQ_PATH",e.SHOW_TIMELINE="BROWSE/SHOW_TIMELINE",e.HIDE_TIMELINE="BROWSE/HIDE_TIMELINE",e.OPT_IN_TO_REWIND="BROWSE/OPTED_IN_TO_REWIND",e.SET_BROWSE_POST_TTI_EXPERIMENTS="BROWSE/SET_BROWSE_POST_TTI_EXPERIMENTS",e.SET_CAN_DISPLAY_FOLDER_SIZES="BROWSE/SET_CAN_DISPLAY_FOLDER_SIZES",e.SET_CLIPBOARD_FILES="BROWSE/SET_CLIPBOARD_FILES",e.SET_CONTEXT="BROWSE/SET_CONTEXT",e.SET_FILE_JUMP_FILTER="BROWSE/SET_FILE_JUMP_FILTER",e.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE="BROWSE/SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE",e.SET_FILE_RENAME="BROWSE/SET_FILE_RENAME",e.SET_FOLDER_SIZES="BROWSE/SET_FOLDER_SIZES",e.SET_LOADING_STATE="BROWSE/SET_LOADING_STATE",e.SET_MOUNT_POINTS="BROWSE/SET_MOUNT_POINTS",e.SET_NEW_FOLDER_CREATION_STATE="BROWSE/SET_NEW_FOLDER_CREATION_STATE",e.SET_PAGINATED_TOTAL_NUM_FILES="BROWSE/SET_PAGINATED_TOTAL_NUM_FILES",e.SET_PATH="BROWSE/SET_PATH",e.SET_SELECTION="BROWSE/SET_SELECTION",e.SET_SHOULD_SHOW_DELETED_FILES="BROWSE/SET_SHOULD_SHOW_DELETED_FILES",e.SET_SORT_ORDER="BROWSE/SET_SORT_ORDER",e.SET_UNSORTED_FILES="BROWSE/SET_UNSORTED_FILES",e.SET_IS_SEARCH_MODE="BROWSE/SET_IS_SEARCH_MODE",e.REQUEST_FOLDER_SIZES="BROWSE/REQUEST_FOLDER_SIZES",e.SET_FOLDER_SIZES_PENDING="BROWSE/SET_FOLDER_SIZES_PENDING",e.COMPLETE_FOLDER_SIZES="BROWSE/COMPLETE_FOLDER_SIZES"})(t.ActionTypes||(t.ActionTypes={}))}),define("modules/clean/react/browse/logger_util",["require","exports"],function(e,t){"use strict";function r(e){return!!e&&!!e.fq_path}function n(e){return!!e&&!!e.pad_id}function s(e){return void 0!==e.folder_id}function o(e){var t=e.filter(function(e){return r(e)&&e.is_dir}).count();return{num_files_selected:e.filter(function(e){return r(e)&&!e.is_dir}).count(),num_folders_selected:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.isFile=r,t.isPaper=n,t.isPaperFolder=s,t.countFilesAndFolders=o}),define("modules/clean/react/browse/models",["require","exports","tslib","modules/clean/immutability_helper","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/constants","modules/clean/sharing/access_level","modules/clean/display_format","modules/clean/datetime","modules/core/i18n","modules/core/exception"],function(e,t,r,n,s,o,i,a,c,l,u,_){"use strict";function p(e){return e instanceof h?e.fq_path:e instanceof C?e.file_id:e instanceof m?e.pad_id:e.folder_id}function d(e){return e instanceof h||e instanceof C||e instanceof m?e instanceof h||e instanceof C?null===e.ts||void 0===e.ts?0:1e3*e.ts:new Date(e.ts).getTime():(_.assert(!1,"Get timestamp in millisecond is only supported for File, FileSharedWithMe and Paper",{tags:["search"]}),0)}Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s);var h=(function(){function e(e){this.beacon_context=e.beacon_context,this.bytes=e.bytes,this.direct_blockserver_link=e.direct_blockserver_link,this.event_type=e.event_type,this.ext=e.ext,this.file_id=e.file_id,this.filename_highlights=e.filename_highlights,this.highlight_spans=e.highlight_spans,this.fq_path=e.fq_path,this.href=e.href,this.icon=e.icon,this.is_cloud_doc=e.is_cloud_doc,this.is_dir=e.is_dir,this.is_in_team_folder_tree=e.is_in_team_folder_tree,this.is_symlink=e.is_symlink,this.is_unmounted=e.is_unmounted,this.is_versionable=e.is_versionable,this.last_modified_name=e.last_modified_name,this.latest_rev=e.latest_rev,this.match_type=e.match_type,this._mount_access_perms=e._mount_access_perms,this.ns_id=e.ns_id,this.ns_path=e.ns_path,this.open_to_url=e.open_to_url,this.preview=e.preview,this.preview_type=e.preview_type,this.read_only=!!e.read_only,this.request_id=e.request_id,this.revision_id=e.revision_id,this.sjid=e.sjid,this.sort_key=e.sort_key,this.sort_rank=e.sort_rank,this.snippets=e.snippets,this.sync_setting=e.sync_setting,this.target_ns=e.target_ns,this.team_folder_status=e.team_folder_status,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.ts=e.ts,this.type=e.type,this.isDeleted=!!e.isDeleted,this.fetchFolderSizesStatus=e.fetchFolderSizesStatus}return Object.defineProperty(e.prototype,"ago",{get:function(){return null===this.ts||void 0===this.ts?"":l.getActingTimeWithAgoEnabled(1e3*this.ts,!1,!0,0,!0,!0,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.isDeleted||this.bytes<0?u._("Deleted"):void 0===this.bytes?"":c.format_bytes(this.bytes)},enumerable:!0,configurable:!0}),e.fromServerObject=function(t){return new e(r.__assign({},t,{_mount_access_perms:t.mount_access_perms,isDeleted:t.bytes===-1}))},e.prototype.set=function(e,t){return n.set(this,e,t)},e.prototype.merge=function(e){return n.merge(this,e)},e.prototype.toJS=function(){return Object.assign({},this)},e.getFilename=function(e){return s.filename(e.fq_path)},e.getExtension=function(e){return e.is_dir?"":s.file_extension(s.filename(e.fq_path))},e.getCategoryDescription=function(t,r){void 0===r&&(r=!1);var n;if(t.is_dir)if(t.is_in_team_folder_tree)n="SHARED_FOLDER";else switch(n="FOLDER",t.type){case o.FileTypes.TEAM_SHARED_FOLDER:n="TEAM_SHARED_FOLDER";break;case o.FileTypes.SHARED_FOLDER:n="SHARED_FOLDER";break;case o.FileTypes.SANDBOX:n="SANDBOX";break;case o.FileTypes.TEAM_MEMBER_FOLDER:n="TEAM_MEMBER_FOLDER";break;default:t.target_ns&&(n="SHARED_FOLDER")}else n=i.ExtensionCategories[e.getExtension(t)]||"FILE";return t.isDeleted?r?i.DeletedFileTypeCapitalizedCategoryTranslations[n]:i.DeletedFileTypeCategoryTranslations[n]:r?i.FileTypeCapitalizedCategoryTranslations[n]:i.FileTypeCategoryTranslations[n]},e.isTeamSharedFolder=function(e){return e.type===o.FileTypes.TEAM_SHARED_FOLDER},e.isTeamMemberFolder=function(e){return e.type===o.FileTypes.TEAM_MEMBER_FOLDER},e.isReadOnlySharedFolder=function(e){var t=e._mount_access_perms;return null!=t&&!t.includes("can_edit")},e.isNoAccessSharedFolder=function(e){var t=e._mount_access_perms;return null!=t&&!t.includes("can_view")},e.canViewFileMembers=function(e,t){var r=e._mount_access_perms;return!(r&&r.indexOf("can_view_members")<0)&&(!(t&&!t.canViewContainingNSMembers)||!!(r&&r.indexOf("can_view_members")>=0))},e.prototype.updateSize=function(e,t){return this.merge({bytes:e,fetchFolderSizesStatus:t})},e})();t.File=h;var E=(function(){function e(e){void 0===e&&(e={}),this.isPublicFolderEnabled=!!e.isPublicFolderEnabled,this.publicFolderFqPath=e.publicFolderFqPath,this.publicAppToken=e.publicAppToken,Object.freeze(this)}return e.fromServerObject=function(t){return new e({isPublicFolderEnabled:t.public_folder_enabled,publicFolderFqPath:t.public_folder_fq_path,publicAppToken:t.public_app_token})},e.prototype.set=function(e,t){return n.set(this,e,t)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e})();t.Config=E;var S=(function(){function e(e){var t=void 0===e?{}:e,r=t.canViewContainingNSMembers,n=t.currentNSID,s=t.currentFQPath,o=t.currentMountPoint,i=t.currentNSPath,c=t.currentSharedFolderPermissionRole,l=t.currentNSAllowsNesting,u=t.inactiveNSIDByFQPath,_=t.permanentDeletionDisabledStateByNSID,p=t.isInFolderMode,d=t.isCurrentlyInRoot,h=t.isInsideSandboxFolder,S=t.isInsideSharedFolder,m=t.isInsideTeamFolderRoot,f=t.isInsideArchivedTeamFolder,g=t.isInsideTeamFolderTree,C=t.isInsideMyTeamFolderTree,R=t.isInsideDeletedFolder,I=t.isInsideDeletedSharedFolder,T=t.isInsideDeletedNestedSharedFolder,A=t.isNonUserRelativeContext,y=t.pathRoot,O=t.rootNSID,D=t.showPinnedTeamFolder,v=t.teamFolderOwnerTeamApiId,L=t.blockHash,N=t.config,w=t.syncSetting;this.canViewContainingNSMembers=null==r||r,this.currentNSID=n||0,this.currentFQPath=s||"",this.currentMountPoint=o,this.currentNSPath=i,this.currentSharedFolderPermissionRole=null!=c?c:a.NameSpaceAccess.ACCESS_NO_ACCESS,this.currentNSAllowsNesting=!!l,this.inactiveNSIDByFQPath=u||{},this.permanentDeletionDisabledStateByNSID=_||{},this.isInFolderMode=null==p||p,this.isCurrentlyInRoot=!!d,this.isInsideSandboxFolder=!!h,this.isInsideSharedFolder=!!S,this.isInsideTeamFolderRoot=!!m,this.isInsideArchivedTeamFolder=!!f,this.isInsideTeamFolderTree=!!g,this.isInsideMyTeamFolderTree=!!C,this.isInsideDeletedFolder=!!R,this.isInsideDeletedSharedFolder=!!I,this.isInsideDeletedNestedSharedFolder=!!T,this.isNonUserRelativeContext=!!A,this.pathRoot=y,this.rootNSID=O,this.showPinnedTeamFolder=!!D,this.teamFolderOwnerTeamApiId=v,this.blockHash=L,this.config=N||new E,this.syncSetting=w}return e.fromServerObject=function(t){var r=t.containing_fq_path||"";r.startsWith("/")||(r="/"+r);var n;t.inside_shared_folder&&(n=a.NameSpaceAccess.ACCESS_READER);var s,o=t.containing_ns_permissions||[],i=o.includes("mount_shared_folders");return t.inside_shared_folder&&(o.includes("edit_contents")&&(n=a.NameSpaceAccess.ACCESS_WRITER),o.includes("change_folder_options")&&(n=a.NameSpaceAccess.ACCESS_OWNER),o.includes("view_members")||(s=!1)),new e({blockHash:t.block_hash,canViewContainingNSMembers:s,config:E.fromServerObject(t),currentFQPath:r,currentMountPoint:t.containing_mount_point,currentNSAllowsNesting:i,currentNSID:t.containing_ns_id,currentNSPath:t.containing_ns_path,currentSharedFolderPermissionRole:n,inactiveNSIDByFQPath:t.old_path_to_ns_id,isCurrentlyInRoot:t.in_root_dir,isInFolderMode:t.inside_dir,isInsideSandboxFolder:t.inside_sandbox_folder,isInsideArchivedTeamFolder:t.inside_archived_team_folder,isInsideTeamFolderRoot:t.inside_team_folder_root,isInsideDeletedFolder:t.inside_deleted_dir,isInsideDeletedNestedSharedFolder:t.inside_deleted_nested_shared_folder,isInsideDeletedSharedFolder:t.inside_deleted_shared_folder,isInsideSharedFolder:t.inside_shared_folder,isInsideTeamFolderTree:t.inside_team_folder_tree,isInsideMyTeamFolderTree:t.inside_my_team_folder_tree,isNonUserRelativeContext:t.is_non_user_relative_context,pathRoot:t.path_root,permanentDeletionDisabledStateByNSID:t.permanent_delete_is_disabled_by_ns_id,rootNSID:t.root_ns_id,showPinnedTeamFolder:t.show_pinned_team_folder,teamFolderOwnerTeamApiId:t.team_folder_owner_team_dbtid,syncSetting:t.sync_setting})},e.prototype.set=function(e,t){return n.set(this,e,t)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e.prototype.isCurrentPathWriteable=function(){var e=this,t=e.currentSharedFolderPermissionRole;return!e.isInsideSharedFolder||t===a.NameSpaceAccess.ACCESS_WRITER||t===a.NameSpaceAccess.ACCESS_OWNER},e.prototype.getNameOfTargetFolder=function(){return s.filename(this.currentFQPath)},e})();t.BrowseContext=S;var m=(function(){function e(e){this.title=e.title,this.pad_id=e.pad_id,this.url=e.url,this.title_highlights=e.title_highlights,this.highlight_spans=e.highlight_spans,this.creator_name=e.creator_name,this.last_editor_name=e.last_editor_name,this.request_id=e.request_id,this.sort_rank=e.sort_rank,this.snippets=e.snippets,this.ts=e.ts}
return Object.defineProperty(e.prototype,"last_modified_date",{get:function(){if(!this.ts)return"";var e=new Date(this.ts).getTime();return l.getActingTimeWithAgoEnabled(e,!1,!0,0,!0,!0,!0)},enumerable:!0,configurable:!0}),e.fromServerObject=function(t){return new e(t)},e})();t.Paper=m;var f=(function(){function e(e){this.name=e.name,this.url=e.url,this.folder_id=e.folder_id,this.title_highlights=e.title_highlights,this.highlight_spans=e.highlight_spans,this.request_id=e.request_id,this.sort_rank=e.sort_rank}return e.fromServerObject=function(t){return new e(t)},e})();t.PaperFolder=f;var g=(function(){function e(e){this.renderUserDefinedItemRow=e.renderUserDefinedItemRow}return e})();t.UserDefinedItem=g;var C=(function(){function e(e){this.bytes=e.bytes,this.ext=e.ext,this.file_id=e.file_id,this.filename=e.filename,this.highlight_spans=e.highlight_spans,this.href=e.href,this.icon=e.icon,this.is_cloud_doc=e.is_cloud_doc,this.last_modified_name=e.last_modified_name,this.match_type=e.match_type,this.request_id=e.request_id,this.server_timestamp=e.server_timestamp,this.sort_rank=e.sort_rank,this.snippets=e.snippets,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.ts=e.ts,this.type=e.type}return e.fromServerObject=function(t){return new e(t)},Object.defineProperty(e.prototype,"ago",{get:function(){return null===this.ts||void 0===this.ts?"":l.getActingTimeWithAgoEnabled(1e3*this.ts,!1,!0,0,!0,!0,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.bytes<0||void 0===this.bytes?"":c.format_bytes(this.bytes)},enumerable:!0,configurable:!0}),e})();t.FileSharedWithMe=C,t.itemId=p,t.itemTimestampInMs=d}),define("modules/clean/react/browse/uri_helper",["require","exports","tslib","modules/clean/history","modules/clean/react/browse/constants"],function(e,t,r,n,s){"use strict";function o(e,t){return e.is_paired?"personal"===t.role?"/personal":"/work":"/home"}function i(e,t){var r=o(e,t);return t.is_cdm_member?r+"/"+t.display_name:r}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),t.browse_root=o,t.getUserRoot=i,t.getQueryArgs=function(){var e=n.default.deconstruct_url().qargs;return{d:e[s.BrowseQueryArg.d],select:e[s.BrowseQueryArg.select],path:e[s.BrowseQueryArg.path],last_fq_path:e[s.BrowseQueryArg.last_fq_path],query:e[s.BrowseQueryArg.query],query_unnormalized:e[s.BrowseQueryArg.query_unnormalized],preview:e[s.BrowseQueryArg.preview],search_session_id:e[s.BrowseQueryArg.search_session_id],country_override:e[s.BrowseQueryArg.country_override],cProfile:e[s.BrowseQueryArg.cProfile],public_mode_override:e[s.BrowseQueryArg.public_mode_override],stormcrow_override:e[s.BrowseQueryArg.stormcrow_override],stormcrow_override_data_field:e[s.BrowseQueryArg.stormcrow_override_data_field],stormcrow_override_population:e[s.BrowseQueryArg.stormcrow_override_population],stormcrow_override_ttl:e[s.BrowseQueryArg.stormcrow_override_ttl],stormcrow_panel:e[s.BrowseQueryArg.stormcrow_panel],uncompressed_js:e[s.BrowseQueryArg.uncompressed_js],use_packages:e[s.BrowseQueryArg.use_packages],file_categories:e[s.BrowseQueryArg.file_categories],preselected_for_showcase:e[s.BrowseQueryArg.preselected_for_showcase],activity:e[s.BrowseQueryArg.activity],rewind_optin:e[s.BrowseQueryArg.rewind_optin],rewind:e[s.BrowseQueryArg.rewind],from_desktop_client:e[s.BrowseQueryArg.from_desktop_client],search_from:e[s.BrowseQueryArg.search_from],folder_overview:void 0!==e[s.BrowseQueryArg.folder_overview]||void 0,search_order_by:e[s.BrowseQueryArg.search_order_by],search_reverse_order:e[s.BrowseQueryArg.search_reverse_order],search_type:e[s.BrowseQueryArg.search_type],rewind_tip:e[s.BrowseQueryArg.rewind_tip]}}}),define("modules/clean/react/files_view/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.ESC="ESC",e.SUBMIT="SUBMIT",e.BLUR="BLUR"})(t.NameInputActionSource||(t.NameInputActionSource={}));(function(e){e.CREATE_FOLDER_INACTIVE="CREATE_FOLDER_INACTIVE",e.PENDING_INPUT="PENDING_INPUT",e.SAVING_INPUT="SAVING_INPUT"})(t.NewFolderCreationState||(t.NewFolderCreationState={}));(function(e){e.PENDING_INPUT="pending-input",e.SAVING_INPUT="saving-input"})(t.RenameState||(t.RenameState={}));(function(e){e.LOADED="LOADED",e.LOADING_FIRST_PAGE="LOADING_FIRST_PAGE",e.LOADING_REMAINING_PAGES="LOADING_REMAINING_PAGES"})(t.LoadingState||(t.LoadingState={}));(function(e){e.FILENAME="FILENAME",e.MODIFIED="MODIFIED",e.CATEGORY="CATEGORY",e.EXTENSION="EXTENSION",e.SIZE="SIZE",e.SHARED_WITH="SHARED_WITH",e.SYNC_SETTING="SYNC_SETTING",e.FILE_COUNTS="FILE_COUNTS",e.RELEVANCE="RELEVANCE"})(t.SortField||(t.SortField={}));(function(e){e.FILENAME="FILES_BY_NAME",e.MODIFIED="FILES_BY_MODIFIED",e.CATEGORY="FILES_BY_CATEGORY",e.EXTENSION="FILES_BY_NAME",e.SIZE="FILES_BY_SIZE",e.SHARED_WITH="FILES_BY_NAME",e.SYNC_SETTING="FILES_BY_SYNC_SETTING",e.FILE_COUNTS="FILES_BY_FILE_COUNTS",e.RELEVANCE="FILES_BY_RELEVANCE"})(t.SortLabel||(t.SortLabel={}));(function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"})(t.SortDirection||(t.SortDirection={}));(function(e){e.Grid="GRID_VIEW",e.List="LIST_VIEW",e.LargeGrid="LARGE_GRID_VIEW"})(t.ViewType||(t.ViewType={}));(function(e){e.LOADING="LOADING",e.COMPLETE="COMPLETE",e.NO_ACCESS="NO_ACCESS",e.ERROR="ERROR"})(t.FetchFolderSizeState||(t.FetchFolderSizeState={}));(function(e){e.NONE="NONE",e.ALL_FOLDERS="ALL_FOLDERS",e.NONSELECTED_FOLDERS="NONSELECTED_FOLDERS",e.NONSELECTED_NONSHARED_FOLDERS="NONSELECTED_NONSHARED_FOLDERS",e.NONSELECTED_NONSHARED_NONTEAM_FOLDERS="NONSELECTED_NONSHARED_NONTEAM_FOLDERS"})(t.DropTargetHighlightMode||(t.DropTargetHighlightMode={}));(function(e){e.CHECKBOX="checkbox",e.CLICK="click"})(t.SelectionMethod||(t.SelectionMethod={}))}),define("modules/clean/react/maestro/header",["require","exports","tslib","react","modules/clean/react/maestro/top_menu_container","modules/clean/react/maestro_nav/shared_code/dropbox_logo","modules/clean/react/maestro/responsive","external/classnames","modules/clean/user_education/react/user_education_effect","modules/clean/react/css"],function(e,t,r,n,s,o,i,a,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),a=r.__importDefault(a);var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.default.createElement("header",{className:"maestro-header page-header__shadow"},n.default.createElement(i.VerticallyFixedWrapper,{className:"page-header",responsive:this.props.responsive},n.default.createElement("div",{className:a.default("page-header__title",this.props.titleClass)},n.default.createElement(c.UserEducationEffect,{containerName:"PageletMaestroHeader",name:"Title",useSpan:!0},this.props.title)),n.default.createElement(s.TopMenuContainer,r.__assign({},this.props))))},t.defaultProps={showSearchBar:!0,isSearchBarExpanded:!1},t})(n.default.Component),_=function(e){var t=e.children;return n.default.createElement("h1",{className:"page-header__heading"},t)};t.MaestroHeaderTitle=_;var p=function(){return n.default.createElement("a",{href:"/",className:"page-header__logo"},n.default.createElement(o.DropboxLogo,{alt:"Dropbox"}))};t.MaestroHeaderLogo=p;var d=l.requireCssWithComponent(u,["/static/css/maestro_layout-vflClEGTt.css"]);t.PageletMaestroHeader=d}),define("modules/clean/react/maestro/layout",["require","exports","tslib","react","classnames","spectrum/match","modules/clean/react/maestro/header","modules/clean/react/maestro/secondary_sidebar","modules/clean/react/maestro/responsive"],function(e,t,r,n,s,o,i,a,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importDefault(s);var l=(function(e){function t(t){var r=e.call(this,t)||this;r.isPageResponsive=function(){return!(!document||!document.documentElement)&&document.documentElement.classList.contains(c.RESPONSIVE_CLASS)},r.handleSetup=function(){r.setState({setupComplete:!0})},r.handleMatchMedium=function(){r.setState({isMatchedMedium:!0})},r.handleUnmatchMedium=function(){r.setState({isMatchedMedium:!1})},r.handleMatchLarge=function(){r.setState({isMatchedLarge:!0})},r.handleUnmatchLarge=function(){r.setState({isMatchedLarge:!1})};var n=r.isPageResponsive();return r.state={isResponsive:n,isMatchedMedium:!n,isMatchedLarge:!n,setupComplete:!n},r}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.user,l=e.titleRegion,u=e.titleClass,_=e.chromeClass,p=e.embeddedAppRegion,d=e.actionSidebarRegion,h=e.searchBarProps,E=this.state,S=E.setupComplete,m=r.__rest(E,["setupComplete"]);return n.default.createElement("div",{className:s.default(["maestro-chrome",_])},m.isResponsive&&n.default.createElement(o.Match,{media:c.BREAKPOINT_LARGE,onSetup:this.handleSetup,onMatch:this.handleMatchLarge,onUnmatch:this.handleUnmatchLarge}),m.isResponsive&&n.default.createElement(o.Match,{media:c.BREAKPOINT_MEDIUM,onSetup:this.handleSetup,onMatch:this.handleMatchMedium,onUnmatch:this.handleUnmatchMedium}),S&&n.default.createElement(i.PageletMaestroHeader,r.__assign({user:t,title:l,titleClass:u,responsive:m},h||{})),S&&n.default.createElement("main",{className:"maestro-app"},n.default.createElement("div",{className:"maestro-app-content"},"function"==typeof p?p(m):p),d&&n.default.createElement("div",{className:"maestro-secondary-sidebar__shadow"},n.default.createElement(a.MaestroSecondarySidebar,{responsive:m},"function"==typeof d?d(m):d))))},t})(n.default.PureComponent);t.MaestroChrome=l}),define("modules/clean/react/maestro/responsive",["require","exports","tslib","react","spectrum/vertically_fixed"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),t.RESPONSIVE_CLASS="maestro--responsive",t.BREAKPOINT_MEDIUM="(min-width: 736px)",t.BREAKPOINT_LARGE="(min-width: 1025px)";var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.responsive,o=r.__rest(e,["responsive"]),i=t&&t.isResponsive?"div":s.VerticallyFixed;return n.default.createElement(i,o)},t.displayName="VerticallyFixedWrapper",t})(n.default.Component);t.VerticallyFixedWrapper=o}),define("modules/clean/react/maestro/secondary_sidebar",["require","exports","tslib","external/classnames","react","modules/clean/react/maestro/responsive","modules/clean/react/prompt/ha","modules/clean/upsell/prompt_event_emitter"],function(e,t,r,n,s,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importDefault(s);var c=(function(e){function t(t){var r=e.call(this,t)||this;return r.state={},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;a.promptBufferedEventEmitter.on(a.Events.ON_HA_LOADED,function(t){t.campaign.renderOnTheLeft||e.setState({haProps:t})})},t.prototype.render=function(){var e=n.default({"maestro-secondary-sidebar":!0,"has-inline-ha":!!this.state.haProps});return s.default.createElement(o.VerticallyFixedWrapper,{responsive:this.props.responsive,className:e},this.props.children,s.default.createElement(i.MaestroHA,{haProps:this.state.haProps}))},t})(s.default.Component);t.MaestroSecondarySidebar=c}),define("modules/clean/react/maestro/top_menu_container",["require","exports","tslib","react","external/lodash","modules/clean/browse_uri_interface","modules/clean/filepath","modules/clean/history","modules/clean/react/browse/models","modules/core/browser","modules/clean/search/search_bar/controller","modules/clean/search/search_bar/log_helper","modules/clean/search/search_helpers","modules/core/uri","modules/clean/web_user_action_events","modules/clean/search/constants","modules/clean/react/css","modules/clean/search/single_page/input/wrapper"],function(e,t,r,n,s,o,i,a,c,l,u,_,p,d,h,E,S,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importStar(s),i=r.__importStar(i),a=r.__importDefault(a),l=r.__importStar(l),p=r.__importStar(p);var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSearch=function(e){var n=e.query,s=e.searchToken,o=e.searchSessionId,i=e.searchPath,c=e.qargs,u=t.props.user;n&&l.redirect(p.buildSearchURL({user:u,searchPath:i,normalizedQuery:n,searchSessionId:o,searchToken:s,qargs:r.__assign({},c,{search_from:a.default.deconstruct_url().path})}).toString())},t.onSlimSearchResultOpen=function(e){var r=t.props.user;if(e instanceof c.Paper||e instanceof c.PaperFolder)l.open_tab(e.url);else{var n=e;if(n.is_dir){var s=new d.URI({path:"/"+r.role+n.fq_path});l.open_tab(s.toString())}else{var o=n.fq_path.substring(1),s=new d.URI({path:"/"+r.role}).updateQuery({preview:o});l.open_tab(s.toString())}}},t.logSearchResultOpen=function(e){var r=t.props.user;e instanceof c.File?_.logDropdownSearchAction({result:e,user:r,action_type:e.is_dir?h.WebUserActionLogEvent.FOLDER_OPEN:h.WebUserActionLogEvent.FILE_VIEW,viewport:"top-menu-dropdown-view"}):(e instanceof c.Paper||e instanceof c.PaperFolder)&&_.logDropdownSearchAction({result:e,user:r,action_type:h.WebUserActionLogEvent.PAPER_OPEN,viewport:"top-menu-dropdown-view"})},t.onResultObjectPathClick=function(e){var r=t.props.user;_.logDropdownSearchAction({result:e,user:r,action_type:h.WebUserActionLogEvent.CLICK_PATH_LINK,viewport:"dropdown-view"});var n=i.parent_dir(e.fq_path),s=o.browse_uri_for_fq_path(r,n||"").toString();l.open_tab(s)},t}return r.__extends(t,e),t.prototype.renderSearchBar=function(){return this.props.showSearchBar&&this.props.user?this.props.expUniversalSinglePageSearch?n.default.createElement(m.SearchInput,{user:this.props.user,path:this.props.currentPath,isActive:!!this.props.isSearching,onSearchEnter:this.props.onSearchEnter,onSearchExit:this.props.onSearchExit,inputBoxRef:this.props.inputBoxRef}):n.default.createElement(u.SearchBarController,{user:this.props.user,currentPath:this.props.currentPath,isExpanded:this.props.isSearchBarExpanded,onSearch:this.props.onSearch||this.onSearch,onSearchResultOpen:this.props.onSearchResultOpen||this.logSearchResultOpen,onSlimSearchResultOpen:this.props.onSearchResultOpen?void 0:this.onSlimSearchResultOpen,onResultObjectPathClick:this.props.onResultObjectPathClick||this.onResultObjectPathClick,searchBarExperiments:this.props.searchBarExperiments||{},onSearchFiltersChanged:this.props.onSearchFiltersChanged||s.noop,fileCategories:this.props.fileCategories||E.FILE_CATEGORIES_UNCHECKED,searchFrom:this.props.searchFrom}):null},t.prototype.renderRightContent=function(){return this.props.rightContent?this.props.rightContent:n.default.createElement("div",{className:"top-menu-container--search-bar-empty-space"})},t.prototype.render=function(){return n.default.createElement("div",{className:"top-menu-container "+this.props.classNames},this.renderSearchBar(),this.renderRightContent())},t.defaultProps={showSearchBar:!0,isSearchBarExpanded:!1,classNames:"",currentPath:"/"},t})(n.default.Component);t.TopMenuContainer=S.requireCssWithComponent(f,["/static/css/pagelet-vflBp79rc.css"],[u.SearchBarController])}),define("modules/clean/react/no-jquery",["require","exports"],function(e,t){"use strict";function r(e,t){if(e.closest)return e.closest(t);for(var r=e;r;){var s=n(r);if(s&&s.call(r,t))return r;r=r.parentElement}return null}function n(e){return e.matches||e.msMatchesSelector||e.webkitMatchesSelector}function s(){if(null===i)try{var e=new window.XMLHttpRequest;i=!!e&&"withCredentials"in e}catch(e){i=!1}return i}Object.defineProperty(t,"__esModule",{value:!0}),t.closestElement=r;var o=(function(){function e(e){this.handlers={},this.element=e}return e.prototype.add=function(e,t,r){this.handlers[e]=this.handlers[e]||{},this.handlers[e][t]=r,this.element.addEventListener(t,r)},e.prototype.remove=function(e,t,r){this.handlers[e]&&this.handlers[e][t]&&(this.element.removeEventListener(t,r||this.handlers[e][t]),this.handlers[e][t]===r&&delete this.handlers[e][t])},e.prototype.removeAll=function(e){if(this.handlers[e])for(var t in this.handlers[e])this.handlers[e].hasOwnProperty(t)&&(this.element.removeEventListener(t,this.handlers[e][t]),delete this.handlers[e][t])},e})();t.ScopedEventHandlers=o;var i=null;t.corsSupport=s}),define("modules/clean/react/prompt/button",["require","exports","tslib","external/classnames","external/purify","react","modules/core/cookies","modules/clean/prompt/api/rendering"],function(e,t,r,n,s,o,i,a){"use strict";function c(e){return e?{__html:s.sanitize(e)}:void 0}function l(e){function t(){return e.campaign.content.confirmText?o.default.createElement(u,{className:"button-primary",confirmInNewTab:e.campaign.content.confirmInNewTab,confirmIsPost:e.confirmIsPost,confirmUrl:e.confirmUrl,onConfirm:e.onConfirm,html:e.campaign.content.confirmText}):null}function r(){var t=e.campaign,r=e.onRemindMeLater;return a.isHomeModalContent(t.content)&&t.content.remindMeLaterText&&r?o.default.createElement(_,{className:"remind-me-later cancel-button button-tertiary",onDismiss:r,html:t.content.remindMeLaterText}):null}function s(){var t=e.campaign,r=e.onDismiss,s=e.onRemindMeLater,i={"cancel-button":!0};return t.content.cancelText?(a.isHomeModalContent(t.content)&&t.content.remindMeLaterText&&s?i["cancel-link"]=!0:i["button-tertiary"]=!0,o.default.createElement(_,{className:n.default(i),onDismiss:r,html:t.content.cancelText||void 0})):null}return o.default.createElement("div",{className:"upsell-buttons"},t(),r(),s())}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importStar(s),o=r.__importDefault(o),t.sanitizeOptionalHTML=c;var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=n.default(this.props.className,{"confirm-button":!0,enabled:!0});if(this.props.confirmIsPost){var t=i.Cookies.read("__Host-js_csrf");return o.default.createElement("form",{className:"form-button-primary",action:this.props.confirmUrl,method:"POST",target:this.getTarget(),onSubmit:this.props.onConfirm},o.default.createElement("input",{type:"hidden",name:"t",value:t}),o.default.createElement("button",{type:"submit",className:e,dangerouslySetInnerHTML:c(this.props.html)},this.props.children))}return o.default.createElement("a",{href:this.props.confirmUrl,className:e,target:this.getTarget(),dangerouslySetInnerHTML:c(this.props.html),onClick:this.props.onConfirm},this.props.children)},t.prototype.getTarget=function(){return this.props.confirmInNewTab?"_blank":"_self"},t})(o.default.Component);t.ConfirmButton=u;var _=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=n.default(this.props.className,{"dismiss-button":!0,enabled:!0});return o.default.createElement("a",{href:"#",className:e,dangerouslySetInnerHTML:c(this.props.html),onClick:this.props.onDismiss},this.props.children)},t})(o.default.Component);t.DismissButton=_,t.PromptButtons=l}),define("modules/clean/react/prompt/campaign_state_manager",["require","exports","tslib","modules/core/uri","modules/clean/react/prompt/version","modules/clean/upsell/prompt_event_logger"],function(e,t,r,n,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROMPT_CONFIRM_ENDPOINT_URL="/prompt/confirm_v2";var i=(function(){function e(e){var n=this;this.buildConfirmEndpointURI=function(e){if(e=e||n.getConfirmUrlFromContent(),!e||"#"===e)return"#";var r=n.eventLogger.getUpsellControllerURI(t.PROMPT_CONFIRM_ENDPOINT_URL),s=n.component.props.campaign.content.confirmIsPost,o=n.getRedirectURL(e);return o&&r.updateQuery({redirect_url:o}),s&&r.updateQuery({preserve_post:"1"}),r.toString()},this.shouldConfirmUsingPost=function(){var e=n.getConfirmUrlFromContent();return!!(e&&"#"!==e||n.component.props.campaign.content.confirmIsPost)},this.onShow=function(){n.component.state.isShown||(n.component.setState(function(e){return r.__assign({},e,{isShown:!0})}),n.eventLogger.triggerExternalEvent("db:prompt:show"),n.eventLogger.recordClientImpression())},this.onConfirm=function(e){n.isAckInProgress()||(n.component.setState(function(e){return r.__assign({},e,{isConfirmed:!0})}),n.eventLogger.triggerExternalEvent("db:prompt:pre-confirm"),n.ensureConfirmIsRecorded(e))},this.isHTMLAnchorElement=function(e){return void 0!==e.href},this.isHTMLFormElement=function(e){return void 0!==e.action},this.onDismiss=function(e,t){n.isAckInProgress()||(n.component.setState(function(e){return r.__assign({},e,{isDismissed:!0})}),e.preventDefault(),n.eventLogger.triggerExternalEvent("db:prompt:pre-dismiss"),n.eventLogger.recordDismiss(t&&t.remindMeLater))},this.enhanceHTMLButtons=function(e,t){var r=void 0===t?{}:t,s=r.confirmButtonSelector,o=void 0===s?".confirm-button":s,i=r.dismissButtonSelector,a=void 0===i?".dismiss-button":i,c=r.onConfirmOverride,l=void 0===c?void 0:c,u=r.onDismissOverride,_=void 0===u?void 0:u;if(e){for(var p=null,d=e.querySelectorAll(o),h=e.querySelectorAll(a),E=0;E<d.length;E++)p=d[E],n.mayEnhanceButton(p)&&(p.href=n.buildConfirmEndpointURI(p.getAttribute("href")),p.target=n.component.props.campaign.content.confirmInNewTab?"_blank":"_self",p.addEventListener("click",l||n.onConfirm));for(var E=0;E<h.length;E++)p=h[E],n.mayEnhanceButton(p)&&p.addEventListener("click",_||n.onDismiss)}},this.component=e,this.eventLogger=new o.PromptEventLogger(this.component.props)}return e.prototype.getConfirmUrlFromContent=function(){var e=this.component.props.campaign.content;return s.isTopNotificationContent(e)?e.buttonUrl:e.confirmUrl},e.prototype.getRedirectURL=function(e){if(e){if(this.component.props.campaign.addTkParams){var t=n.URI.parse(e),r=this.component.props.campaign.versionId;return null==r&&(r=this.component.props.campaign.campaignId),t.updateQuery({_tk:this.component.props.campaign.campaignLocationTkId,_camp:r.toString()}),t.toString()}return e}},e.prototype.ensureConfirmIsRecorded=function(e){if(!this.eventWillRecordConfirm(e)){this.eventLogger.recordConfirm();var t=this.getEventHrefOrAction(e);t&&"#"!==t||e.preventDefault()}},e.prototype.eventWillRecordConfirm=function(e){return(this.getEventHrefOrAction(e)||"").indexOf(t.PROMPT_CONFIRM_ENDPOINT_URL)>-1},e.prototype.getEventHrefOrAction=function(e){var t=null,r=e.currentTarget;return r&&this.isHTMLAnchorElement(r)?t=r.getAttribute("href"):r&&this.isHTMLFormElement(r)&&(t=r.getAttribute("action")),t},e.prototype.mayEnhanceButton=function(e){return!e.classList.contains("prompt-enhanced")&&(e.classList.add("prompt-enhanced"),!0)},e.prototype.isAckInProgress=function(){return this.component.state.isConfirmed||this.component.state.isDismissed},e})();t.CampaignStateManager=i}),define("modules/clean/react/prompt/ha",["require","exports","tslib","jquery","external/classnames","external/lodash","react","external/react-dom","modules/clean/react/prompt/legacy_ha_wrapper","modules/clean/react/css","modules/clean/react/sprite","modules/clean/upsell/prompt_event_emitter","modules/clean/react/prompt/button","modules/clean/react/prompt/image","modules/clean/react/prompt/prompt_location","modules/core/i18n"],function(e,t,r,n,s,o,i,a,c,l,u,_,p,d,h,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importDefault(s),o=r.__importStar(o),i=r.__importDefault(i),a=r.__importStar(a);var S;(function(e){e[e.HIDE=1]="HIDE",e[e.NO_IMAGE=2]="NO_IMAGE",e[e.SHOW=3]="SHOW"})(S=t.ShowState||(t.ShowState={})),t.UPDATE_STATE_PERIODIC_INTERVAL=1e3;var m=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.renderImage=function(){var e=this.props.content;return e.imageUrl?i.default.createElement(p.ConfirmButton,{className:"confirm-button--illustration",confirmInNewTab:e.confirmInNewTab,confirmIsPost:this.props.confirmIsPost,confirmUrl:this.props.confirmUrl,onConfirm:this.props.onConfirm},i.default.createElement(d.Image,{src:e.imageUrl,srcHiRes:e.imageUrlHiRes,alt:e.confirmText,onLoad:this.props.onImageLoad})):null},t.prototype.renderText=function(){var e=this.props.content;return i.default.createElement("p",null,i.default.createElement(p.ConfirmButton,{confirmInNewTab:e.confirmInNewTab,confirmIsPost:this.props.confirmIsPost,confirmUrl:this.props.confirmUrl,html:e.text,onConfirm:this.props.onConfirm}))},t.prototype.renderConfirmButton=function(){var e=this.props.content;return e.confirmText?i.default.createElement(p.ConfirmButton,{className:"button",confirmInNewTab:e.confirmInNewTab,confirmIsPost:this.props.confirmIsPost,confirmUrl:this.props.confirmUrl,html:e.confirmText,onConfirm:this.props.onConfirm}):null},t.prototype.renderDismissButton=function(){return i.default.createElement(p.DismissButton,{onDismiss:this.props.onDismiss,"aria-label":E._("Close")},i.default.createElement(u.Sprite,{group:"web",name:"close_small",alt:E._("Close")}))},t.prototype.render=function(){var e=this.props.isDismissed,t=s.default({ha:!0,"no-image":!e&&this.props.showState===S.NO_IMAGE,visible:!e&&this.props.showState===S.SHOW,hidden:!e&&this.props.showState===S.HIDE,invisible:this.props.isInvisible});return i.default.createElement("div",{className:t},this.renderImage(),this.renderText(),this.renderConfirmButton(),this.renderDismissButton())},t.displayName="HARendererWithoutCSS",t})(i.default.Component);t.HARendererWithoutCSS=m,t.HARendererWithCSS=l.requireCssWithComponent(m,["/static/css/upsell/prompt_pagelet-vflFyADZA.css"]);var f=(function(e){function s(t){var r=e.call(this,t,{cloneShowState:S.SHOW,isConfirmed:!1,isDismissed:!1,isShown:!1,showState:S.HIDE,topOffsetToFit:0})||this;return r.setHaRef=function(e){r.ha=e},r.setHaCloneRef=function(e){r.haClone=e},r.onPageUpdate=r.onPageUpdate.bind(r),r}return r.__extends(s,e),s.prototype.componentDidMount=function(){this.onUpdate(),n.default(window).resize(this.onPageUpdate),_.eventEmitter.addListener(_.Events.REACT_HA_DID_UPDATE,this.onPageUpdate),this.intervalID=setInterval(this.onPageUpdate,t.UPDATE_STATE_PERIODIC_INTERVAL)},s.prototype.componentWillUnmount=function(){n.default(window).off("resize",this.onPageUpdate),_.eventEmitter.off(_.Events.REACT_HA_DID_UPDATE,this.onPageUpdate),clearInterval(this.intervalID)},s.prototype.componentDidUpdate=function(){this.onUpdate()},s.prototype.onPageUpdate=function(){this.setState(function(e){return e.cloneShowState=S.SHOW,e})},s.prototype.onUpdate=function(){var e=this;if(this.state.cloneShowState>S.HIDE&&this.canFit())this.state.showState!==this.state.cloneShowState&&this.setState(function(e){return e.showState=e.cloneShowState,e},function(){e.state_manager.onShow()});else{var t=this.state.cloneShowState-1;t>S.HIDE?this.setState(function(e){return e.cloneShowState=t,e}):this.state.showState!==S.HIDE&&this.setState(function(e){return e.showState=S.HIDE,e})}},s.prototype.render=function(){return i.default.createElement("div",null,i.default.createElement(t.HARendererWithCSS,{isInvisible:!1,content:this.props.campaign.content,confirmUrl:this.state_manager.buildConfirmEndpointURI(),confirmIsPost:this.state_manager.shouldConfirmUsingPost(),isDismissed:this.state.isDismissed,onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss,ref:this.setHaRef,showState:this.state.showState}),i.default.createElement(t.HARendererWithCSS,{isInvisible:!0,content:this.props.campaign.content,confirmUrl:this.state_manager.buildConfirmEndpointURI(),confirmIsPost:this.state_manager.shouldConfirmUsingPost(),isDismissed:this.state.isDismissed,onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss,onImageLoad:this.onPageUpdate,ref:this.setHaCloneRef,showState:this.state.cloneShowState}))},s.prototype.canFit=function(){var e=this.getMenuHeight();if(null===e)return!1;var t=this.getHAHeight();return null!==t&&e+t<=this.getWindowHeight()},s.prototype.getHAHeight=function(){var e=n.default(a.findDOMNode(this.haClone));if(0===e.length)return null;return e.outerHeight()+75},s.prototype.getMenuHeight=function(){var e=n.default(".maestro-secondary-sidebar, .appactions-menu").first();if(0===e.length)return null;var t=e.children(),r=e.offset().top-n.default(document).scrollTop();return t.each(function(e,t){r+=n.default(t).outerHeight(!0)}),r},s.prototype.getWindowHeight=function(){return n.default(window).height()},s})(h.PromptLocation);t.HA=f;var g=(function(e){function s(t){var r=e.call(this,t,{cloneShowState:S.SHOW,isConfirmed:!1,isDismissed:!1,isShown:!1,showState:S.HIDE,topOffsetToFit:0})||this;return r.onWindowResize=o.debounce(function(){r.onPageUpdate()},250),r.setHaRef=function(e){r.ha=e},r.setHaCloneRef=function(e){r.haClone=e},r.onPageUpdate=r.onPageUpdate.bind(r),r}return r.__extends(s,e),s.prototype.componentDidMount=function(){this.onUpdate(),window.addEventListener("resize",this.onWindowResize),this.intervalID=setInterval(this.onPageUpdate,t.UPDATE_STATE_PERIODIC_INTERVAL)},s.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.onWindowResize),clearInterval(this.intervalID)},s.prototype.componentDidUpdate=function(){this.onUpdate()},s.prototype.onPageUpdate=function(){this.setState({cloneShowState:S.SHOW})},s.prototype.onUpdate=function(){var e,t=this;if(this.state.cloneShowState>S.HIDE&&(e=this.getTopOffsetToFit())>-1)this.state.showState===this.state.cloneShowState&&this.state.topOffsetToFit===e||this.setState({showState:this.state.cloneShowState,topOffsetToFit:e},function(){t.state_manager.onShow()});else{var r=this.state.cloneShowState-1;r>S.HIDE?this.setState({cloneShowState:r}):this.state.showState!==S.HIDE&&this.setState({showState:S.HIDE})}},s.prototype.render=function(){return i.default.createElement("div",{className:"inline-ha-wrapper",style:{top:this.state.topOffsetToFit}},i.default.createElement(t.HARendererWithCSS,{isInvisible:!1,content:this.props.campaign.content,confirmUrl:this.state_manager.buildConfirmEndpointURI(),confirmIsPost:this.state_manager.shouldConfirmUsingPost(),isDismissed:this.state.isDismissed,onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss,ref:this.setHaRef,showState:this.state.showState}),i.default.createElement(t.HARendererWithCSS,{isInvisible:!0,content:this.props.campaign.content,confirmUrl:this.state_manager.buildConfirmEndpointURI(),confirmIsPost:this.state_manager.shouldConfirmUsingPost(),isDismissed:this.state.isDismissed,onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss,onImageLoad:this.onPageUpdate,ref:this.setHaCloneRef,showState:this.state.cloneShowState}))},s.prototype.getTopOffsetToFit=function(){var e=this.getHAHeight();if(null===e)return-1;var t=this.getMenuHeight();if(null===t)return-1;var r=this.getWindowHeight()-t-e;return this.props.withinLeftNav&&r<t?-1:r},s.prototype.getHAHeight=function(){var e=n.default(a.findDOMNode(this.haClone));return 0===e.length?null:e.outerHeight(!0)},s.prototype.getMenuHeight=function(){if(this.props.withinLeftNav){var e=n.default(".maestro-nav__features, .maestro-nav__products").first();return 0===e.length?null:e.height()}var t=n.default(".maestro-secondary-sidebar, .appactions-menu").first();if(0===t.length)return null;var r=t.children(":not(.inline-ha-wrapper)"),s=t.offset().top-n.default(document).scrollTop();return r.each(function(e,t){"none"!==getComputedStyle(t).display&&(s+=n.default(t).outerHeight(!0))}),s},s.prototype.getWindowHeight=function(){return n.default(window).height()},s})(h.PromptLocation);t.InlineHA=g;var C=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return this.props.campaign.delegateRendering?(_.promptBufferedEventEmitter.emit(_.Events.ON_HA_LOADED,this.props),null):i.default.createElement(f,r.__assign({},this.props))},t})(h.PromptLocation);t.DelegatingHARenderer=C,t.MaestroHA=function(e){return e.haProps?i.default.createElement(g,r.__assign({},e.haProps)):i.default.createElement(c.LegacyHAWrapper,null)}}),define("modules/clean/react/prompt/image",["require","exports","tslib","react"],function(e,t,r,n){"use strict"
;Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.srcHiRes?this.props.srcHiRes+" 2x":"";return n.default.createElement("img",{src:this.props.src,srcSet:e,alt:this.props.alt,onLoad:this.props.onLoad})},t})(n.default.Component);t.Image=s}),define("modules/clean/react/prompt/legacy_ha_wrapper",["require","exports","tslib","react","modules/clean/upsell/prompt_event_emitter"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.emitUpdateEvent=function(){s.eventEmitter.emit(s.Events.REACT_HA_DID_UPDATE)},t.prototype.componentDidMount=function(){t.emitUpdateEvent()},t.prototype.componentDidUpdate=function(){t.emitUpdateEvent()},t.prototype.render=function(){return n.default.createElement("div",null)},t.displayName="LegacyHAWrapper",t})(n.default.Component);t.LegacyHAWrapper=o}),define("modules/clean/react/prompt/prompt_location",["require","exports","tslib","react","modules/clean/react/prompt/campaign_state_manager"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var o=(function(e){function t(t,r){var n=e.call(this,t)||this;return n.state=r,n.state_manager=new s.CampaignStateManager(n),n}return r.__extends(t,e),t})(n.default.Component);t.PromptLocation=o;var i=(function(e){function t(t){return e.call(this,t,{isConfirmed:!1,isDismissed:!1,isShown:!1})||this}return r.__extends(t,e),t})(o);t.PromptLocationWithDefaultState=i}),define("modules/clean/react/prompt/version",["require","exports"],function(e,t){"use strict";function r(e){var t=e;return void 0!==t.buttonText&&void 0!==t.buttonUrl}Object.defineProperty(t,"__esModule",{value:!0}),t.isTopNotificationContent=r}),define("modules/clean/react/retrieval_success_banner/constants",["require","exports","modules/core/i18n"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BROWSE_SUCCESS_QUESTION=r._("Was Dropbox helpful today?"),t.FEEDBACK_PLACEHOLDER=r._("Share the good, the bad, and the unexpected"),t.SEARCH_SUCCESS_QUESTION=r._("Find what you were looking for?"),t.SEARCH_SUCCESS_OPTION_YES=r._("Yes"),t.SEARCH_SUCCESS_OPTION_NO=r._("No"),t.SEARCH_SUCCESS_OPTION_KIND_OF=r._("Kind of"),t.SEARCH_SUCCESS_THANKS_TEXT=r._("Thanks for the feedback."),t.SEARCH_SUCCESS_MORE_FEEDBACK_LINK_TEXT=r._("Tell us more"),t.SUBMIT_BUTTON_TEXT=r._("Submit"),t.CANCEL_BUTTON_TEXT=r._("Cancel"),t.NEXT_BUTTON_TEXT=r._("Next"),t.MODAL_TITLE_TEXT=r._("Tell us more about your search experience"),t.SEARCH_SUCCESS_OPT_OUT_KEY="search-success-opt-out",t.SEARCH_SUCCESS_SHOW_BANNER_KEY="search-success-show-banner-key",t.SEARCH_SUCCESS_SHOW_BANNER_FROM_HOME_KEY="search-success-show-banner-from-home-key",t.SEARCH_RESULT_CLICK_TIMESTAMP_KEY="search-result-click-timestamp-key",t.SEARCH_RESULT_PATH_KEY="search-result-location-key",t.SEARCH_RESULT_CLICK_KEY="search-result-click-key",t.CLICKABLE_PATH_KEY="clickable-path-key",t.CLICKABLE_FILE_PATH_CLICK_TIMESTAMP_KEY="clickable-file-path-click-timestamp-key",t.SEARCH_BAR_ABANDONED_EVENT="dbxSearchBarAbandonedEvent",t.SEARCH_SUCCESSS_BANNER_HEIGHT_IN_SEARCH_RESULTS=75,t.BROWSE_SUCCESS_COUNT_DOWN_COMPLETE="browse-success-count-down-complete",t.BROWSE_SUCCESS_COUNT_DOWN_ID="browse-success-count-down-id",t.BROWSE_SUCCESS_SHOW_BANNER_KEY="browse-success-show-banner-key",t.BROWSE_SUCCESS_BANNER_KEY_START_TIMER="browse-success-banner_key_start_timer",t.BROWSE_SUCCESS_BANNER_KEY_END_TIMER="browse-success-banner_key_end_timer",t.BROWSE_SUCCESS_BANNER_TRIGGER_ACTION="browse_success_banner_trigger_action",t.BROWSE_SUCCESS_BROWSE_SESSION_DEPTH="browse_success_browse_session_depth",t.BROWSE_SUCCESS_BANNER_V1_TIMER=18e4,t.BROWSE_SUCCESS_BANNER_V2_TIMER=18e5,t.BROWSE_SUCCESS_BANNER_V3_TIMER=1e4,t.QUESTION_MODAL_TITLE_TEXT=r._("What did you use Dropbox for today? Check all that apply."),t.OTHER_INPUT_PLACEHOLDER=r._("Please explain"),t.BROWSE_SUCCESS_FEEDBACK_MODAL_TITLE_TEXT=r._("How can Dropbox be more helpful to you?");(function(e){e.YES="yes",e.NO="no",e.KIND_OF="kindof"})(t.RetrievalSuccessOption||(t.RetrievalSuccessOption={}));(function(e){e.IN_EMBEDDED_APP="in-embedded-app",e.PREVIEW="preview",e.SEARCH_RESULTS="search_results"})(t.SearchSuccessDisplayContext||(t.SearchSuccessDisplayContext={}));(function(e){e.NONE="NONE",e.BSB="BSB",e.SSB="SSB"})(t.BannerVariant||(t.BannerVariant={}))}),define("modules/clean/react/retrieval_success_banner/data/action_creators",["require","exports","modules/clean/react/retrieval_success_banner/data/types"],function(e,t,r){"use strict";function n(e){return{type:r.ActionTypes.UPDATE_BSB_COUNTER_COMPLETE_KEY,payload:{browseSuccessBannerCounterComplete:e}}}function s(e){return{type:r.ActionTypes.UPDATE_RSB_VISIBILITY,payload:{retrievalSuccessBannerShouldShow:e}}}function o(e){return{type:r.ActionTypes.UPDATE_BSB_VISIBILITY,payload:{browseSuccessBannerShouldShow:e}}}function i(e){return{type:r.ActionTypes.UPDATE_SSB_VISIBILITY,payload:{searchSuccessBannerShouldShow:e}}}function a(e){return{type:r.ActionTypes.UPDATE_SEARCH_BAR_ABANDONED,payload:{searchBarAbandoned:e}}}function c(e){return{type:r.ActionTypes.UPDATE_SEARCH_RESULT_BANNER_DISMISSED,payload:{searchSuccessBannerDismissed:e}}}function l(e){return{type:r.ActionTypes.UPDATE_SEARCH_RESULT_ACTION_CLICKED,payload:{searchResultActionClicked:e}}}Object.defineProperty(t,"__esModule",{value:!0}),t.updateBrowseSuccessBannerCounterCompleteKey=n,t.updateRetrievalSuccessBannerVisibility=s,t.updateBrowseSuccessBannerVisibility=o,t.updateSearchSuccessBannerVisibility=i,t.updateSearchBarAbandoned=a,t.updateSearchResultBannerDismissed=c,t.updateSearchResultActionClicked=l}),define("modules/clean/react/retrieval_success_banner/data/reducer",["require","exports","tslib","modules/clean/react/retrieval_success_banner/constants","modules/clean/react/retrieval_success_banner/data/types","modules/clean/storage"],function(e,t,r,n,s,o){"use strict";function i(e,r){switch(void 0===e&&(e=t.defaultSuccessBannerState),r.type){case s.ActionTypes.UPDATE_BSB_COUNTER_COMPLETE_KEY:return a(e,r.payload);case s.ActionTypes.UPDATE_BSB_VISIBILITY:return c(e,r.payload);case s.ActionTypes.UPDATE_RSB_VISIBILITY:return l(e,r.payload);case s.ActionTypes.UPDATE_SSB_VISIBILITY:return u(e,r.payload);case s.ActionTypes.UPDATE_SEARCH_BAR_ABANDONED:return _(e,r.payload);case s.ActionTypes.UPDATE_SEARCH_RESULT_BANNER_DISMISSED:return p(e,r.payload);case s.ActionTypes.UPDATE_SEARCH_RESULT_ACTION_CLICKED:return d(e,r.payload);default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultSuccessBannerState={browseSuccessBannerCounterComplete:!!o.LocalStorage.get(n.BROWSE_SUCCESS_COUNT_DOWN_COMPLETE),browseSuccessBannerShouldShow:!!o.LocalStorage.get(n.BROWSE_SUCCESS_SHOW_BANNER_KEY),retrievalSuccessBannerShouldShow:!1,searchSuccessBannerShouldShow:!!o.LocalStorage.get(n.SEARCH_SUCCESS_SHOW_BANNER_KEY),searchBarAbandoned:!1,searchSuccessBannerDismissed:!1,searchResultActionClicked:!1};var a=function(e,t){return r.__assign({},e,t)},c=function(e,t){return r.__assign({},e,t)},l=function(e,t){return r.__assign({},e,t)},u=function(e,t){return r.__assign({},e,t)},_=function(e,t){return r.__assign({},e,t)},p=function(e,t){return r.__assign({},e,t)},d=function(e,t){return r.__assign({},e,t)};t.successBannerReducer=i}),define("modules/clean/react/retrieval_success_banner/data/store",["require","exports","modules/clean/redux/namespaces","modules/clean/react/retrieval_success_banner/data/reducer","modules/clean/redux/store"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o;t.getStoreForSuccessBanner=function(){var e;return o||(o=s.getStoreAndRegisterReducers((e={},e[r.RETRIEVAL_SUCCESS_BANNER_NAMESPACE_KEY]=n.successBannerReducer,e))),o}}),define("modules/clean/react/retrieval_success_banner/data/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.UPDATE_BSB_COUNTER_COMPLETE_KEY="UPDATE_BSB_COUNTER_COMPLETE_KEY",e.UPDATE_BSB_VISIBILITY="UPDATE_BSB_VISIBILITY",e.UPDATE_RSB_VISIBILITY="UPDATE_RSB_VISIBILITY",e.UPDATE_SSB_VISIBILITY="UPDATE_SSB_VISIBILITY",e.UPDATE_SEARCH_BAR_ABANDONED="UPDATE_SEARCH_BAR_ABANDONED",e.UPDATE_SEARCH_RESULT_BANNER_DISMISSED="UPDATE_SEARCH_RESULT_BANNER_DISMISSED",e.UPDATE_SEARCH_RESULT_ACTION_CLICKED="UPDATE_SEARCH_RESULT_ACTION_CLICKED"})(t.ActionTypes||(t.ActionTypes={}))}),define("modules/clean/react/retrieval_success_banner/util",["require","exports","tslib","modules/clean/filepath","modules/clean/history","modules/clean/storage","modules/clean/react/retrieval_success_banner/constants","modules/clean/react/retrieval_success_banner/data/action_creators","modules/clean/react/retrieval_success_banner/data/store","modules/clean/search/types"],function(e,t,r,n,s,o,i,a,c,l){"use strict";function u(){o.LocalStorage.delete(i.SEARCH_SUCCESS_SHOW_BANNER_KEY),o.LocalStorage.delete(i.SEARCH_RESULT_CLICK_TIMESTAMP_KEY),o.LocalStorage.delete(i.SEARCH_RESULT_PATH_KEY),o.LocalStorage.delete(i.CLICKABLE_FILE_PATH_CLICK_TIMESTAMP_KEY),o.LocalStorage.delete(i.CLICKABLE_PATH_KEY),te.dispatch(a.updateSearchSuccessBannerVisibility(!1))}function _(){o.LocalStorage.delete(i.SEARCH_RESULT_CLICK_KEY)}function p(){return!!o.LocalStorage.get(i.SEARCH_SUCCESS_SHOW_BANNER_KEY)}function d(){var e=!!o.LocalStorage.get(i.SEARCH_SUCCESS_OPT_OUT_KEY),t=!!o.LocalStorage.get(i.BROWSE_SUCCESS_COUNT_DOWN_COMPLETE),r=!!o.LocalStorage.get(i.SEARCH_SUCCESS_SHOW_BANNER_KEY),n=!!o.LocalStorage.get(i.BROWSE_SUCCESS_SHOW_BANNER_KEY);return!e&&(t||n)&&!r}function h(){return!!o.LocalStorage.get(i.SEARCH_SUCCESS_SHOW_BANNER_KEY)&&!o.LocalStorage.get(i.SEARCH_SUCCESS_OPT_OUT_KEY)}function E(){v()||(o.LocalStorage.set(i.SEARCH_SUCCESS_SHOW_BANNER_KEY,!0),te.dispatch(a.updateSearchSuccessBannerVisibility(!0)))}function S(){o.LocalStorage.set(i.SEARCH_RESULT_CLICK_TIMESTAMP_KEY,Date.now())}function m(){o.LocalStorage.set(i.CLICKABLE_FILE_PATH_CLICK_TIMESTAMP_KEY,Date.now())}function f(){return o.LocalStorage.get(i.SEARCH_RESULT_CLICK_TIMESTAMP_KEY)}function g(){return o.LocalStorage.get(i.CLICKABLE_FILE_PATH_CLICK_TIMESTAMP_KEY)}function C(e){o.LocalStorage.set(i.SEARCH_RESULT_PATH_KEY,e)}function R(e){o.LocalStorage.set(i.CLICKABLE_PATH_KEY,e)}function I(e){v()||(S(),C(e))}function T(e){v()||(m(),R(e))}function A(){return o.LocalStorage.get(i.SEARCH_RESULT_PATH_KEY)}function y(){return o.LocalStorage.get(i.CLICKABLE_PATH_KEY)}function O(){v()||o.LocalStorage.set(i.SEARCH_RESULT_CLICK_KEY,!0)}function D(){return!!o.LocalStorage.get(i.SEARCH_RESULT_CLICK_KEY)}function v(){return!!o.LocalStorage.get(i.SEARCH_SUCCESS_OPT_OUT_KEY)}function L(){o.LocalStorage.set(i.SEARCH_SUCCESS_OPT_OUT_KEY,!0)}function N(){o.LocalStorage.set(i.SEARCH_SUCCESS_OPT_OUT_KEY,!0)}function w(){o.LocalStorage.set(i.SEARCH_SUCCESS_SHOW_BANNER_FROM_HOME_KEY,!0)}function B(){return!!o.LocalStorage.get(i.SEARCH_SUCCESS_SHOW_BANNER_FROM_HOME_KEY)}function P(){o.LocalStorage.delete(i.SEARCH_SUCCESS_SHOW_BANNER_FROM_HOME_KEY)}function F(e,t,r){return n.parent_dir(e)===t&&!r}function b(e){te.dispatch(a.updateSearchBarAbandoned(e))}function H(e){te.dispatch(a.updateSearchResultBannerDismissed(e))}function U(e){te.dispatch(a.updateSearchResultActionClicked(e))}function M(){s.default.deconstruct_url(document.referrer).qargs.search_session_id&&!D()?E():u()}function x(e){window.removeEventListener(i.SEARCH_BAR_ABANDONED_EVENT,e)}function k(){return!!s.default.deconstruct_url().qargs.hasOwnProperty("preview")}function q(e){void 0===e&&(e=l.BrowseSuccessBannerVariants.V1),W(),G();var t=i.BROWSE_SUCCESS_BANNER_V1_TIMER;e===l.BrowseSuccessBannerVariants.V3&&(t=i.BROWSE_SUCCESS_BANNER_V3_TIMER);var r=setTimeout(function(){o.LocalStorage.set(i.BROWSE_SUCCESS_COUNT_DOWN_COMPLETE,!0),te.dispatch(a.updateBrowseSuccessBannerCounterCompleteKey(!0))},t);o.LocalStorage.set(i.BROWSE_SUCCESS_COUNT_DOWN_ID,r)}function G(){var e=o.LocalStorage.get(i.BROWSE_SUCCESS_COUNT_DOWN_ID);e&&(clearTimeout(e),o.LocalStorage.delete(i.BROWSE_SUCCESS_COUNT_DOWN_ID))}function W(){o.LocalStorage.get(i.BROWSE_SUCCESS_COUNT_DOWN_COMPLETE)&&(o.LocalStorage.delete(i.BROWSE_SUCCESS_COUNT_DOWN_COMPLETE),te.dispatch(a.updateBrowseSuccessBannerCounterCompleteKey(!1)))}function V(e,t){e||t?te.dispatch(a.updateRetrievalSuccessBannerVisibility(!0)):te.dispatch(a.updateRetrievalSuccessBannerVisibility(!1))}function Q(e){var t=o.LocalStorage.get(i.BROWSE_SUCCESS_BANNER_KEY_START_TIMER),r=Date.now();!v()&&r-t<=i.BROWSE_SUCCESS_BANNER_V2_TIMER&&(o.LocalStorage.set(i.BROWSE_SUCCESS_SHOW_BANNER_KEY,!0),te.dispatch(a.updateBrowseSuccessBannerVisibility(!0)),e&&Y(e))}function K(){if(!v())if(o.LocalStorage.get(i.BROWSE_SUCCESS_BANNER_KEY_START_TIMER)){var e=Date.now(),t=o.LocalStorage.get(i.BROWSE_SUCCESS_BANNER_KEY_START_TIMER);if(e-t>i.BROWSE_SUCCESS_BANNER_V2_TIMER)o.LocalStorage.set(i.BROWSE_SUCCESS_BANNER_KEY_START_TIMER,Date.now());else if(!o.LocalStorage.get(i.BROWSE_SUCCESS_SHOW_BANNER_KEY)){o.LocalStorage.set(i.BROWSE_SUCCESS_BANNER_KEY_END_TIMER,Date.now()),o.LocalStorage.set(i.BROWSE_SUCCESS_SHOW_BANNER_KEY,!0),te.dispatch(a.updateBrowseSuccessBannerVisibility(!0));var r=j();o.LocalStorage.set(i.BROWSE_SUCCESS_BROWSE_SESSION_DEPTH,r)}}else o.LocalStorage.set(i.BROWSE_SUCCESS_BANNER_KEY_START_TIMER,Date.now())}function Y(e){v()||o.LocalStorage.set(i.BROWSE_SUCCESS_BANNER_TRIGGER_ACTION,e)}function j(){var e=s.default.deconstruct_url(document.referrer).path.split("/").filter(function(e){return!!e}).length;return e>3?e-3:0}function z(){return!!o.LocalStorage.get(i.BROWSE_SUCCESS_BANNER_TRIGGER_ACTION)}function X(){return o.LocalStorage.get(i.BROWSE_SUCCESS_BANNER_TRIGGER_ACTION)}function Z(){return!!o.LocalStorage.get(i.BROWSE_SUCCESS_BANNER_KEY_END_TIMER)}function J(){return(o.LocalStorage.get(i.BROWSE_SUCCESS_BANNER_KEY_END_TIMER)-o.LocalStorage.get(i.BROWSE_SUCCESS_BANNER_KEY_START_TIMER)).toString()}function $(){var e=o.LocalStorage.get(i.BROWSE_SUCCESS_BROWSE_SESSION_DEPTH);return e?e:0}function ee(){o.LocalStorage.delete(i.BROWSE_SUCCESS_BANNER_KEY_START_TIMER),o.LocalStorage.delete(i.BROWSE_SUCCESS_BANNER_KEY_END_TIMER),o.LocalStorage.delete(i.BROWSE_SUCCESS_BANNER_TRIGGER_ACTION),o.LocalStorage.delete(i.BROWSE_SUCCESS_BROWSE_SESSION_DEPTH)}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),s=r.__importDefault(s);var te=c.getStoreForSuccessBanner();t.resetSearchSuccessBannerSettings=u,t.resetSearchResultClickKey=_,t.shouldShowSearchSuccessBanner=p,t.shouldShowBrowseSuccessBanner=d,t.getSearchSuccessBannerVisibility=h,t.setSearchSuccessBannerVisible=E,t.setSearchResultClickTimestamp=S,t.getSearchResultClickTimestamp=f,t.getClickableFilePathClickTimestamp=g,t.setSearchResultPath=C,t.setFolderSearchResultData=I,t.setClickablePathData=T,t.getSearchResultPath=A,t.getClickablePath=y,t.setClickedOnSearchResultsPageItem=O,t.getClickedOnSearchResultsPageItem=D,t.userIsOptedOutOfRetrievalSuccessBanner=v,t.optOutOfSearchSuccessBanner=L,t.optOutOfBrowseSuccessBanner=N,t.setSearchSuccessBannerVisibleFromHome=w,t.getSearchSuccessBannerVisibleFromHome=B,t.resetSearchSuccessBannerVisibleFromHome=P,t.parentPathOfFileEqualsSearchResultPath=F,t.doSearchBarInteractionBroadcast=b,t.doSearchResultBannerDismissBroadcast=H,t.doSearchResultActionClickBroadcast=U,t.setupSearchSuccessBannerForHome=M,t.tearDownSearchSuccessBannerForHome=x,t.isFilePreview=k,t.startBrowseSuccessBannerCounter=q,t.clearBrowseSuccessBannerCounter=G,t.clearBrowseSuccessBannerKey=W,t.updateRSBVisibility=V,t.setBrowseSuccessBannerVisible=Q,t.setBrowseSuccessBannerTimer=K,t.setBrowseSuccessTriggerAction=Y,t.getDepthOfAbandonedBrowseSession=j,t.hasValidTriggerAction=z,t.getBrowseSuccessTriggerAction=X,t.isAbandonFlow=Z,t.getDwellTime=J,t.getDepthOnLocalStorage=$,t.clearBSBExtraData=ee}),define("modules/clean/search/api_helpers",["require","exports"],function(e,t){"use strict";function r(){return(new Date).getTimezoneOffset()}Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentTimezoneOffset=r}),define("modules/clean/search/constants",["require","exports","modules/clean/search/types"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s;t.MaxResults={MAX_SEARCH_SUGGESTIONS:8,MAX_SEARCH_RESULTS:30},t.FOCUS_SEARCH_BAR_ACTION="search__FOCUS_SEARCH_BAR",t.BLUR_SEARCH_BAR_ACTION="search__BLUR_SEARCH_BAR",t.SET_SEARCH_QUERY_ACTION="search__SET_SEARCH_QUERY",t.SET_SEARCH_SUGGESTIONS_ACTION="search__SET_SEARCH_SUGGESTIONS",t.SET_SLIM_SEARCH_SUGGESTIONS_ACTION="search__SET_SLIM_SEARCH_SUGGESTIONS",t.SET_HIGHLIGHTED_ROW_ACTION="search__SET_HIGHLIGHTED_ROW",t.HIGHLIGHT_PREVIOUS_ROW_ACTION="search__HIGHLIGHT_PREVIOUS_ROW",t.HIGHLIGHT_NEXT_ROW_ACTION="search__HIGHLIGHT_NEXT_ROW",t.CLEAR_SEARCH_BAR_ACTION="search__CLEAR_SEARCH_BAR",t.SEARCH_SUCCESSFUL_ACTION="search__SEARCH_SUCCESSFUL",t.CLEAR_ALL_HISTORY_ACTION="search__CLEAR_ALL_HISTORY",t.START_SEARCH_ACTION="search__START_SEARCH",t.SET_SEARCH_RESULTS_ACTION="search__SET_SEARCH_RESULTS",t.CONTINUE_SEARCH_ACTION="search__CONTINUE_SEARCH",t.APPEND_SEARCH_RESULTS_ACTION="search__APPEND_SEARCH_RESULTS",t.SET_FULL_SEARCH_RESULTS_ACTION="search__SET_FULL_SEARCH_RESULTS_ACTION",t.CLEAR_SEARCH_ACTION="search__CLEAR_SEARCH",t.SET_SEARCH_SELECTION_ACTION="search__SET_SEARCH_SELECTION",t.CHANGE_FILES_ACTION="search__CHANGE_SEARCH_FILES",t.SET_SCOPE_CHIP_ACTION="search__SET_SCOPE_CHIP_ACTION",t.SET_FILE_TYPE_FILTER_ACTION="search__SET_FILE_TYPE_FILTER_ACTION",t.SELECT_FIRST_FILE_ACTION="search__SET_FIRST_FILE_ACTION",t.SET_FOLDER_SIZE_ACTION="search__SET_FOLDER_SIZE_ACTION",t.SORT_SEARCH_RESULTS_ACTION="search__SORT_SEARCH_RESULTS_ACTION",t.SET_IMAGE_SEARCH_SUGGESTION_ACTION="search__SET_IMAGE_SEARCH_SUGGESTION_ACTION",t.ADMIN_CONSOLE_SEARCH_ENDPOINT="/search/admin_console_search",t.SEARCH_FRONTEND_SERVICE_ENDPOINT="/search/full_search_result",t.FILE_INFO_ENDPOINT="/browse_file_info",t.DIRECT_BLOCKSERVER_LINK="direct_blockserver_link",t.HREF="href";(function(e){e.LOADED="LOADED",e.LOADING_FIRST_PAGE="LOADING_FIRST_PAGE",e.LOADING_ADDITIONAL_PAGE="LOADING_ADDITIONAL_PAGE"})(t.SearchLoadingState||(t.SearchLoadingState={}));(function(e){e.ALL="all",e.IMAGE="image"})(t.SearchType||(t.SearchType={})),t.SEARCH_RECENT_HISTORY_CAPACITY=5,t.SEARCH_RECENT_HISTORY_STORAGE_KEY="search_recent_history",t.FILE_CATEGORIES_UNCHECKED=(n={},n[r.FileCategory.IMAGE]="unchecked",n[r.FileCategory.DOCUMENT]="unchecked",n[r.FileCategory.PDF]="unchecked",n[r.FileCategory.SPREADSHEET]="unchecked",n[r.FileCategory.PRESENTATION]="unchecked",n[r.FileCategory.AUDIO]="unchecked",n[r.FileCategory.VIDEO]="unchecked",n[r.FileCategory.FOLDER]="unchecked",n[r.FileCategory.PAPER]="unchecked",n[r.FileCategory.OTHER]="unchecked",n),t.NUMBER_FILE_TYPE_CHECKBOXES_ALWAYS_SHOWN=4,t.FILE_CATEGORIES_CHECKED=(s={},s[r.FileCategory.IMAGE]="checked",s[r.FileCategory.DOCUMENT]="checked",s[r.FileCategory.PDF]="checked",s[r.FileCategory.SPREADSHEET]="checked",s[r.FileCategory.PRESENTATION]="checked",s[r.FileCategory.AUDIO]="checked",s[r.FileCategory.VIDEO]="checked",s[r.FileCategory.FOLDER]="checked",s[r.FileCategory.PAPER]="checked",s[r.FileCategory.OTHER]="checked",s),t.SEARCH_RECENT_FILES_CAPACITY=5,t.GET_FILE_METADATA_ENDPOINT="/home_feed/get_file_metadata",t.ENCODED_FILE_OBJ_ID="ENCODED_FILE_OBJ_ID",t.FILE_NAME_FONT_SIZE=14,t.FILE_LOCATION_FONT_SIZE=12,t.FILE_NAME_CONST_CELL_BUFFER_EM=2,t.FILE_LOCATION_CONST_CELL_BUFFER_EM=4,t.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH=65,t.PAPER_BASE_URL="https://paper.dropbox.com",t.PAPER_DOC_BASE_URL=t.PAPER_BASE_URL+"/doc/",t.PAPER_FOLDER_BASE_URL=t.PAPER_BASE_URL+"/folder/show/",t.TIME_TO_INVALIDATE_QUERY_SUGGESTIONS_CACHE=6e4}),define("modules/clean/search/logger",["require","exports","tslib","modules/clean/analytics","modules/clean/search/api_helpers","modules/clean/react/browse/logger_util"],function(e,t,r,n,s,o){"use strict";function i(e){var t=e.searchSessionId,i=e.result,a=e.user,c=e.action_type,l=e.search_type,u=e.viewport,_=void 0===u?"full-view":u,p=e.view_type,d=e.action_surface,h=s.getCurrentTimezoneOffset(),E={viewport:_,action_type:c,search_type:l,search_session_id:t,view_type:p,position:i.sort_rank,request_id:i.request_id,timezone_offset:h};if(o.isFile(i)){var S=i;E=r.__assign({},E,{file_nsid:S.ns_id,file_sjid:S.sjid,match_type:S.match_type})}else if(o.isPaper(i)){var m=i;E=r.__assign({},E,{paper_pad_id:m.pad_id})}else if(o.isPaperFolder(i)){var f=i;E=r.__assign({},E,{paper_folder_id:f.folder_id})}else{var S=i,g=S.is_cloud_doc?L.SHARED_CLOUD_DOC:L.SHARED_DOC;E=r.__assign({},E,{match_type:S.match_type,file_id:S.file_id,extra:{result_type:g}})}d&&(E.extra=r.__assign({},E.extra,{action_surface:d})),n.SearchClientActivityLogger.log("result_action",a.id,E)}function a(e){var t=e.searchSessionId,r=e.user,o=e.history,i=s.getCurrentTimezoneOffset(),a=o.map(function(e){return e.rawQuery}).reduce(function(e,t,r){return e[r]=t,e},{}),c={search_session_id:t,recent_history_map:JSON.stringify(a),timezone_offset:i,viewport:"dropdown-view"};n.SearchClientActivityLogger.log("recent_history_displayed",r.id,c)}function c(e){var t=e.searchSessionId,r=e.user,o=s.getCurrentTimezoneOffset(),i={search_session_id:t,timezone_offset:o,viewport:"dropdown-view"};n.SearchClientActivityLogger.log("recent_history_cleared",r.id,i)}function l(e){var t=e.searchSessionId,r=e.query,o=e.user,i=e.rank,a=e.action_type,c=s.getCurrentTimezoneOffset(),l={search_session_id:t,query_string:r.rawQuery,position:i,timezone_offset:c,viewport:"dropdown-view",action_type:a};n.SearchClientActivityLogger.log("recent_query_selected",o.id,l)}function u(e){var t=e.searchSessionId,r=e.requestId,o=e.query,i=e.user,a=e.previousPosition,c=e.viewport,l=void 0===c?"dropdown-view":c,u=s.getCurrentTimezoneOffset(),_={search_session_id:t,request_id:r,query_string:o.rawQuery,position:a,timezone_offset:u,viewport:l};n.SearchClientActivityLogger.log("recent_query_stored",i.id,_)}function _(e){var t=e.searchSessionId,r=e.user,o=e.chipAdded,i=e.filePath,a=e.searchType,c=e.viewport,l=s.getCurrentTimezoneOffset(),u={search_session_id:t,timezone_offset:l,path_scoped:o,file_path:i,viewport:c,search_type:a};n.SearchClientActivityLogger.log("scope_chip_changed",r.id,u)}function p(e){var t=e.searchSessionId,r=e.user,o=e.deletedFiles,i=e.searchType,a=e.viewport,c=s.getCurrentTimezoneOffset(),l={search_session_id:t,timezone_offset:c,deleted_filter:o,viewport:a,search_type:i};n.SearchClientActivityLogger.log("deleted_filter_changed",r.id,l)}function d(e){var t=e.searchSessionId,r=e.user,o=s.getCurrentTimezoneOffset(),i={search_session_id:t,timezone_offset:o};n.SearchClientActivityLogger.log("search_bar_focus_lost",r.id,i)}function h(e,t){var n=e;return r.__assign({},t,{file_nsid:n.ns_id,file_sjid:n.sjid,match_type:n.match_type||void 0})}function E(e){var t=e.searchSessionId,r=e.result,o=e.user,i=e.previewRequestId,a=e.viewport,c=void 0===a?"dropdown-view":a,l=s.getCurrentTimezoneOffset(),u={search_session_id:t,preview_request_id:i,timezone_offset:l,viewport:c};n.SearchClientActivityLogger.log("preview_started",o.id,h(r,u))}function S(e){var t=e.searchSessionId,r=e.result,o=e.user,i=e.previewRequestId,a=e.viewport,c=void 0===a?"dropdown-view":a,l=e.latency,u=e.displayed,_=s.getCurrentTimezoneOffset(),p={search_session_id:t,preview_request_id:i,timezone_offset:_,viewport:c,latency:l,displayed:u?"true":"false"};n.SearchClientActivityLogger.log("preview_completed",o.id,h(r,p))}function m(e){var t=e.searchSessionId,r=e.result,o=e.user,i=e.previewRequestId,a=e.viewport,c=void 0===a?"dropdown-view":a,l=e.failureType,u=s.getCurrentTimezoneOffset(),_={search_session_id:t,preview_request_id:i,timezone_offset:u,viewport:c,failure_type:l};n.SearchClientActivityLogger.log("preview_failed",o.id,h(r,_))}function f(e){var t=e.searchSessionId,r=e.user,s=e.action_type,o=e.search_type,i=e.sort_order,a=e.viewport,c=void 0===a?"full-view":a,l=e.view_type,u={sort_field:i.sortField,sort_direction:i.sortDirection},_={viewport:c,action_type:s,search_type:o,search_session_id:t,view_type:l,extra:u};n.SearchClientActivityLogger.log("sort_results",r.id,_)}function g(e){var t=e.searchSessionId,r=e.user,s={search_session_id:t,viewport:"dropdown-view"};n.SearchClientActivityLogger.log("recent_files_displayed",r.id,s),n.SearchClientActivityLogger.log("query_started",r.id,s),n.SearchClientActivityLogger.log("query_completed",r.id,s)}function C(e){var t=e.searchSessionId,r=e.user,s=e.resultCount,o=e.latencyMs,i={search_session_id:t,viewport:"dropdown-view",result_count:s,latency:o};n.SearchClientActivityLogger.log("recent_files_fetched",r.id,i)}function R(e){var t=e.searchSessionId,r=e.user,s={search_session_id:t,viewport:"dropdown-view"};n.SearchClientActivityLogger.log("recent_files_failed",r.id,s)}function I(e){var t=e.searchSessionId,r=e.user,s=e.index,o={search_session_id:t,viewport:"dropdown-view",position:s};n.SearchClientActivityLogger.log("recent_files_clicked",r.id,o),n.SearchClientActivityLogger.log("result_action",r.id,o)}function T(e){var t=e.searchSessionId,r=e.user,s=e.index,o={search_session_id:t,viewport:"dropdown-view",position:s};n.SearchClientActivityLogger.log("recent_files_location_clicked",r.id,o),n.SearchClientActivityLogger.log("result_action",r.id,o)}function A(e){var t=e.searchSessionId,r=e.user,s=e.query,o={search_session_id:t,viewport:"dropdown-view",query_string:s};n.SearchClientActivityLogger.log("query_suggestions_displayed",r.id,o)}function y(e){var t=e.searchSessionId,r=e.user,s=e.query,o={search_session_id:t,viewport:"dropdown-view",query_string:s};n.SearchClientActivityLogger.log("query_suggestions_dismissed",r.id,o)}function O(e){var t=e.searchSessionId,r=e.user,s=e.query,o=e.suggestions,i=e.latencyMs,a={search_session_id:t,viewport:"dropdown-view",query_string:s,latency:i,extra:{query_suggestions:JSON.stringify(o.map(function(e){return e.text}))}};n.SearchClientActivityLogger.log("query_suggestions_fetched",r.id,a)}function D(e){var t=e.searchSessionId,r=e.user,s=e.query,o={search_session_id:t,viewport:"dropdown-view",query_string:s};n.SearchClientActivityLogger.log("query_suggestions_failed",r.id,o)}function v(e){var t=e.searchSessionId,r=e.user,s=e.query,o=e.index,i={search_session_id:t,viewport:"dropdown-view",query_string:s,position:o};n.SearchClientActivityLogger.log("query_suggestions_clicked",r.id,i)}Object.defineProperty(t,"__esModule",{value:!0});var L;(function(e){e.SHARED_DOC="shared_doc",e.SHARED_CLOUD_DOC="shared_cloud_doc"})(L=t.SearchLogResultType||(t.SearchLogResultType={})),t.logSearchAction=i,t.logRecentHistoryDisplayed=a,t.logRecentHistoryCleared=c,t.logRecentQuerySelected=l,t.logRecentQueryStored=u,t.logScopeChipChanged=_,t.logDeletedFilterChanged=p,t.logSearchBarFocusLost=d,t.logHoverPreviewStarted=E,t.logHoverPreviewCompleted=S,t.logHoverPreviewFailed=m,t.logSearchResultsSortOrderChange=f,t.logRecentFilesDisplayed=g,t.logRecentFilesFetched=C,t.logRecentFilesFailed=R,t.logRecentFilesClicked=I,t.logRecentFilesLocationClicked=T,t.logQuerySuggestionsDisplayed=A,t.logQuerySuggestionsDismissed=y,t.logQuerySuggestionsFetched=O,t.logQuerySuggestionsFailed=D,t.logQuerySuggestionsClicked=v}),define("modules/clean/search/models",["require","exports","tslib","external/deep-freeze","modules/clean/immutability_helper","modules/clean/react/browse/models"],function(e,t,r,n,s,o){"use strict";function i(e){return new o.BrowseContext({isInFolderMode:e.inside_dir,inactiveNSIDByFQPath:e.old_path_to_ns_id,blockHash:e.block_hash})}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var a=(function(){function e(e){this.fq_path=e.fq_path,this.is_unmounted=e.is_unmounted,this.icon=e.icon,this.filename_highlights=e.filename_highlights,this.highlight_spans=e.highlight_spans,this.ns_id=e.ns_id,this.sjid=e.sjid,this.is_dir=e.is_dir,this.is_symlink=e.is_symlink,this.type=e.type,this.ns_path=e.ns_path,this.match_type=e.match_type,this._mount_access_perms=e.mount_access_perms,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.hover_preview_url=e.hover_preview_url,this.request_id=e.request_id,this.sort_rank=e.sort_rank,n.default(this)}return e.fromServerObject=function(t){return new e(t)},e})();t.SlimFileSearchResult=a,t.extractBrowseContext=i;var c=(function(){function e(e){var t=e.entity;this.file_id=t.id,this.fq_path=t.fq_path,this.is_dir=t.is_dir,this.last_viewed_date=e.when_milli}return e.fromServerObject=function(t){return new e(t)},e.prototype.merge=function(e){return s.merge(this,e)},e})();t.RecentFile=c;var l=(function(){function e(e){var t=e.entity;this.pad_id=t.id,this.title=t.name,this.last_viewed_date=e.when_milli}return e.fromServerObject=function(t){return new e(t)},e.prototype.merge=function(e){return s.merge(this,e)},e})();t.RecentPaper=l;var u=(function(){function e(e){var t=e.entity;this.folder_id=t.id,this.name=t.name,this.last_viewed_date=e.when_milli}return e.fromServerObject=function(t){return new e(t)},e.prototype.merge=function(e){return s.merge(this,e)},e})();t.RecentPaperFolder=u}),define("modules/clean/search/search_bar/api",["require","exports","tslib","modules/clean/ajax","modules/clean/api_v2/user_client","modules/clean/filepath","modules/clean/search/constants","modules/clean/analytics","modules/clean/react/browse/models","modules/clean/search/types","modules/clean/search/models","modules/clean/search/api_helpers","modules/clean/search/search_helpers","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/data/store","modules/core/i18n"],function(e,t,r,n,s,o,i,a,c,l,u,_,p,d,h,E){"use strict";function S(e,t){return(new s.UserApiV2Client).ns("home").rpc("get_recents",{limit:t},{subjectUserId:e})}function m(e,t){return new Promise(function(r,s){var o=t.map(function(e){return{id:e,type:i.ENCODED_FILE_OBJ_ID}});n.WebRequest({url:i.GET_FILE_METADATA_ENDPOINT,data:{resources_json:JSON.stringify(o)},dataType:"json",subject_user:e,success:function(e,t,n){r(e)},error:function(e,t,r){s(new Error(r))}})})}function f(e,t){return(new s.UserApiV2Client).ns("paper").rpc("docs/get_metadata",{doc_id:t},{subjectUserId:e})}function g(e,t,r,n){return(new s.UserApiV2Client).ns("files").rpc("get_query_suggestions",{query:t,max_results:r,search_session_id:n},{subjectUserId:e})}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),o=r.__importStar(o),i=r.__importStar(i);var C=(function(e){function t(t){var r=this.constructor,n=this,s=r.prototype;return n=e.call(this,t)||this,n.__proto__=s,n}return r.__extends(t,e),t})(Error);t.RequestAbortedError=C;var R=(function(){function e(){this._searchApiUrl="/search/dropdown_search",this._activeRequest=null}return e.prototype.getSearchApiUrl=function(){return this._searchApiUrl},e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype._extractSlimSearchResultsList=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var s=n[r];switch(s.search_result_type){case l.SearchResultTypes.FILE:t.push(u.SlimFileSearchResult.fromServerObject(s));break;case l.SearchResultTypes.PAPER:t.push(c.Paper.fromServerObject(s));break;case l.SearchResultTypes.PAPER_FOLDER:t.push(c.PaperFolder.fromServerObject(s))}}return t},e.prototype.loadSlimResults=function(e){var t=e.user,n=e.path,s=e.query,o=e.searchSessionId,i=e.experiments,a=e.webTimer,c=e.fileCategories,l=_.getCurrentTimezoneOffset(),u=i.expPaperFolders,d=i.expShowSymlinkIcon,h=c&&p.isInFileTypeFilterExperiment(i)?p.fileCategoriesToString(c):"",E=r.__assign({query:s,fq_path:n,timezone_offset:l,show_paper_folder_results:u,show_symlink_icon:d,search_session_id:o},h&&{file_categories:h});return this._fetchSlimResults(E,t,o,i,a)},e.prototype.fetchAdditionalFileMetadata=function(e){var t=this,r=e.searchResults,s=e.user;return new Promise(function(e,o){
var a=r.filter(function(e){return e instanceof u.SlimFileSearchResult}),c=a.map(function(e){return[e.ns_id,e.sjid,e.fq_path.substr(0,e.fq_path.length-e.ns_path.length)]});c.length>0?n.WebRequest({url:i.FILE_INFO_ENDPOINT,data:{nsid_sjid_fq_mount_point_tuples:JSON.stringify(c),includes:JSON.stringify([i.HREF])},dataType:"json",subject_user:s,success:function(n,s,o){var i=n.file_results;e(t._mergeFullResultsIntoSlimResults(i,r))},error:function(e,t,r){o("abort"===r?new C:new Error(r))}}):e(r)})},e.prototype.fetchFullSearchResult=function(e){var t=e.searchResult,r=e.user,n=e.onSuccess,s=e.onError;if(t instanceof u.SlimFileSearchResult){var o=d.searchResultForPath(h.getStoreForSearchBar().getState(),t.fq_path);o?n(o):this.fetchAdditionalFileMetadata({searchResults:[t],user:r}).then(function(e){if(e.length>0)n(e[0]);else if(s){var t=E._("There was a problem completing this request.");s(t)}}).catch(function(e){!s||e instanceof C||s(e.message)})}else(t instanceof c.Paper||t instanceof c.PaperFolder)&&n(t)},e.prototype._mergeFullResultsIntoSlimResults=function(e,t){for(var n=[],s=function(t){if(t instanceof u.SlimFileSearchResult){var s=e.find(function(e){return e.search_result_type===l.SearchResultTypes.FILE&&o.paths_are_equal(e.fq_path,t.fq_path)});s&&n.push(c.File.fromServerObject(r.__assign({},t,s)))}else(t instanceof c.Paper||t instanceof c.PaperFolder)&&n.push(t)},i=0,a=t;i<a.length;i++){s(a[i])}return n},e.prototype._fetchSlimResults=function(e,t,s,o,i){var c=this;return new Promise(function(l,_){var d;null!=c._activeRequest&&c._activeRequest.abort();var h=p.fileCategoryStringToLogValue(e.file_categories),E=r.__assign({path_scoped:"/"!==e.fq_path,search_type:"dropdown",query_string:e.query,search_session_id:s,timezone_offset:e.timezone_offset},p.isInFileTypeFilterExperiment(o)&&{file_type_filters:h});a.SearchClientActivityLogger.log("query_started",t.id,E);var S=(new Date).getTime();c._activeRequest=n.WebRequest({url:c._searchApiUrl,data:e,dataType:"json",subject_user:t,success:function(r,n,o){for(var _=u.extractBrowseContext(r),p=r.search_results,d=o.getResponseHeader("x-dropbox-request-id"),h=0,m=0,f=p;m<f.length;m++){var g=f[m];g.request_id=d,g.sort_rank||0===g.sort_rank||(g.sort_rank=h++)}var C={results:c._extractSlimSearchResultsList(p),hasMore:!!r.more,nextPageOffset:+r.next_offset||0},R=a.SearchClientActivityLogger.create_search_log_dict(E,d,S,e.query,C.results.length,null,s);a.SearchClientActivityLogger.log("query_completed",t.id,R),i&&i.end(d?d:void 0),l({context:_,searchResults:C,deleted:!1})},error:function(r,n,o){d=r.getResponseHeader("x-dropbox-request-id");var c=a.SearchClientActivityLogger.create_search_log_dict(E,d,S,e.query,null,n,s);a.SearchClientActivityLogger.log("query_failed",t.id,c),i&&i.abort(),_("abort"===o?new C:new Error(o))},complete:function(){this._activeRequest=null}})})},e})();t.SearchBarApiClient=R,t.searchBarApiClient=new R,t.getRecents=S,t.getFileMetadata=m,t.getPaperMetadata=f,t.getQuerySuggestions=g}),define("modules/clean/search/search_bar/chips",["require","exports","tslib","modules/clean/filepath"],function(e,t,r,n){"use strict";function s(e){return n.paths_are_equal(e,"/")}function o(e){return!!e&&!s(e)}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),t.isScopeChipRoot=s,t.isValidPathForChip=o}),define("modules/clean/search/search_bar/controller",["require","exports","tslib","react","external/lodash","external/react-redux","modules/clean/browse_uri_interface","modules/clean/keycode","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/retrieval_success_banner/util","modules/clean/search/logger","modules/clean/search/search_bar/api","modules/clean/search/search_bar/data/action_creators","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/log_helper","modules/clean/search/search_bar/view","modules/clean/search/search_helpers","modules/clean/search/search_bar/chips","modules/clean/storage","modules/clean/viewer","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/core/notify","modules/clean/search/models","modules/clean/search/types","modules/clean/search/search_bar/experiments","modules/clean/search/single_page","modules/clean/react/css","modules/core/browser"],function(e,t,r,n,s,o,i,a,c,l,u,_,p,d,h,E,S,m,f,g,C,R,I,T,A,y,O,D,v,L,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importStar(s),_=r.__importStar(_),d=r.__importStar(d),h=r.__importStar(h),f=r.__importStar(f),g=r.__importStar(g),I=r.__importStar(I),N=r.__importStar(N);var w=(function(t){function o(e){var n=t.call(this,e)||this;return n._searchBarWebTimer=null,n._selectFirstFile=s.noop,n._clearSelection=s.noop,n._logHistoryItemSelected=function(e,t,r){_.logRecentQuerySelected({searchSessionId:n.props.searchSessionId,query:e,user:n.props.user,rank:t-n.props.headerItems.length,action_type:r})},n._handleHistoryItemClick=function(e,t){n._logHistoryItemSelected(e,t),n._setSearchQuery(e.rawQuery)},n._handleRecentSearchContextMenuCapture=function(e,t){n._logHistoryItemSelected(e,t,T.WebUserActionLogEvent.CONTEXT_MENU)},n._handleInputChange=function(e){var t=n.props,r=t.searchBarExperiments,s=t.fetchQuerySuggestions,o=t.user;if(D.isInSinglePageSearchExperiment(r)&&(D.isInFetchQuerySuggestionsExperiment(r)||D.isInPosteriorQuerySuggestionsExperiment(r))){s({user:o,query:e,maxResults:D.getNumOfQuerySuggestionsToFetch(r.expQuerySuggestions)})}n._setSearchQuery(e)},n._handleCancelSearch=function(){n._setSearchQuery(""),D.isInSinglePageSearchExperiment(n.props.searchBarExperiments)&&n.props.blurSearchBar()},n._handleScopeChipChange=function(e){_.logScopeChipChanged({searchSessionId:n.props.searchSessionId,user:n.props.user,chipAdded:e,searchType:"dropdown",filePath:e?n.props.browseScope:"/",viewport:n.props.isExpanded?"full-view":void 0}),e?n.props.setScopeChip({scopeChip:n.props.browseScope}):n.props.setScopeChip({}),n._setSearchQuery(n.props.rawQuery,!0)},n._handleDeletedChipChange=function(e){n.props.setDeletedChip({deletedChip:e}),n._setSearchQuery(n.props.rawQuery,!0)},n._onBrowseScopeChange=function(e){n.props.setScopeChip({scopeChip:g.isValidPathForChip(e)?e:void 0})},n._handleInputKeydown=function(e,t){var r=n.props.normalizedQuery,s=r&&n._areQuerySuggestionsLoaded();if(e.keyCode===a.KeyCode.ESC)return void(s?n._handleQuerySuggestionsDismiss(r):n._handleCancelSearch());if(e.keyCode===a.KeyCode.BACKSPACE&&0===t){if(!g.isScopeChipRoot(n.props.scopeChip))return void n._handleScopeChipChange(!1);if(n.props.deletedChip)return void n._handleDeletedChipChange(!1)}if(e.stopPropagation(),D.isInSinglePageSearchExperiment(n.props.searchBarExperiments)&&!s){if(e.keyCode===a.KeyCode.DOWN&&n.props.rawQuery)return e.preventDefault(),void n._selectFirstFile();e.keyCode===a.KeyCode.TAB&&n.props.blurSearchBar()}e.keyCode===a.KeyCode.UP?(e.preventDefault(),n.props.highlightPreviousRow()):e.keyCode===a.KeyCode.DOWN&&(e.preventDefault(),n.props.highlightNextRow())},n._handleSearch=function(e,t){var s=n.props.searchBarExperiments;s.expSearchSuccessBanner&&!D.isInSinglePageSearchExperiment(s)&&(u.resetSearchSuccessBannerSettings(),u.doSearchBarInteractionBroadcast(!1));var o=f.fileCategoriesToString(n.props.fileCategories);n.props.onSearch({query:e,searchToken:f.getSearchCsrfToken(),searchSessionId:n.props.searchSessionId,searchPath:t||n.props.scopeChip,qargs:r.__assign({d:D.isInDeletedFilterRightRailExperiment(n.props.searchBarExperiments)?n.props.deletedChip?"1":"0":void 0},o&&{file_categories:o},{search_order_by:l.getQueryArgs().search_order_by,search_reverse_order:l.getQueryArgs().search_reverse_order,search_type:l.getQueryArgs().search_type})})},n._navToSelection=function(e){var t=n.props.searchResults[e],r=n.props.slimSearchResults[e];t?(n._handleSlimSearchResultOpen(r),n._openSearchResult(t)):r&&n._handleSearchResultOpen(r)},n._handleInputSubmit=function(e,t){if(e.preventDefault(),!D.isInSinglePageSearchExperiment(n.props.searchBarExperiments)){var r=n.props.headerItems;if(t<r.length)switch(r[t]){case O.SearchBarDropdownHeaderItemType.SEARCH_ALL:n._handleSearch(n.props.normalizedQuery);break;case O.SearchBarDropdownHeaderItemType.SCOPE_CHIPS:var s=!g.isValidPathForChip(n.props.scopeChip);n._handleScopeChipChange(s)}else t-=r.length,n._navToSelection(t)}},n._handleContextMenuCapture=function(e){var t=n.props,r=t.user,s=t.searchSessionId;p.searchBarApiClient.fetchFullSearchResult({searchResult:e,user:r,onSuccess:function(e){n._dispatchSearchSuccessful(e.request_id||""),S.logDropdownSearchAction({result:e,user:r,action_type:e instanceof c.File?T.WebUserActionLogEvent.CONTEXT_MENU:T.WebUserActionLogEvent.PAPER_CONTEXT_MENU,viewport:"dropdown-view",searchSessionId:s})}})},n._handleSlimSearchResultOpen=function(e){var t=n.props,r=t.onSlimSearchResultOpen,s=t.searchBarExperiments,o=s.expSearchSuccessBanner;r&&(o&&"/h"===N.get_pathname()&&u.setSearchSuccessBannerVisibleFromHome(),r(e))},n._handleSearchResultOpen=function(e){var t=n.props,r=t.user;if(t.searchBarExperiments.expSearchSuccessBanner&&e&&e.fq_path&&(u.doSearchBarInteractionBroadcast(!1),u.doSearchResultActionClickBroadcast(!1),u.setSearchSuccessBannerVisible(),e.is_dir)){var s=e.fq_path;u.setFolderSearchResultData(s)}n._handleSlimSearchResultOpen(e),p.searchBarApiClient.fetchFullSearchResult({searchResult:e,user:r,onSuccess:function(e){n._openSearchResult(e)},onError:function(e){A.Notify.error(e)}})},n._handleResultObjectPathClick=function(e){n._dispatchSearchSuccessful(e.request_id||""),n.props.onResultObjectPathClick(e)},n._handleHighlightDropdownItem=function(e){n.props.setHighlightedRow({highlightedSearchRow:e})},n._handleSearchBarFocus=function(){var e=n.props,t=e.user,r=e.searchBarExperiments;D.isInSinglePageSearchExperiment(r)||n._setSearchQuery(n.props.normalizedQuery),r.expSearchSuccessBanner&&!D.isInSinglePageSearchExperiment(r)&&(u.resetSearchSuccessBannerSettings(),u.resetSearchResultClickKey(),u.doSearchBarInteractionBroadcast(!1)),r.expBrowseSuccessBanner===O.BrowseSuccessBannerVariants.V1||r.expBrowseSuccessBanner===O.BrowseSuccessBannerVariants.V3?(u.clearBrowseSuccessBannerCounter(),u.clearBrowseSuccessBannerKey()):r.expBrowseSuccessBanner===O.BrowseSuccessBannerVariants.V2&&u.clearBSBExtraData(),n.props.focusSearchBar(),n.props.loadHistory({user:t}),D.isInSinglePageSearchExperiment(r)&&n._clearSelection()},n._handleSearchBarBlur=function(){var e=n.props,t=e.searchBarExperiments,r=e.searchBarLoading,s=e.slimSearchResults;!t.expSearchSuccessBanner||u.userIsOptedOutOfRetrievalSuccessBanner()||u.shouldShowSearchSuccessBanner()||r||!s.length||u.doSearchBarInteractionBroadcast(!0),n.props.blurSearchBar()},n._dispatchSearchSuccessful=function(e){var t=n.props,r=t.user,s=t.rawQuery,o=t.normalizedQuery,i=t.searchSessionId;(0,t.addQueryToHistory)({user:r,query:{rawQuery:s,normalizedQuery:o},searchSessionId:i,requestId:e})},n._logSearchBarTTI=function(){n._searchBarWebTimer&&n._searchBarWebTimer.markTimeToInteractive()},n._handleHistoryClearAllClick=function(){var e=n.props,t=e.user;(0,e.clearAllHistory)({user:t})},n._handleSearchFiltersChanged=function(e){n.props.rawQuery?n.props.onSearchFiltersChanged(e):void 0!==e.path&&n.props.setScopeChip({scopeChip:e.path})},n._handleRecentItemClick=function(e,t){var r=n.props,s=r.searchSessionId,o=r.user;e instanceof y.RecentFile?N.open_tab(i.browse_uri_for_fq_path(o,e.fq_path).toString()):N.open_tab(f.buildPaperUrl(e)),_.logRecentFilesClicked({searchSessionId:s,user:o,index:t})},n._handleRecentFileLocationClick=function(e,t){var r=n.props,s=r.searchSessionId,o=r.user;N.open_tab(i.browse_uri_for_fq_path(o,e).toString()),_.logRecentFilesLocationClicked({searchSessionId:s,user:o,index:t})},n._handleQuerySuggestionsClick=function(e,t){var r=n.props,s=r.searchSessionId,o=r.user,i=r.normalizedQuery,a=e.text||"";n._setSearchQuery(a),_.logQuerySuggestionsClicked({searchSessionId:s,user:o,query:i,index:t})},n._handleQuerySuggestionsDismiss=function(e){n.props.dismissQuerySuggestions({user:n.props.user,query:e})},n._areQuerySuggestionsLoaded=function(){var e=n.props,t=e.searchBarExperiments,r=e.querySuggestions,s=e.querySuggestionsLoadingState;return f.areQuerySuggestionsLoaded(t,r,s)},e.setExperiments({experiments:e.searchBarExperiments}),n.props.setScopeChip({scopeChip:e.currentPath}),n}return r.__extends(o,t),o.prototype.componentWillMount=function(){var e=R.Viewer.get_viewer().get_users().map(function(e){return e.id});C.UserLocalStorage.clearOtherUsers(e);var t=this.props,r=t.user,n=t.searchBarExperiments,s=t.normalizedQuery;D.isInSinglePageSearchExperiment(n)&&D.isInRecentFilesExperiment(n)&&!s&&this.props.fetchRecentItems({user:r})},o.prototype.componentWillUnmount=function(){this._logFocusLost(this.props.isFocused,!1)},o.prototype.componentWillReceiveProps=function(e){this.props.currentPath!==e.currentPath&&this._onBrowseScopeChange(e.currentPath||o.defaultProps.currentPath),this.props.searchBarExperiments!==e.searchBarExperiments&&this.props.setExperiments({experiments:e.searchBarExperiments})},o.prototype.componentDidUpdate=function(e){this._logFocusLost(e.isFocused,this.props.isFocused),this.props.currentPath===e.currentPath&&f.fileCategoriesToString(this.props.fileCategories)===f.fileCategoriesToString(e.fileCategories)||this.props.invalidateResults()},o.prototype.componentDidMount=function(){var t=this;D.isInSinglePageSearchExperiment(this.props.searchBarExperiments)&&I.waitForTTI().then(function(){Promise.all([new Promise(function(t,r){e(["modules/clean/search/search_results/actions"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/react/selection"],t,r)}).then(r.__importStar)]).then(function(e){var r=e[0].searchResultsActions,n=e[1].createSelection;t._selectFirstFile=function(){r.selectFirstFile()},t._clearSelection=function(){r.setSearchSelection({selection:n()})}})})},o.prototype._logFocusLost=function(e,t){e&&!t&&_.logSearchBarFocusLost({user:this.props.user,searchSessionId:this.props.searchSessionId})},o.prototype._setSearchQuery=function(e,t){var r=this;void 0===t&&(t=!1);var n=this.props,s=n.user,o=n.setSearchQueryAndFetchResults,i=n.searchBarExperiments;o({user:s,query:e,webTimer:D.isInSinglePageSearchExperiment(i)?void 0:this._startSearchBarTimer(),keepHighlightedRow:t}),D.isInSinglePageSearchExperiment(i)&&setTimeout(function(){r._handleSearch(e)})},o.prototype._openSearchResult=function(e){this._dispatchSearchSuccessful(e.request_id||""),this.props.onSearchResultOpen(e)},o.prototype._startSearchBarTimer=function(){return this._searchBarWebTimer?this._searchBarWebTimer.restart():(this._searchBarWebTimer=I.get_timer("search_bar"),this._searchBarWebTimer.initialize({requireTTI:!0,requireTTV:!1,url:p.searchBarApiClient.getSearchApiUrl()})),this._searchBarWebTimer},o.prototype.render=function(){var e=this.props,t=e.user,r=e.isExpanded,s=e.isFocused,o=e.isActive,i=e.rawQuery,a=e.normalizedQuery,c=e.slimSearchResults,l=e.searchBarLoading,u=e.searchSessionId,_=e.highlightedRow,p=e.searchHistory,d=e.scopeChip,h=e.deletedChip,E=e.searchPath,S=e.headerItems,f=e.searchBarExperiments,g=e.browseScope,C=e.searchFrom,R=e.recentItems,I=e.recentItemsLoadingState,T=e.querySuggestions,A=this.props.deletedChipEnabled&&D.isInDeletedFilterRightRailExperiment(f);return D.isInSinglePageSearchExperiment(f)?n.default.createElement(v.SinglePageSearchView,{onSearchFiltersChanged:this._handleSearchFiltersChanged,user:t,isExpanded:!!r,searchBarExperiments:f,isFocused:s,isActive:o,normalizedQuery:a,searchSessionId:u,searchHistory:p,scopeChip:d,deletedChip:h,enableDeletedChip:A,browseScope:g,searchPath:E,inputTextValue:i,dropdownHeaderItems:S,highlightedRow:_,searchFrom:C,onSearch:this._handleSearch,onHistoryClearAllClick:this._handleHistoryClearAllClick,onHistoryItemClick:this._handleHistoryItemClick,onInputChange:this._handleInputChange,onInputKeydown:this._handleInputKeydown,onInputSubmit:this._handleInputSubmit,onSearchResultOpen:this._handleSearchResultOpen,onContextMenuCapture:this._handleContextMenuCapture,onRecentSearchContextMenuCapture:this._handleRecentSearchContextMenuCapture,onResultObjectPathClick:this._handleResultObjectPathClick,onSearchBarFocus:this._handleSearchBarFocus,onSearchBarBlur:this._handleSearchBarBlur,onSearchChipInteraction:this._handleScopeChipChange,onDeletedChipInteraction:this._handleDeletedChipChange,onHighlightDropdownItem:this._handleHighlightDropdownItem,recentItems:R,recentItemsLoadingState:I,onRecentItemClick:this._handleRecentItemClick,onRecentFileLocationClick:this._handleRecentFileLocationClick,areQuerySuggestionsLoaded:this._areQuerySuggestionsLoaded(),querySuggestions:T,onQuerySuggestionsClick:this._handleQuerySuggestionsClick,onQuerySuggestionsDismiss:this._handleQuerySuggestionsDismiss}):n.default.createElement(m.SearchBarView,{user:t,isExpanded:!!r,searchBarExperiments:f,isFocused:s,isActive:o,inputTextValue:i,normalizedQuery:a,searchResults:c,searchBarLoading:l,searchSessionId:u,highlightedRow:_,searchHistory:p,scopeChip:d,deletedChip:h,enableDeletedChip:A,browseScope:g,searchPath:E,dropdownHeaderItems:S,onSearch:this._handleSearch,onHistoryClearAllClick:this._handleHistoryClearAllClick,onHistoryItemClick:this._handleHistoryItemClick,onInputChange:this._handleInputChange,onInputKeydown:this._handleInputKeydown,onInputSubmit:this._handleInputSubmit,onSearchResultOpen:this._handleSearchResultOpen,onContextMenuCapture:this._handleContextMenuCapture,onRecentSearchContextMenuCapture:this._handleRecentSearchContextMenuCapture,onResultObjectPathClick:this._handleResultObjectPathClick,onSearchBarFocus:this._handleSearchBarFocus,onSearchBarBlur:this._handleSearchBarBlur,onHighlightDropdownItem:this._handleHighlightDropdownItem,onSearchChipInteraction:this._handleScopeChipChange,onDeletedChipInteraction:this._handleDeletedChipChange,onDropdownTTI:this._logSearchBarTTI})},o.defaultProps={currentPath:"/",isExpanded:!1},o})(n.default.PureComponent);t.SearchBarControllerElement=w;var B=E.getStoreForSearchBar(),P=function(e){var t=h.isSearchBarFocused,r=h.isSearchBarActive,n=h.rawQuery,s=h.normalizedQuery,o=h.searchResults,i=h.slimSearchResults,a=h.isSearchBarLoading,c=h.searchSessionId,l=h.highlightedSearchRow,u=h.searchHistory,_=h.scopeChip,p=h.deletedChip,d=h.deletedChipEnabled,E=h.searchPath,S=h.headerItems,m=h.browseScope,f=h.fileCategories,g=h.resultsInvalid,C=h.recentItems,R=h.recentItemsLoadingState,I=h.querySuggestions,T=h.querySuggestionsLoadingState;return{isFocused:t(e),isActive:r(e),rawQuery:n(e),normalizedQuery:s(e),searchResults:o(e),slimSearchResults:i(e),searchBarLoading:a(e),searchSessionId:c(e),highlightedRow:l(e),searchHistory:u(e),scopeChip:_(e),deletedChip:p(e),deletedChipEnabled:d(e),searchPath:E(e),headerItems:S(e),browseScope:m(e),fileCategories:f(e),resultsInvalid:g(e),recentItems:C(e),recentItemsLoadingState:R(e),querySuggestions:I(e),querySuggestionsLoadingState:T(e)}},F={blurSearchBar:d.blurSearchBar,focusSearchBar:d.focusSearchBar,loadHistory:d.loadHistory,highlightPreviousRow:d.highlightPreviousRow,highlightNextRow:d.highlightNextRow,setHighlightedRow:d.setHighlightedRow,addQueryToHistory:d.addQueryToHistory,setSearchQueryAndFetchResults:d.setSearchQueryAndFetchResults,clearAllHistory:d.clearAllHistory,setExperiments:d.setExperiments,setScopeChip:d.setScopeChip,setDeletedChip:d.setDeletedChip,invalidateResults:d.invalidateResults,fetchRecentItems:d.fetchRecentItems,fetchQuerySuggestions:d.fetchQuerySuggestions,dismissQuerySuggestions:d.dismissQuerySuggestions},b=o.connect(P,F)(w),H=function(e){return n.default.createElement(o.Provider,{store:B},n.default.createElement(b,r.__assign({},e)))};t.SearchBarController=L.requireCssWithComponent(H,["/static/css/search/search_bar_react-vflQIciKt.css"])}),define("modules/clean/search/search_bar/data/action_creators",["require","exports","tslib","modules/clean/search/constants","modules/clean/search/logger","modules/clean/search/models","modules/clean/search/search_bar/api","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/data/types","modules/clean/search/search_bar/experiments","modules/clean/search/search_bar/history","modules/clean/search/search_helpers","modules/clean/search/store_helpers","modules/clean/search/types","modules/core/exception"],function(e,t,r,n,s,o,i,a,c,l,u,_,p,d,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s),a=r.__importStar(a),u=r.__importStar(u),_=r.__importStar(_),p=r.__importStar(p),h=r.__importStar(h),t.focusSearchBar=function(){return{type:c.ActionTypes.FOCUS}},t.blurSearchBar=function(){return{type:c.ActionTypes.BLUR}},t.clearSearchBar=function(){return{type:c.ActionTypes.CLEAR}},t.updateHistoryInternal=function(e){var t=e.searchHistory;return{type:c.ActionTypes.UPDATE_HISTORY,payload:{searchHistory:t}}},t.loadHistory=function(e){var r=e.user;return function(e){var n=u.getHistory(r);e(t.updateHistoryInternal({searchHistory:n}))}},t.addQueryToHistory=function(e){var r=e.user,n=e.query,s=e.searchSessionId,o=e.requestId,i=e.skipLogging;return function(e){var a=u.addQuery(r,n,s,o,i);e(t.updateHistoryInternal({searchHistory:a}))}},t.clearAllHistory=function(e){var r=e.user,n=e.skipLogging;return function(e,s){var o=u.clearAll(r,a.searchSessionId(s()),n);e(t.updateHistoryInternal({searchHistory:o}))}},t.setSearchQuery=function(e){var t=e.query,r=e.searchSessionId,n=e.keepHighlightedRow,s=e.searchPath;return{type:c.ActionTypes.SET_QUERY,payload:{query:t,searchSessionId:r,keepHighlightedRow:n,searchPath:s}}},t.setSearchResults=function(e){var t=e.searchResults;return{type:c.ActionTypes.SET_SEARCH_RESULTS,payload:{searchResults:t}}},t.setSlimSearchResults=function(e){var t=e.slimSearchResults;return{type:c.ActionTypes.SET_SLIM_SEARCH_RESULTS,payload:{slimSearchResults:t}}},t.setHighlightedRow=function(e){var t=e.highlightedSearchRow;return{type:c.ActionTypes.SET_HIGHLIGHTED_ROW,payload:{highlightedSearchRow:t}}},t.highlightPreviousRow=function(){return{type:c.ActionTypes.HIGHLIGHT_PREVIOUS_ROW}},t.highlightNextRow=function(){return{type:c.ActionTypes.HIGHLIGHT_NEXT_ROW}},t.setBrowseScope=function(e){var t=e.browseScope;return{type:c.ActionTypes.SET_BROWSE_SCOPE,payload:{browseScope:t}}},t.setScopeChip=function(e){var t=e.scopeChip;return{type:c.ActionTypes.SET_SCOPE_CHIP,payload:{scopeChip:t}}},t.setDeletedChip=function(e){var t=e.deletedChip;return{type:c.ActionTypes.SET_DELETED_CHIP,payload:{deletedChip:t}}},t.setDeletedChipEnabled=function(e){var t=e.enabled;return{type:c.ActionTypes.SET_DELETED_CHIP_ENABLED,payload:{enabled:t}}},t.setFileCategories=function(e){var t=e.fileCategories;return{type:c.ActionTypes.SET_FILE_CATEGORIES,payload:{fileCategories:t}}},t.invalidateResults=function(){return{type:c.ActionTypes.INVALIDATE_RESULTS}},t.setSearchQueryAndFetchResults=function(n){var s=this,o=n.user,c=n.query,u=n.webTimer,_=n.searchSessionId,p=n.keepHighlightedRow;return function(n,d){return r.__awaiter(s,void 0,void 0,function(){var s,E,S,m,f,g,C,R;return r.__generator(this,function(I){switch(I.label){case 0:if(s=a.scopeChip(d()),E=function(){return c===a.rawQuery(d())&&s===a.searchPath(d())},E()&&!a.resultsInvalid(d()))return[2];if(n(t.setSearchQuery({query:c,searchPath:s,searchSessionId:_,keepHighlightedRow:p})),a.deletedChip(d()))return n(t.setSearchResults({searchResults:{results:[],hasMore:!1}})),[2];if(l.isInSinglePageSearchExperiment(a.experiments(d())))return n(t.setSearchResults({searchResults:{results:[],hasMore:!1}})),[2];if(!a.isSearchBarLoading(d()))return[3,9];S=a.experiments(d()),I.label=1;case 1:return I.trys.push([1,8,,9]),[4,i.searchBarApiClient.loadSlimResults({user:o,path:s,query:a.normalizedQuery(d()),searchSessionId:a.searchSessionId(d()),experiments:S,webTimer:u,fileCategories:a.fileCategories(d())})];case 2:if(m=I.sent().searchResults,!E())return[2];I.label=3;case 3:return I.trys.push([3,5,,6]),[4,new Promise(function(t,r){e(["modules/clean/react/starred/browse_exports"],t,r)}).then(r.__importStar)];case 4:return f=I.sent().checkForMissingStarredData,f({items:m.results,user:o}),[3,6];case 5:return g=I.sent(),h.reportException({err:g,severity:h.SEVERITY.NONCRITICAL,tags:["search_bar"]}),[3,6];case 6:return n(t.setSlimSearchResults({slimSearchResults:m})),[4,i.searchBarApiClient.fetchAdditionalFileMetadata({searchResults:m.results,user:o})];case 7:return C=I.sent(),E()?(n(t.setSearchResults({searchResults:{results:C,hasMore:!1}})),[3,9]):[2];case 8:if(R=I.sent(),!(R instanceof i.RequestAbortedError))throw R;return[3,9];case 9:return[2]}})})}},t.setExperiments=function(e){var t=e.experiments;return{type:c.ActionTypes.SET_EXPERIMENTS,payload:{experiments:t}}},t.fetchRecentItems=function(e){var t=this,c=e.user;return function(e,l){return r.__awaiter(t,void 0,void 0,function(){var t,u,p,g,C,R,I,T,A,y,O;return r.__generator(this,function(r){switch(r.label){case 0:t=a.experiments(l()).expRecentFiles,u=a.searchSessionId(l()),e(f({recentItemsLoadingState:d.RecentItemsLoadingState.LOADING})),p=Date.now(),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,i.getRecents(c.id,n.SEARCH_RECENT_FILES_CAPACITY)];case 2:return g=r.sent().recent_events,C=g.map(_.recentItemFromServerObject),R=_.createRecentItemsMap(C),e(m({recentItems:R})),I=C.filter(function(e){return e instanceof o.RecentFile}),T=C.filter(function(e){return e instanceof o.RecentPaper}),A=[],I.length>0&&A.push(E(I,c,e,l)),t===d.RecentFilesVariants.ON_MODIFIED_DATE&&T.length>0&&A.push.apply(A,T.map(function(t){return S(t,c,e,l)})),[4,Promise.all(A)];case 3:return r.sent(),e(f({recentItemsLoadingState:d.RecentItemsLoadingState.LOADED})),s.logRecentFilesFetched({searchSessionId:u,user:c,resultCount:R.size,latencyMs:Date.now()-p}),[3,5];case 4:return y=r.sent(),O=y.raw?y.raw.responseBody:"Received error response from get recents API",h.reportException({err:new Error(O),tags:["search_bar","search_bar_recents"],severity:h.SEVERITY.NONCRITICAL}),e(f({recentItemsLoadingState:d.RecentItemsLoadingState.FAILED})),s.logRecentFilesFailed({searchSessionId:u,user:c}),[3,5];case 5:return[2]}})})}};var E=function(e,t,n,o){return r.__awaiter(this,void 0,void 0,function(){var c,l,u,_,p;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),c=e.map(function(e){return e.file_id}),[4,i.getFileMetadata(t,c)];case 1:return l=r.sent(),u=new Map,a.recentItems(o()).forEach(function(e,t){u.set(t,e)}),l.forEach(function(e){var t=e.file_metadata,r=t.file_id;if(u.has(r)){var n=u.get(r);u.set(r,n.merge({last_modified_date:t.ts?1e3*t.ts:t.ts,last_modified_name:t.last_modified_name,thumbnail_url_tmpl:t.thumbnail_url_tmpl}))}}),n(m({recentItems:u})),[3,3];case 2:return _=r.sent(),p=_.raw?_.raw.responseBody:"Received error response from get file metadata API",h.reportException({err:new Error(p),tags:["search_bar","search_bar_recents"],severity:h.SEVERITY.NONCRITICAL}),n(f({recentItemsLoadingState:d.RecentItemsLoadingState.FAILED})),s.logRecentFilesFailed({searchSessionId:a.searchSessionId(o()),user:t}),[3,3];case 3:return[2]}})})},S=function(e,t,n,o){return r.__awaiter(this,void 0,void 0,function(){var c,l,u,_,p,E,S,g;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),c=e.pad_id,[4,i.getPaperMetadata(t.id,c)];case 1:return l=r.sent(),u=l.last_updated_date,_=l.last_editor,p=new Map,a.recentItems(o()).forEach(function(e,t){p.set(t,e)}),p.has(c)&&(E=p.get(c),p.set(c,E.merge({last_modified_date:Date.parse(u),last_modified_name:_}))),n(m({recentItems:p})),[3,3];case 2:return S=r.sent(),g=S.raw?S.raw.responseBody:"Received error response from get paper metadata API",h.reportException({err:new Error(g),tags:["search_bar","search_bar_recents"],severity:h.SEVERITY.NONCRITICAL}),n(f({recentItemsLoadingState:d.RecentItemsLoadingState.FAILED})),s.logRecentFilesFailed({searchSessionId:a.searchSessionId(o()),user:t}),[3,3];case 3:return[2]}})})},m=function(e){var t=e.recentItems;return{type:c.ActionTypes.SET_RECENT_ITEMS,payload:{recentItems:t}}},f=function(e){var t=e.recentItemsLoadingState;return{type:c.ActionTypes.SET_RECENT_ITEMS_LOADING_STATE,payload:{recentItemsLoadingState:t}}};t.fetchQuerySuggestions=function(e){var t=this,o=e.user,c=e.query,l=e.maxResults;return function(e,u){return r.__awaiter(t,void 0,void 0,function(){var t,_,E,S,m,f,C,R,I,T;return r.__generator(this,function(r){switch(r.label){case 0:if(t=p.normalize(c),_=a.querySuggestionsCache(u())[t]){if(E=_.loadingState,E===d.QuerySuggestionsLoadingState.LOADING)return[2];if(_.lastFetched&&(S=Date.now()-_.lastFetched<n.TIME_TO_INVALIDATE_QUERY_SUGGESTIONS_CACHE)){if(E===d.QuerySuggestionsLoadingState.LOADED)return[2];if(E===d.QuerySuggestionsLoadingState.DISMISSED)return e(g({normalizedQuery:t,querySuggestionsData:{loadingState:d.QuerySuggestionsLoadingState.LOADED}})),[2]}}m=a.searchSessionId(u()),e(g({normalizedQuery:t,querySuggestionsData:{suggestions:[],loadingState:d.QuerySuggestionsLoadingState.LOADING}})),f=Date.now(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.getQuerySuggestions(o.id,t,l,m)];case 2:return C=r.sent().query_suggestions,R=C?C:[],e(g({normalizedQuery:t,querySuggestionsData:{suggestions:R.filter(function(e){return e.text!==t}),loadingState:d.QuerySuggestionsLoadingState.LOADED,lastFetched:Date.now()}})),s.logQuerySuggestionsFetched({searchSessionId:m,user:o,query:t,suggestions:R,latencyMs:Date.now()-f}),[3,4];case 3:return I=r.sent(),T=I.raw?I.raw.responseBody:"Received error response from get query suggestions API",h.reportException({err:new Error(T),tags:["search_bar","search_bar_query_suggestions"],severity:h.SEVERITY.NONCRITICAL}),e(g({normalizedQuery:t,querySuggestionsData:{loadingState:d.QuerySuggestionsLoadingState.FAILED,lastFetched:Date.now()}})),s.logQuerySuggestionsFailed({searchSessionId:m,user:o,query:t}),[3,4];case 4:return[2]}})})}},t.dismissQuerySuggestions=function(e){var t=e.user,r=e.query;return function(e,n){var o=p.normalize(r),i=a.querySuggestionsCache(n())[o];i&&i.loadingState===d.QuerySuggestionsLoadingState.LOADED&&(e(g({normalizedQuery:o,querySuggestionsData:{loadingState:d.QuerySuggestionsLoadingState.DISMISSED}})),s.logQuerySuggestionsDismissed({searchSessionId:a.searchSessionId(n()),user:t,query:r}))}};var g=function(e){var t=e.normalizedQuery,r=e.querySuggestionsData;return{type:c.ActionTypes.UPDATE_QUERY_SUGGESTIONS_CACHE,payload:{normalizedQuery:t,querySuggestionsData:r}}}}),define("modules/clean/search/search_bar/data/reducer",["require","exports","tslib","modules/clean/react/browse/data/types","modules/clean/search/constants","modules/clean/search/search_bar/chips","modules/clean/search/search_bar/data/types","modules/clean/search/search_bar/experiments","modules/clean/search/search_helpers","modules/clean/search/store_helpers","modules/clean/search/types"],function(e,t,r,n,s,o,i,a,c,l,u){"use strict";function _(e,r){switch(void 0===e&&(e=t.defaultSearchBarState),r.type){case i.ActionTypes.FOCUS:return p(e);case i.ActionTypes.BLUR:return d(e);case i.ActionTypes.UPDATE_HISTORY:return h(e,r.payload);case i.ActionTypes.SET_QUERY:return E(e,r.payload);case i.ActionTypes.SET_SEARCH_RESULTS:return S(e,r.payload);case i.ActionTypes.SET_SLIM_SEARCH_RESULTS:return m(e,r.payload);case i.ActionTypes.SET_HIGHLIGHTED_ROW:return f(e,r.payload);case i.ActionTypes.HIGHLIGHT_PREVIOUS_ROW:return C(e);case i.ActionTypes.HIGHLIGHT_NEXT_ROW:return g(e);case i.ActionTypes.SET_BROWSE_SCOPE:return R(e,r.payload);case i.ActionTypes.SET_SCOPE_CHIP:return I(e,r.payload);case i.ActionTypes.SET_DELETED_CHIP:return T(e,r.payload);case i.ActionTypes.SET_DELETED_CHIP_ENABLED:return A(e,r.payload);case i.ActionTypes.CLEAR:return y(e);case i.ActionTypes.SET_EXPERIMENTS:return O(e,r.payload);case i.ActionTypes.SET_FILE_CATEGORIES:return D(e,r.payload);case i.ActionTypes.INVALIDATE_RESULTS:return v(e);case i.ActionTypes.SET_RECENT_ITEMS:return L(e,r.payload);case i.ActionTypes.SET_RECENT_ITEMS_LOADING_STATE:
return N(e,r.payload);case i.ActionTypes.UPDATE_QUERY_SUGGESTIONS_CACHE:return w(e,r.payload);case n.ActionTypes.SET_PATH:return B(e,r.payload);case n.ActionTypes.SET_IS_SEARCH_MODE:return P(e,r.payload);default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),c=r.__importStar(c),l=r.__importStar(l),t.defaultSearchBarState={isSearchBarFocused:!1,searchHistory:[],query:"",searchSessionId:l.generateRandomId(),searchPath:"",isSearchBarLoading:!1,searchResults:[],hasMoreResults:!1,slimSearchResults:[],highlightedSearchRow:0,browseScope:"/",canScope:!1,scopeChip:"/",deletedChip:!1,deletedChipEnabled:!1,experiments:{},fileCategories:r.__assign({},s.FILE_CATEGORIES_UNCHECKED),resultsInvalid:!0,recentItems:new Map,recentItemsLoadingState:u.RecentItemsLoadingState.NOT_LOADED,querySuggestionsCache:{}};var p=function(e){return r.__assign({},e,{highlightedSearchRow:0,isSearchBarFocused:!0})},d=function(e){return r.__assign({},e,{highlightedSearchRow:0,isSearchBarFocused:!1,fileCategories:r.__assign({},s.FILE_CATEGORIES_UNCHECKED)})},h=function(e,t){var n=t.searchHistory;return r.__assign({},e,{searchHistory:n})},E=function(e,t){var n=t.query,s=t.searchPath,o=t.searchSessionId,i=t.keepHighlightedRow,a=e.searchSessionId;o?a=o:l.shouldStartNewSearchSession(e.query,n)&&(a=l.generateRandomId());var c=i?e.highlightedSearchRow:0;return r.__assign({},e,{query:n,searchPath:s,searchSessionId:a,searchResults:[],hasMoreResults:!1,isSearchBarLoading:!l.isBlank(n),slimSearchResults:[],highlightedSearchRow:c})},S=function(e,t){var n=t.searchResults;return r.__assign({},e,{searchResults:n.results,hasMoreResults:n.hasMore,isSearchBarLoading:!1,resultsInvalid:!1})},m=function(e,t){var n=t.slimSearchResults;return r.__assign({},e,{slimSearchResults:n.results,hasMoreResults:n.hasMore,isSearchBarLoading:!1,resultsInvalid:!1})},f=function(e,t){var n=t.highlightedSearchRow;return r.__assign({},e,{highlightedSearchRow:n})},g=function(e){var t=!l.isBlank(e.query),n=l.normalize(e.query),o=e.querySuggestionsCache[n],i=o?o.suggestions:void 0,a=o?o.loadingState:void 0;if(t&&c.areQuerySuggestionsLoaded(e.experiments,i,a)&&i){var u=Math.min(i.length,e.highlightedSearchRow+1);return r.__assign({},e,{highlightedSearchRow:u})}var _=Math.min(s.MaxResults.MAX_SEARCH_SUGGESTIONS,e.slimSearchResults.length||e.searchResults.length),p=_||!t&&e.searchHistory.length||0,d=0;d+=t?1:0,d+=e.canScope?1:0;var h=Math.min(p+d-1,e.highlightedSearchRow+1);return r.__assign({},e,{highlightedSearchRow:h})},C=function(e){var t=Math.max(0,e.highlightedSearchRow-1);return r.__assign({},e,{highlightedSearchRow:t})},R=function(e,t){var n=t.browseScope,s=e.scopeChip,i=o.isValidPathForChip(n);return r.__assign({},e,{browseScope:n,canScope:i,scopeChip:i?s:"/"})},I=function(e,t){var n=t.scopeChip;return r.__assign({},e,{scopeChip:n||"/"})},T=function(e,t){var n=t.deletedChip;return r.__assign({},e,{deletedChip:n,searchSuggestions:[]})},A=function(e,t){var n=t.enabled;return r.__assign({},e,{deletedChipEnabled:n,searchSuggestions:[]})},y=function(e){var n=e.scopeChip,s=e.searchHistory,o=e.browseScope,i=e.experiments,c=e.isSearchBarFocused,l=e.fileCategories,u=e.recentItems,_=e.recentItemsLoadingState,p=e.querySuggestionsCache;return a.isInSinglePageSearchExperiment(e.experiments)?r.__assign({},t.defaultSearchBarState,{scopeChip:n,searchHistory:s,browseScope:o,experiments:i,isSearchBarFocused:c,fileCategories:l,recentItems:u,recentItemsLoadingState:_,querySuggestionsCache:p}):r.__assign({},t.defaultSearchBarState,{scopeChip:n,searchHistory:s,browseScope:o,experiments:i})},O=function(e,t){var n=t.experiments;return r.__assign({},e,{experiments:n})},D=function(e,t){var n=t.fileCategories;return r.__assign({},e,{fileCategories:n})},v=function(e){return r.__assign({},e,{resultsInvalid:!0})},L=function(e,t){var n=t.recentItems;return r.__assign({},e,{recentItems:n})},N=function(e,t){var n=t.recentItemsLoadingState;return r.__assign({},e,{recentItemsLoadingState:n})},w=function(e,t){var n,s=t.normalizedQuery,o=t.querySuggestionsData;return r.__assign({},e,{querySuggestionsCache:r.__assign({},e.querySuggestionsCache,(n={},n[s]=r.__assign({},e.querySuggestionsCache[s],o),n))})},B=function(e,t){return R(y(e),{browseScope:t.path})},P=function(e,t){return t.isSearchMode?e:y(e)};t.searchBarReducer=_}),define("modules/clean/search/search_bar/data/selectors",["require","exports","tslib","external/reselect","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/redux/namespaces","modules/clean/search/search_bar/experiments","modules/clean/search/store_helpers","modules/clean/search/types","modules/clean/redux/selectors"],function(e,t,r,n,s,o,i,a,c,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s),c=r.__importStar(c);var _=function(e){return u.getStateAtNamespace(e,i.SEARCH_BAR_NAMESPACE_KEY)};t.isSearchBarFocused=function(e){return _(e).isSearchBarFocused},t.searchHistory=function(e){return _(e).searchHistory},t.rawQuery=function(e){return _(e).query},t.normalizedQuery=function(e){return c.normalize(t.rawQuery(e))},t.searchSessionId=function(e){return _(e).searchSessionId},t.isSearchBarActive=function(e){return!!t.rawQuery(e)},t.searchPath=function(e){return _(e).searchPath},t.isSearchBarLoading=function(e){return _(e).isSearchBarLoading},t.searchResults=function(e){return _(e).searchResults},t.hasMoreResults=function(e){return _(e).hasMoreResults},t.slimSearchResults=function(e){return _(e).slimSearchResults},t.highlightedSearchRow=function(e){return _(e).highlightedSearchRow},t.searchResultForPath=function(e,r){return t.searchResults(e).find(function(e){return e instanceof o.File&&s.paths_are_equal(e.fq_path,r)})},t.browseScope=function(e){return _(e).browseScope},t.scopeChip=function(e){return _(e).scopeChip},t.canScope=function(e){return _(e).canScope},t.deletedChip=function(e){return _(e).deletedChip},t.deletedChipEnabled=function(e){return _(e).deletedChipEnabled},t.experiments=function(e){return _(e).experiments},t.fileCategories=function(e){return _(e).fileCategories},t.resultsInvalid=function(e){return _(e).resultsInvalid},t.recentItems=function(e){return _(e).recentItems},t.recentItemsLoadingState=function(e){return _(e).recentItemsLoadingState},t.querySuggestionsCache=function(e){return _(e).querySuggestionsCache},t.querySuggestions=n.createSelector(t.normalizedQuery,t.querySuggestionsCache,function(e,t){var r=t[e];return r?r.suggestions:void 0}),t.querySuggestionsLoadingState=n.createSelector(t.normalizedQuery,t.querySuggestionsCache,function(e,t){var r=t[e];return r?r.loadingState:void 0}),t.headerItems=n.createSelector(t.normalizedQuery,t.canScope,t.deletedChipEnabled,t.experiments,function(e,t,r,n){var s=""!==e,o=[];return a.isInSinglePageSearchExperiment(n)?[]:(s&&o.push(l.SearchBarDropdownHeaderItemType.SEARCH_ALL),r&&a.isInDeletedFilterRightRailExperiment(n)?o.push(l.SearchBarDropdownHeaderItemType.DELETED_FILES):t&&o.push(l.SearchBarDropdownHeaderItemType.SCOPE_CHIPS),o)})}),define("modules/clean/search/search_bar/data/store",["require","exports","modules/clean/redux/store","modules/clean/redux/namespaces","modules/clean/search/search_bar/data/reducer"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o;t.getStoreForSearchBar=function(){var e;return o||(o=r.getStoreAndRegisterReducers((e={},e[n.SEARCH_BAR_NAMESPACE_KEY]=s.searchBarReducer,e))),o}}),define("modules/clean/search/search_bar/data/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.FOCUS="SEARCH_BAR/FOCUS",e.BLUR="SEARCH_BAR/BLUR",e.CLEAR="SEARCH_BAR/CLEAR",e.UPDATE_HISTORY="SEARCH_BAR/UPDATE_HISTORY",e.SET_QUERY="SEARCH_BAR/SET_QUERY",e.SET_SEARCH_RESULTS="SEARCH_BAR/SET_SEARCH_RESULTS",e.SET_SLIM_SEARCH_RESULTS="SEARCH_BAR/SET_SLIM_SEARCH_RESULTS",e.SET_HIGHLIGHTED_ROW="SEARCH_BAR/SET_HIGHLIGHTED_ROW",e.HIGHLIGHT_PREVIOUS_ROW="SEARCH_BAR/HIGHLIGHT_PREVIOUS_ROW",e.HIGHLIGHT_NEXT_ROW="SEARCH_BAR/HIGHLIGHT_NEXT_ROW",e.SET_BROWSE_SCOPE="SEARCH_BAR/SET_BROWSE_SCOPE",e.SET_SCOPE_CHIP="SEARCH_BAR/SET_SCOPE_CHIP",e.SET_DELETED_CHIP="SEARCH_BAR/SET_DELETED_CHIP",e.SET_DELETED_CHIP_ENABLED="SEARCH_BAR/SET_DELETED_CHIP_ENABLED",e.SET_EXPERIMENTS="SEARCH_BAR/SET_EXPERIMENTS",e.SET_FILE_CATEGORIES="SEARCH_BAR/SET_FILE_CATEGORIES",e.INVALIDATE_RESULTS="SEARCH_BAR/INVALIDATE_RESULTS",e.SET_RECENT_ITEMS="SEARCH_BAR/SET_RECENT_ITEMS",e.SET_RECENT_ITEMS_LOADING_STATE="SEARCH_BAR/SET_RECENT_ITEMS_LOADING_STATE",e.UPDATE_QUERY_SUGGESTIONS_CACHE="SEARCH_BAR/UPDATE_QUERY_SUGGESTIONS_CACHE"})(t.ActionTypes||(t.ActionTypes={}))}),define("modules/clean/search/search_bar/experiments",["require","exports","modules/clean/search/types"],function(e,t,r){"use strict";function n(e){return!!e&&e.expSinglePageSearch===r.SinglePageSearchVariants.ON}function s(e){return!!e&&e.expDeletedFilterRightRail===r.DeletedFilterRightRailVariants.ON}Object.defineProperty(t,"__esModule",{value:!0}),t.isInSinglePageSearchExperiment=n,t.isInDeletedFilterRightRailExperiment=s,t.isInShowHelpLinkHelpCenterLinkExperiment=function(e){return!!e&&(e.expShowHelpLink===r.ShowHelpLinkVariants.ON||e.expShowHelpLink===r.ShowHelpLinkVariants.HELP_CENTER_LINK)},t.isInShowHelpLinkPlaceholderTextExperiment=function(e){return!!e&&(e.expShowHelpLink===r.ShowHelpLinkVariants.ON||e.expShowHelpLink===r.ShowHelpLinkVariants.PLACEHOLDER_TEXT)},t.isInRecentFilesExperiment=function(e){return!!e&&(e.expRecentFiles===r.RecentFilesVariants.ON_VIEWED_DATE||e.expRecentFiles===r.RecentFilesVariants.ON_MODIFIED_DATE)};var o=[r.QuerySuggestionsVariants.POSTERIOR_ONLY_WITH_3_SUGGESTIONS,r.QuerySuggestionsVariants.POSTERIOR_ONLY_WITH_5_SUGGESTIONS];t.isInPosteriorQuerySuggestionsExperiment=function(e){return!(!e||!e.expQuerySuggestions)&&o.includes(e.expQuerySuggestions)};var i=[r.QuerySuggestionsVariants.PRIOR_ONLY_WITH_3_SUGGESTIONS,r.QuerySuggestionsVariants.PRIOR_ONLY_WITH_5_SUGGESTIONS,r.QuerySuggestionsVariants.PRIOR_ONLY_WITH_10_SUGGESTIONS];t.isInPriorQuerySuggestionsExperiment=function(e){return!(!e||!e.expQuerySuggestions)&&i.includes(e.expQuerySuggestions)};var a=[r.QuerySuggestionsVariants.FETCH_ONLY_WITH_3_SUGGESTIONS,r.QuerySuggestionsVariants.FETCH_ONLY_WITH_5_SUGGESTIONS];t.isInFetchQuerySuggestionsExperiment=function(e){return!(!e||!e.expQuerySuggestions)&&a.includes(e.expQuerySuggestions)},t.getNumOfQuerySuggestionsToFetch=function(e){switch(e){case r.QuerySuggestionsVariants.POSTERIOR_ONLY_WITH_3_SUGGESTIONS:case r.QuerySuggestionsVariants.PRIOR_ONLY_WITH_3_SUGGESTIONS:case r.QuerySuggestionsVariants.FETCH_ONLY_WITH_3_SUGGESTIONS:return 3;case r.QuerySuggestionsVariants.POSTERIOR_ONLY_WITH_5_SUGGESTIONS:case r.QuerySuggestionsVariants.PRIOR_ONLY_WITH_5_SUGGESTIONS:case r.QuerySuggestionsVariants.FETCH_ONLY_WITH_5_SUGGESTIONS:return 5;case r.QuerySuggestionsVariants.PRIOR_ONLY_WITH_10_SUGGESTIONS:return 10;default:return 0}}}),define("modules/clean/search/search_bar/history",["require","exports","tslib","external/lodash","modules/clean/search/constants","modules/clean/storage","modules/clean/search/logger"],function(e,t,r,n,s,o,i){"use strict";function a(e){return o.UserLocalStorage.get(e.id,s.SEARCH_RECENT_HISTORY_STORAGE_KEY)||[]}function c(e,t,r,n,c){void 0===r&&(r=""),void 0===n&&(n=""),void 0===c&&(c=!1);var l=a(e);if(!t.normalizedQuery.length)return l;if(!c){var _=u(l,t);i.logRecentQueryStored({searchSessionId:r,requestId:n,query:t,user:e,previousPosition:_})}return l=l.filter(function(e){return!d(e,t)}),l=[t].concat(l).slice(0,s.SEARCH_RECENT_HISTORY_CAPACITY),o.UserLocalStorage.set(e.id,s.SEARCH_RECENT_HISTORY_STORAGE_KEY,l),l}function l(e,t,r){void 0===t&&(t=""),void 0===r&&(r=!1),r||i.logRecentHistoryCleared({searchSessionId:t,user:e});var n=[];return o.UserLocalStorage.set(e.id,s.SEARCH_RECENT_HISTORY_STORAGE_KEY,n),n}function u(e,t){return n.findIndex(e,function(e){return d(e,t)})}function _(){o.UserLocalStorage.clearOtherUsers([])}function p(){o.UserLocalStorage.clearOtherUsers([])}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),i=r.__importStar(i),t.getHistory=a;var d=function(e,t){return e.normalizedQuery===t.normalizedQuery};t.addQuery=c,t.clearAll=l,t.getPreviousPosition=u,t.testMockSetup=_,t.testMockTeardown=p}),define("modules/clean/search/search_bar/log_helper",["require","exports","tslib","modules/clean/search/logger","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/data/selectors"],function(e,t,r,n,s,o){"use strict";function i(e){var t=e.result,r=e.user,i=e.action_type,a=e.viewport,c=e.view_type,l=e.searchSessionId;n.logSearchAction({searchSessionId:l||o.searchSessionId(s.getStoreForSearchBar().getState()),result:t,user:r,action_type:i,search_type:"dropdown",viewport:a,view_type:c})}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),o=r.__importStar(o),t.logDropdownSearchAction=i}),define("modules/clean/search/search_bar/view",["require","exports","tslib","external/classnames","react","spectrum/icon_action","spectrum/icon_content","spectrum/icon_global","modules/clean/em_string","modules/clean/filepath","modules/clean/keycode","modules/clean/react/title_bubble","modules/clean/search/search_bar/chips","modules/clean/search/search_bar/experiments","modules/clean/search/search_helpers","modules/clean/search/types","modules/clean/web_timing_logger","modules/core/i18n"],function(e,t,r,n,s,o,i,a,c,l,u,_,p,d,h,E,S,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importDefault(s),l=r.__importStar(l),p=r.__importStar(p),h=r.__importStar(h),S=r.__importStar(S);var f=(function(t){function o(){var e=null!==t&&t.apply(this,arguments)||this;return e._renderDropdown=function(){},e._handleNavigation=function(){e._searchBarInput.blurSearchBarTextInput()},e._onHistoryItemClick=function(t,r){e.props.onHistoryItemClick&&e.props.onHistoryItemClick(t,r)},e._onSearchResultOpen=function(t){e.props.onSearchResultOpen(t),e._handleNavigation()},e._onResultObjectPathClick=function(t){e.props.onResultObjectPathClick(t),e._handleNavigation()},e._onSearch=function(t){var r=e.props.onSearch;r&&r(t),e._handleNavigation()},e._setSearchBarInputRef=function(t){return e._searchBarInput=t},e._setSearchBarDropdownRef=function(t){e._searchBarDropdown=t},e}return r.__extends(o,t),o.prototype.getSearchBarInput=function(){return this._searchBarInput},o.prototype.getSearchBarDropdown=function(){return this._searchBarDropdown},o.prototype._shouldRenderDropdown=function(){var e=this.props,t=e.searchHistory,r=e.normalizedQuery,n=e.dropdownHeaderItems;return!!(t&&t.length||n&&(n.indexOf(E.SearchBarDropdownHeaderItemType.SCOPE_CHIPS)!==-1||n.indexOf(E.SearchBarDropdownHeaderItemType.DELETED_FILES)!==-1)||r&&r.length)},o.prototype.componentDidMount=function(){var t=this;S.waitForTTI().then(function(){Promise.all([new Promise(function(t,r){e(["modules/clean/search/search_bar/dropdown"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/react/starred/browse_exports"],t,r)}).then(r.__importStar)]).then(function(e){var r=e[0].SearchBarDropdown,n=e[1];n.Star,n.HOME_RESOURCE_ID_TYPE,n.StarredSource,n.checkForMissingStarredData;t._renderDropdown=function(){var e=t.props,n=e.browseScope,o=e.children,i=e.dropdownHeaderItems,a=e.highlightedRow,c=e.isFocused,l=e.normalizedQuery,u=e.onContextMenuCapture,_=e.onDropdownTTI,p=e.onHighlightDropdownItem,d=e.onHistoryClearAllClick,h=e.onRecentSearchContextMenuCapture,E=e.onSearchChipInteraction,S=e.scopeChip,m=e.onDeletedChipInteraction,f=e.deletedChip,g=e.enableDeletedChip,C=e.searchBarExperiments,R=e.searchBarLoading,I=e.searchHistory,T=e.searchPath,A=e.searchSessionId,y=e.showLinkToResultsPage,O=e.searchResults,D=e.user;return s.default.createElement(r,{browseScope:n,children:o,dropdownHeaderItems:i||[],highlightedRow:a,isOpen:c,normalizedQuery:l,onContextMenuCapture:u,onDropdownTTI:_,onHighlightDropdownItem:p,onHistoryClearAllClick:d,onHistoryItemClick:t._onHistoryItemClick,onRecentSearchContextMenuCapture:h,onResultObjectPathClick:t._onResultObjectPathClick,onSearch:t._onSearch,onSearchChipInteraction:E,onDeletedChipInteraction:m,onSearchResultOpen:t._onSearchResultOpen,ref:t._setSearchBarDropdownRef,scopeChip:S,deletedChip:f,enableDeletedChip:g,searchBarExperiments:C,searchBarLoading:R,searchHistory:I||[],searchPath:T,searchSessionId:A,showLinkToResultsPage:y,searchResults:O,user:D})},t._shouldRenderDropdown()&&t.forceUpdate()})})},o.prototype.render=function(){var e=this.props,t=e.isActive,o=e.isExpanded,i=e.isFocused,a=e.searchBarExperiments,c={"search-bar--container":!0,"u-l-fr":!0,"sps--search-bar--container":d.isInSinglePageSearchExperiment(a),"is-expanded":o,"is-focused":i},l={"is-active":t,"is-collapsed":!(o||i),"is-expanded":o,"is-focused":i,"search-bar":!0},u=this._shouldRenderDropdown();return s.default.createElement("div",{className:n.default(c)},s.default.createElement("div",{className:n.default(l)},s.default.createElement(g,r.__assign({},this.props,{shouldRenderDropdown:u,ref:this._setSearchBarInputRef})),u&&this._renderDropdown()))},o.defaultProps={inputTextValue:"",normalizedQuery:"",showLinkToResultsPage:!0},o})(s.default.Component);t.SearchBarView=f;var g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.focusSearchBarTextInput=function(){t.props.isFocused||t._searchBarTextInput.focus()},t._onKeyDown=function(e){var r=t.props,n=r.normalizedQuery,s=r.areQuerySuggestionsLoaded,o=n&&s;e.keyCode!==u.KeyCode.ESC||o||t.blurSearchBarTextInput(),t.props.onInputKeydown(e,t._getCursorPosition())},t._onSubmit=function(e){var r=t.props.highlightedRow,n=t.props.searchHistory||[],s=t.props,o=s.searchBarExperiments,i=s.recentItemsLoadingState,a=s.recentItems,c=!t.props.normalizedQuery&&n.length>0&&!h.areRecentItemsLoading(o,i)&&!h.areRecentItemsLoaded(o,i,a),l=t.props.dropdownHeaderItems||[],u=r-l.length;if(c&&u>=0){e.preventDefault();var _=n[u];return void(t.props.onHistoryItemClick&&t.props.onHistoryItemClick(_,u))}var p=t.props,d=p.normalizedQuery,S=p.areQuerySuggestionsLoaded,m=p.querySuggestions,f=p.onQuerySuggestionsClick,g=p.onQuerySuggestionsDismiss,C=d&&S,R=r-1;if(!(C&&m&&f&&g)){return r<l.length&&l[r]===E.SearchBarDropdownHeaderItemType.SCOPE_CHIPS||t.blurSearchBarTextInput(),t.props.onInputSubmit(e,r)}if(e.preventDefault(),R>=0){f(m[R],R)}else{var _=d||"";g(_)}},t._handleButtonMouseDown=function(e){t.props.inputTextValue&&t.props.inputTextValue.length&&(t._onSubmit(e),e.preventDefault())},t._handleInputChange=function(e){t.props.onInputChange(e.currentTarget.value)},t._setSearchBarTextInputRef=function(e){return t._searchBarTextInput=e},t}return r.__extends(t,e),t.prototype._getCursorPosition=function(){return this._searchBarTextInput.selectionEnd},t.prototype.getSearchBarTextInput=function(){return this._searchBarTextInput},t.prototype.blurSearchBarTextInput=function(){this._searchBarTextInput.blur(),this.props.onSearchBarBlur()},t.prototype.render=function(){var e=this.props,t=e.onSearchBarFocus,n=e.onSearchBarBlur,o=e.isFocused,i=e.highlightedRow,c=e.inputTextValue,l=e.shouldRenderDropdown,u=e.searchBarExperiments,_=l?{"aria-expanded":o,"aria-activedescendant":"search-dropdown-item"+i,"aria-autocomplete":"list","aria-owns":"search-bar__dropdown-items",role:"combobox"}:void 0,p=d.isInShowHelpLinkPlaceholderTextExperiment(u)?m._("Search your content"):m._("Search");return s.default.createElement("form",{className:"search-bar__input",onSubmit:this._onSubmit},s.default.createElement("button",{"aria-label":m._("Search"),className:"search-bar__button",type:"submit",onMouseDown:this._handleButtonMouseDown},s.default.createElement(a.IconGlobal,{name:"search-small"})),s.default.createElement(C,r.__assign({},this.props,{focusSearchInput:this.focusSearchBarTextInput})),s.default.createElement("input",r.__assign({"aria-label":m._("Search")},_,{className:"search-bar__text-input",maxLength:1e3,onChange:this._handleInputChange,onFocus:t,onBlur:n,onKeyDown:this._onKeyDown,placeholder:p,ref:this._setSearchBarTextInputRef,value:c})))},t})(s.default.Component);t.SearchBarInput=g;var C=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onScopeChipClosed=function(){t.props.onSearchChipInteraction&&t.props.onSearchChipInteraction(!1)},t._onDeletedChipClosed=function(){t.props.onDeletedChipInteraction&&t.props.onDeletedChipInteraction(!1)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.scopeChip,r=e.user,n=e.isFocused,a=e.isExpanded;if(this.props.deletedChip&&d.isInDeletedFilterRightRailExperiment(this.props.searchBarExperiments))return s.default.createElement(R,{key:"deleted",isFocused:n,isExpanded:a,icon:s.default.createElement(o.IconAction,{name:"delete",className:"search-bar__chip-icon--dark"}),text:m._("Deleted files"),onClose:this._onDeletedChipClosed,onClick:this.props.focusSearchInput});if(t&&p.isValidPathForChip(t)){var c=r.cdm_tmf_path&&t&&l.paths_are_equal(r.cdm_tmf_path,t),u=c?"folder_team_member_child-small":"folder-small",_=l.child_dir(t);return s.default.createElement(R,{key:"scope",isFocused:n,isExpanded:a,icon:s.default.createElement(i.IconContent,{name:u,height:"18px",width:"18px"}),text:_,onClose:this._onScopeChipClosed,onClick:this.props.focusSearchInput})}return null},t})(s.default.Component),R=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onMouseDownOnChipItem=function(e){e.stopPropagation(),e.preventDefault()},t._onMouseDownClose=function(e){e.stopPropagation(),e.preventDefault(),t.props.onClose()},t._onMouseDownOnChipButton=function(e){e.stopPropagation(),e.preventDefault(),t.props.onClick()},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.isFocused,r=e.isExpanded,n=e.text,o=e.icon;if(!n)return null;var i=c.Emstring.em_snippet(n,8,.6),a=s.default.createElement("span",{className:"search_bar__chip_text",key:"text"},i),l=i!==n;return r||t?s.default.createElement("span",{className:"search_bar__chip"},s.default.createElement("span",{className:"search_bar__chip_item",tabIndex:0,onMouseDown:this._onMouseDownOnChipItem,"data-chip":n},o,l?s.default.createElement(_.TitleBubble,{content:n,position:_.TitleBubble.POSITIONS.BOTTOM,key:"text"},a):a),s.default.createElement("button",{type:"button","aria-label":m._("Remove filter"),className:"search_bar__chip_close_button",key:"close",onMouseDown:this._onMouseDownClose})):s.default.createElement("span",{className:"search_bar__chip"},s.default.createElement("button",{type:"button","aria-label":m._("Search"),className:"search_bar__chip_button",onMouseDown:this._onMouseDownOnChipButton},o))},t})(s.default.PureComponent)}),define("modules/clean/search/search_helpers",["require","exports","tslib","external/sjcl","modules/clean/react/browse/constants","modules/clean/search/types","modules/clean/react/files_view/types","modules/clean/search/constants","modules/clean/search/models","modules/clean/search/search_bar/experiments","modules/core/uri","modules/clean/browse_uri_interface","modules/core/cookies"],function(e,t,r,n,s,o,i,a,c,l,u,_,p){"use strict";function d(e){var t=e.user,n=e.searchPath,s=e.normalizedQuery,o=e.searchSessionId,i=e.searchToken,a=e.qargs,c=r.__assign({path:n,search_session_id:o,search_token:i,query:s},a);return new u.URI({path:"/search/"+t.role,query:c})}function h(e,t){return e instanceof c.SlimFileSearchResult?_.browse_uri_for_fq_path(t,e.fq_path).toString():e.url}function E(e){return 0===e.button&&!e.altKey&&!e.ctrlKey&&!e.metaKey}function S(){var e=n.codec.utf8String.toBits(p.Cookies.read("__Host-js_csrf")),t=n.codec.utf8String.toBits("search"),r=new n.misc.hmac(e);return n.codec.base64.fromBits(r.encrypt(t))}function m(e){return e.expFileTypeFilter===o.FileTypeFilterVariants.ON}function f(e){var t=[];return Object.keys(e).forEach(function(r){"checked"===e[r]&&t.push(r)}),t.join(",")}function g(e){var t=r.__assign({},a.FILE_CATEGORIES_UNCHECKED);return e&&e.split(",").forEach(function(e){e in t&&(t[e]="checked")}),t}function C(e){if(!e)return JSON.stringify(["all_unchecked"]);var t=e.split(","),r=t;return 10===t.length?JSON.stringify(["all_checked"]):JSON.stringify(r)}function R(e,t){void 0===t&&(t=!0);var n;return t||(e=r.__assign({},e,(n={},n[o.FileCategory.PAPER]="checked",n))),Object.keys(e).every(function(t){return"checked"===e[t]})}function I(e,t){void 0===t&&(t=!0);var n;return t||(e=r.__assign({},e,(n={},n[o.FileCategory.PAPER]="unchecked",n))),Object.keys(e).every(function(t){return"unchecked"===e[t]})}function T(e,t,r){return void 0===r&&(r=!0),!(!m(t)||!e)&&!I(e,r)}function A(e){switch(e){case i.SortField.MODIFIED:return s.SEARCH_ORDER_BY_TYPE.LAST_MODIFIED_TIME;case i.SortField.RELEVANCE:default:return s.SEARCH_ORDER_BY_TYPE.RELEVANCE}}function y(e){switch(e){case s.SEARCH_ORDER_BY_TYPE.LAST_MODIFIED_TIME:return i.SortField.MODIFIED;case s.SEARCH_ORDER_BY_TYPE.RELEVANCE:default:return i.SortField.RELEVANCE}}function O(e){switch(e){case i.SortDirection.ASCENDING:return s.SEARCH_REVERSE_ORDER_TYPE.TRUE;case i.SortDirection.DESCENDING:default:return s.SEARCH_REVERSE_ORDER_TYPE.FALSE}}function D(e){switch(e){case s.SEARCH_REVERSE_ORDER_TYPE.TRUE:return i.SortDirection.ASCENDING;case s.SEARCH_REVERSE_ORDER_TYPE.FALSE:default:return i.SortDirection.DESCENDING}}function v(e,t){return!e&&!t||!(!e||!t)&&(e.sortField===t.sortField&&e.sortDirection===t.sortDirection)}function L(e){if("sfj_entity"===e.entity[".tag"])return c.RecentFile.fromServerObject(e);if("paper_entity"===e.entity[".tag"]){return e.entity.is_dir?c.RecentPaperFolder.fromServerObject(e):c.RecentPaper.fromServerObject(e)}return null}function N(e){var t=new Map;return e.forEach(function(e){if(e instanceof c.RecentFile){var r="id:"+e.file_id;t.set(r,e)}else e instanceof c.RecentPaper?t.set(e.pad_id,e):e instanceof c.RecentPaperFolder&&t.set(e.folder_id,e)}),t}function w(e){return e instanceof c.RecentPaperFolder?a.PAPER_FOLDER_BASE_URL+e.folder_id:a.PAPER_DOC_BASE_URL+e.pad_id}function B(e,t,r){return l.isInSinglePageSearchExperiment(e)&&l.isInRecentFilesExperiment(e)&&t===o.RecentItemsLoadingState.LOADED&&r&&r.size>0}function P(e,t){return l.isInSinglePageSearchExperiment(e)&&l.isInRecentFilesExperiment(e)&&t===o.RecentItemsLoadingState.LOADING}function F(e,t,r){return l.isInSinglePageSearchExperiment(e)&&l.isInPosteriorQuerySuggestionsExperiment(e)&&r===o.QuerySuggestionsLoadingState.LOADED&&!!t&&t.length>0}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),t.buildSearchURL=d,t.resultObjectToUrl=h,t.shouldHandleClick=E,t.getSearchCsrfToken=S,t.isInFileTypeFilterExperiment=m,t.fileCategoriesToString=f,t.fileCategoriesFromString=g,t.fileCategoryStringToLogValue=C,t.allCategoriesChecked=R,t.allCategoriesUnchecked=I,t.fileCategoriesSet=T,t.sortFieldToOrderBy=A,t.orderByToSortField=y,t.sortDirectionToReverseOrder=O,t.reverseOrderToSortDirection=D,t.areSortOrdersEqual=v,t.recentItemFromServerObject=L,t.createRecentItemsMap=N,t.buildPaperUrl=w,t.areRecentItemsLoaded=B,t.areRecentItemsLoading=P,t.areQuerySuggestionsLoaded=F}),define("modules/clean/search/single_page",["require","exports","tslib","external/classnames","external/lodash","react","spectrum/button","modules/clean/react/no-jquery","modules/clean/search/search_bar/view","modules/clean/search/store_helpers","modules/clean/search/types","modules/clean/react/retrieval_success_banner/util","modules/clean/web_timing_logger","modules/core/browser"],function(e,t,r,n,s,o,i,a,c,l,u,_,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importStar(s),o=r.__importDefault(o),p=r.__importStar(p),d=r.__importStar(d);var h=function(e){var t=e.className;return o.default.createElement("svg",{className:t,width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1"},o.default.createElement("title",null,"Left Arrow"),o.default.createElement("g",{id:"arrow",transform:"translate(-32.000000, -32.000000)"},o.default.createElement("g",{id:"arrow-left",transform:"translate(32.000000, 32.000000)"},o.default.createElement("polygon",{id:"Combined-Shape",points:"12.9497475 7.05000305 8 11.9997505 12.9497475 16.949498 14.363961 15.5352844 10.8284271 11.9997505 14.363961 8.46421661"}))))},E=(function(t){function E(e){var r=t.call(this,e)||this;return r.renderDropdown=function(){return o.default.createElement("div",{className:"sps__dropdown-wrapper"})},r._handleDocumentClick=function(e){if(r.props.normalizedQuery&&r.props.areQuerySuggestionsLoaded&&r.props.onQuerySuggestionsDismiss){if(!e.srcElement)return;if(e.srcElement.classList.contains("search-bar__text-input")||e.srcElement.classList.contains("search-bar__button"))return;return void r.props.onQuerySuggestionsDismiss(r.props.normalizedQuery)}r.props.isFocused&&(r.props.inputTextValue||e.srcElement&&(e.srcElement.classList.contains("top-menu-container")||(a.closestElement(e.srcElement,".maestro-nav__container")||a.closestElement(e.srcElement,".pagelet-top-menu__container")||a.closestElement(e.srcElement,".sps__dropdown-wrapper")&&!a.closestElement(e.srcElement,".search-bar__dropdown")&&!a.closestElement(e.srcElement,".maestro-secondary-sidebar > div")||a.closestElement(e.srcElement,".maestro-header")&&!a.closestElement(e.srcElement,".search-bar--container"))&&r.onBackClick()))},r._setSearchBarInputRef=function(e){return r._searchBarInput=e},r.onBackClick=function(){if(r.props.searchBarExperiments.expSearchSuccessBanner&&!_.getClickedOnSearchResultsPageItem()&&(_.setSearchSuccessBannerVisible(),_.doSearchResultActionClickBroadcast(!1)),r.props.searchFrom)return void d.redirect(r.props.searchFrom);r.props.inputTextValue?r.props.onSearch("",r.state.originalPath):r.props.onSearchFiltersChanged({path:r.state.originalPath}),r.props.onSearchBarBlur()},r.handleSearchBarFocus=function(){var e=r.props.searchBarExperiments,t=e.expSearchSuccessBanner,n=e.expBrowseSuccessBanner;t&&(_.resetSearchSuccessBannerSettings(),_.resetSearchResultClickKey(),_.doSearchResultActionClickBroadcast(!1)),n===u.BrowseSuccessBannerVariants.V1||n===u.BrowseSuccessBannerVariants.V3?(_.clearBrowseSuccessBannerCounter(),_.clearBrowseSuccessBannerKey()):n===u.BrowseSuccessBannerVariants.V2&&_.clearBSBExtraData(),r.props.onSearchBarFocus(),r.props.inputTextValue||r.setState({originalPath:r.props.browseScope})},r.handleSearchBarBlur=function(){var e=r.props,t=e.normalizedQuery,n=e.areQuerySuggestionsLoaded,s=t&&n;r.props.inputTextValue&&!s&&r.props.onSearchBarBlur()},r.handleSearchChipInteraction=function(e){r.props.inputTextValue?r.props.onSearchFiltersChanged({path:e?r.props.browseScope:""}):r.props.onSearchChipInteraction&&r.props.onSearchChipInteraction(e)},r.handleInputChange=function(e){""===l.normalize(e)?r.props.onInputChange(""):r.props.onInputChange(e)},r.state={originalPath:"",shouldRenderDropdown:!1},r._debouncedShouldRenderDropdownChange=s.debounce(function(){var e=r.isBarActive&&(!r.props.normalizedQuery||!!r.props.areQuerySuggestionsLoaded);e!==r.state.shouldRenderDropdown&&r.setState({shouldRenderDropdown:e})},100),r}return r.__extends(E,t),E.prototype.componentWillUpdate=function(e){this._debouncedShouldRenderDropdownChange()},E.prototype.getSearchBarInput=function(){return this._searchBarInput},E.prototype.shouldRenderDropdown=function(){return this.state.shouldRenderDropdown},Object.defineProperty(E.prototype,"isBarActive",{get:function(){return this.props.isFocused||this.props.isActive||this.props.isExpanded},enumerable:!0,configurable:!0}),E.prototype.componentDidMount=function(){var t=this;document.addEventListener("click",this._handleDocumentClick,!1),p.waitForTTI().then(function(){Promise.all([new Promise(function(t,r){e(["modules/clean/search/search_bar/dropdown"],t,r)}).then(r.__importStar)]).then(function(e){var r=e[0].SearchBarDropdown;t.renderDropdown=function(){var e={maestro:!0,"sps__dropdown-wrapper":!t.props.normalizedQuery,
"sps__dropdown-query-suggestions-wrapper":t.props.normalizedQuery&&t.props.areQuerySuggestionsLoaded,"sps__dropdown-empty-wrapper":t.props.normalizedQuery&&!t.props.areQuerySuggestionsLoaded};return o.default.createElement("div",{className:n.default(e)},o.default.createElement("div",{className:"maestro-app"},o.default.createElement("div",{className:"maestro-app-content"},o.default.createElement(r,{isOpen:!0,onHistoryClearAllClick:t.props.onHistoryClearAllClick,onHistoryItemClick:t.props.onHistoryItemClick,onSearchChipInteraction:t.props.onSearchChipInteraction,onSearchResultOpen:t.props.onSearchResultOpen,onResultObjectPathClick:t.props.onResultObjectPathClick,onContextMenuCapture:t.props.onContextMenuCapture,onRecentSearchContextMenuCapture:t.props.onRecentSearchContextMenuCapture,onSearch:t.props.onSearch,onHighlightDropdownItem:t.props.onHighlightDropdownItem,searchPath:t.props.searchPath,normalizedQuery:t.props.normalizedQuery,searchResults:[],searchBarLoading:!1,showLinkToResultsPage:!1,highlightedRow:t.props.highlightedRow,user:t.props.user,searchSessionId:t.props.searchSessionId,searchHistory:t.props.searchHistory||[],onDeletedChipInteraction:t.props.onDeletedChipInteraction,deletedChip:!1,enableDeletedChip:!1,browseScope:t.props.browseScope,dropdownHeaderItems:t.props.dropdownHeaderItems||[],searchBarExperiments:t.props.searchBarExperiments,recentItems:t.props.recentItems,recentItemsLoadingState:t.props.recentItemsLoadingState,onRecentItemClick:t.props.onRecentItemClick,onRecentFileLocationClick:t.props.onRecentFileLocationClick,areQuerySuggestionsLoaded:t.props.areQuerySuggestionsLoaded,querySuggestions:t.props.querySuggestions,onQuerySuggestionsClick:t.props.onQuerySuggestionsClick})),o.default.createElement("div",{className:"maestro-secondary-sidebar__shadow"},o.default.createElement("div",{className:"maestro-secondary-sidebar"}))))},t.shouldRenderDropdown()&&t.forceUpdate()})})},E.prototype.componentWillUnmount=function(){document.removeEventListener("click",this._handleDocumentClick,!1)},E.prototype.render=function(){var e=this.props,t=e.isActive,s=e.isExpanded,a=e.isFocused,l={"search-bar--container":!0,"u-l-fr":!0,"sps--search-bar--container":!0,"is-expanded":s,"is-focused":a},u={"is-active":t,"is-collapsed":!(s||a),"is-expanded":s,"is-focused":a,"search-bar":!0};return o.default.createElement("div",{className:n.default(l)},o.default.createElement("div",{className:n.default(u)},this.isBarActive?o.default.createElement(i.Button,{variant:"styleless",className:"sps__back-button",onClick:this.onBackClick},o.default.createElement(h,{className:"sps__back-button-icon"})):null,o.default.createElement(c.SearchBarInput,r.__assign({},this.props,{onInputChange:this.handleInputChange,onSearchChipInteraction:this.handleSearchChipInteraction,onSearchBarBlur:this.handleSearchBarBlur,onSearchBarFocus:this.handleSearchBarFocus,shouldRenderDropdown:this.shouldRenderDropdown(),ref:this._setSearchBarInputRef})),this.shouldRenderDropdown()&&this.renderDropdown()))},E.defaultProps={inputTextValue:"",normalizedQuery:"",showLinkToResultsPage:!0},E})(o.default.Component);t.SinglePageSearchView=E}),define("modules/clean/search/single_page/constants",["require","exports","modules/clean/search/types","modules/core/i18n"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SEARCH_QUERY_DEBOUNCE=50,t.SEARCH_FIRST_PAGE_SIZE=10,t.SEARCH_ADDITIONAL_PAGE_SIZE=50,t.SEARCH_SECOND_PAGE_DEBOUNCE=200,t.SEARCH_URL_ROOT="/search",t.SEARCH_URL_REGEX=/^\/search\//,t.BROWSE_URL_REGEX=/^\/(home|personal|work)/,t.HOME_URL_REGEX=/^\/h([^\w]|$)/,t.SEARCH_HISTORY_DELAY=500,t.SEARCH_WEB_TIMER="single-page-search",t.SEARCH_TAB_HEIGHT=40,t.SEARCH_PAGE_HEADER_HEIGHT_DESKTOP=98,t.SEARCH_PAGE_HEADER_HEIGHT_TABLET=56,t.SEARCH_PAGE_HEADER_HEIGHT_MOBILE=80,t.FILE_CATEGORIES_PAPER=[{category:r.FileCategory.IMAGE,label:n._("Images"),tooltip:n._("JPG, PNG, GIF, and more",{comment:"Intended to represent 3 of the most common file formats for images."}),icon:"image-small"},{category:r.FileCategory.DOCUMENT,label:n._("Documents"),tooltip:n._("DOC, DOCX, TXT, and more",{comment:"Intended to represent 3 of the most common file formats for documents."}),icon:"txt-small"},{category:r.FileCategory.PDF,label:n._("PDFs"),tooltip:n._("PDF"),icon:"pdf-small"},{category:r.FileCategory.SPREADSHEET,label:n._("Spreadsheets"),tooltip:n._("XLSX, XLS, CSV, and more",{comment:"Intended to represent 3 of the most common file formats for spreadsheets."}),icon:"numbers-small"},{category:r.FileCategory.PRESENTATION,label:n._("Presentations"),tooltip:n._("PPT, PPTX, KEY, and more",{comment:"Intended to represent 3 of the most common file formats for presentations."}),icon:"keynote-small"},{category:r.FileCategory.AUDIO,label:n._("Audio"),tooltip:n._("MP3, WAV, MID, and more",{comment:"Intended to represent 3 of the most common file formats for audio."}),icon:"audio-small"},{category:r.FileCategory.VIDEO,label:n._("Video"),tooltip:n._("MOV, WMV, MP4, and more",{comment:"Intended to represent 3 of the most common file formats for videos."}),icon:"video-small"},{category:r.FileCategory.FOLDER,label:n._("Folders"),tooltip:n._("Dropbox folders"),icon:"folder-small"},{category:r.FileCategory.PAPER,label:n._("Paper docs"),tooltip:n._("Dropbox Paper docs"),icon:"paper-small"},{category:r.FileCategory.OTHER,label:n._("Other"),tooltip:n._("Other file types"),icon:"unknown-small"}],t.FILE_CATEGORIES_NO_PAPER=t.FILE_CATEGORIES_PAPER.filter(function(e){return e.category!==r.FileCategory.PAPER})}),define("modules/clean/search/single_page/input/component",["require","exports","tslib","external/classnames","react","spectrum/button","spectrum/icon_form","spectrum/icon_global","modules/clean/filepath","modules/clean/keycode","modules/clean/react/async/loadable","modules/clean/react/no-jquery","modules/clean/react/retrieval_success_banner/util","modules/clean/search/single_page/navigation","modules/clean/search/store_helpers","modules/core/i18n"],function(e,t,r,n,s,o,i,a,c,l,u,_,p,d,h,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importStar(s),c=r.__importStar(c);var S=u.Loadable({loader:function(){return new Promise(function(t,r){e(["modules/clean/search/single_page/input/chips"],t,r)}).then(r.__importStar).then(function(e){return e.SearchChips})},loading:s.createElement("span",{className:"search-chips"})}),m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hasEmptyQuery=function(){return!h.normalize(t.props.query)},t.handleChange=function(e){t.props.setQuery({query:e.target.value})},t.handleFocus=function(){t.props.onSearchEnter(),p.clearBrowseSuccessBannerCounter(),p.clearBrowseSuccessBannerKey(),p.clearBSBExtraData()},t.handleBlur=function(){t.props.onInputBlur&&t.props.onInputBlur(),t.dimsissQuerySuggestions()},t.hasQuerySuggestions=function(){return t.props.querySuggestions&&t.props.querySuggestions.length},t.dimsissQuerySuggestions=function(){t.hasQuerySuggestions()&&t.props.dismissQuerySuggestions&&t.props.query.length>0&&t.props.dismissQuerySuggestions({query:t.props.query,user:t.props.user})},t.handleSearchExit=function(){d.searchNavigationManager.exit(),t.props.onSearchExit()},t.handleEscape=function(){t.hasQuerySuggestions()&&t.props.query.length>0?t.dimsissQuerySuggestions():(t.handleSearchExit(),t.input&&t.input.blur())},t.handleKeyArrowDown=function(e){if(t.props.querySuggestions&&0!==t.props.querySuggestions.length&&t.props.setSuggestionHighlightRow){var r=void 0===t.props.suggestionHighlightRow?0:Math.min(t.props.suggestionHighlightRow+1,t.props.querySuggestions.length-1);t.props.setSuggestionHighlightRow({index:r}),e.preventDefault()}},t.handleKeyArrowUp=function(e){if(t.props.querySuggestions&&0!==t.props.querySuggestions.length&&t.props.setSuggestionHighlightRow){var r=void 0===t.props.suggestionHighlightRow?t.props.querySuggestions.length-1:Math.max(t.props.suggestionHighlightRow-1,0);t.props.setSuggestionHighlightRow({index:r}),e.preventDefault()}},t.handleKeyEnter=function(e){if(t.hasQuerySuggestions()&&(t.dimsissQuerySuggestions(),void 0!==t.props.suggestionHighlightRow)){var r=t.props.querySuggestions[t.props.suggestionHighlightRow];r&&(t.props.setQuery({query:r.text}),t.input&&t.input.focus(),e.preventDefault())}},t.handleKeyDown=function(e){switch(e.keyCode){case l.KeyCode.ESC:t.handleEscape();break;case l.KeyCode.DOWN:t.handleKeyArrowDown(e);break;case l.KeyCode.UP:t.handleKeyArrowUp(e);break;case l.KeyCode.ENTER:t.handleKeyEnter(e);break;case l.KeyCode.BACKSPACE:t.input&&0===t.input.selectionStart&&!c.paths_are_equal(t.props.path,"/")&&t.props.setPath({path:"/",viewport:"input"})}},t.handleSubmit=function(e){e.preventDefault()},t.handleDocumentClick=function(e){t.props.isActive&&t.hasEmptyQuery()&&e.srcElement&&(_.closestElement(e.srcElement,".maestro-nav__container")||_.closestElement(e.srcElement,".pagelet-top-menu__container")||_.closestElement(e.srcElement,".maestro-header")&&!_.closestElement(e.srcElement,".search__form"))&&t.handleSearchExit()},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){document.addEventListener("click",this.handleDocumentClick,!1),this.props.autoFocus&&this.input&&(this.input.value="",this.input.focus(),this.input.value=this.props.query)},t.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.handleDocumentClick,!1)},t.prototype.componentWillUpdate=function(e){var t=this;!e.isActive&&this.props.isActive&&this.input&&setTimeout(function(){return t.input.blur()},5),e.autoFocus&&!this.props.autoFocus&&this.input&&this.input.focus()},Object.defineProperty(t.prototype,"input",{get:function(){return this.props.inputBoxRef&&this.props.inputBoxRef.current},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.isActive,r=e.query;return s.createElement("div",{className:n.default({search__form:!0,"search__form--is-active":t}),role:"combobox","aria-expanded":t,"aria-haspopup":"listbox","aria-owns":"search-view"},s.createElement(o.Button,{className:"search__exit-button",onClick:this.handleSearchExit,"aria-label":E._("Exit search")},s.createElement(i.IconForm,{name:"cancel"})),s.createElement("form",{onSubmit:this.handleSubmit},s.createElement("span",{className:"search__icon"},s.createElement(a.IconGlobal,{name:"search-small"})),s.createElement(S,{user:this.props.user,path:this.props.path,deletedFiles:!1,setPath:this.props.setPath}),s.createElement("input",{ref:this.props.inputBoxRef,"aria-label":E._("Search"),className:"search__input",maxLength:200,onChange:this.handleChange,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,placeholder:E._("Search your content"),type:"text","aria-autocomplete":"list",value:r})))},t})(s.PureComponent);t.SearchInputComponent=m}),define("modules/clean/search/single_page/input/wrapper",["require","exports","tslib","react","modules/clean/api_v2/user_client","modules/clean/filepath","modules/clean/react/css","modules/clean/search/search_bar/experiments","modules/clean/search/single_page/input/component","modules/clean/search/single_page/navigation","modules/clean/web_timing_logger"],function(e,t,r,n,s,o,i,a,c,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),o=r.__importStar(o);var _=new s.UserApiV2Client,p=(function(t){function s(s){var o=t.call(this,s)||this;return o.loadConnectedInput=function(){return r.__awaiter(o,void 0,void 0,function(){var t,s,o,i,c,u,p,d,h,E,S,m,f,g,C,R,I,T,A,y,O,D,v=this;return r.__generator(this,function(L){switch(L.label){case 0:return[4,Promise.all([new Promise(function(t,r){e(["external/react-redux"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/search/single_page/input/connected"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/search/single_page/input/suggestions"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/search/single_page/data/store"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/search/single_page/data/action_creators"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/search/single_page/data/selectors"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/search/search_bar/data/action_creators"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/search/search_bar/data/selectors"],t,r)}).then(r.__importStar),_.ns("search").rpc("get_experiment_data",void 0,{subjectUserId:this.props.user.id})])];case 1:return t=L.sent(),s=t[0].Provider,o=t[1].ConnectedSearchInput,i=t[2].ConnectedSearchSuggestions,c=t[3].getStoreForSearch,u=t[4],p=u.setQuery,d=u.setUser,h=u.setPath,E=u.updateFromUrl,S=u.setExperiments,m=u.setSessionId,f=t[5].searchBarExperiments,g=t[6],C=g.fetchRecentItems,R=g.fetchQuerySuggestions,I=t[7].searchSessionId,T=t[8],A=T.user_options,y=T.experiments,O=c(),O.dispatch(d({user:this.props.user,options:A})),O.dispatch(h({path:this.props.path})),O.dispatch(m({sessionId:I(O.getState())})),O.dispatch(S({experiments:y})),l.searchNavigationManager.removeListener("update",this.handleUrlUpdate),l.searchNavigationManager.removeListener("exit",this.handleUrlExit),l.searchNavigationManager.addListener("update",function(e){e.query&&!v.props.isActive&&v.props.onSearchEnter(),O.dispatch(E(e))}),l.searchNavigationManager.addListener("exit",function(){O.dispatch(p({query:"",skipSetUrl:!0})),v.props.onSearchExit()}),l.searchNavigationManager.load(),this.state.query&&O.dispatch(p({query:this.state.query})),a.isInRecentFilesExperiment(f(O.getState()))&&O.dispatch(C({user:this.props.user})),a.isInPriorQuerySuggestionsExperiment(f(O.getState()))&&(D=a.getNumOfQuerySuggestionsToFetch(f(O.getState()).expQuerySuggestions),O.dispatch(R({user:this.props.user,query:"",maxResults:D}))),this.renderInput=function(){return n.createElement(s,{store:O},n.createElement(n.Fragment,null,n.createElement(o,r.__assign({},v.props,{autoFocus:v.state.hasFocus,onInputBlur:v.handleInputBlur})),n.createElement(i,{onFocusInput:v.handleFocusInput})))},[2]}})})},o.handleInputBlur=function(){o.setState({hasFocus:!1})},o.handleFocusInput=function(){o.setState({hasFocus:!0})},o.handleUrlUpdate=function(e){e.query&&(o.props.isActive||o.handleSearchEnter(),o.handleSetQuery({query:e.query}))},o.handleUrlExit=function(){o.handleSearchExit()},o.handleSearchEnter=function(){o.setState({hasFocus:!0}),o.props.onSearchEnter()},o.handleSearchExit=function(){o.handleSetQuery({query:""}),o.props.onSearchExit()},o.handleSetQuery=function(e){var t=e.query;o.setState({query:t}),u.get_timer("single_page_search").restart()},o.handleSetPath=function(e){var t=e.path;o.setState({path:t})},o.handleClear=function(){o.setState({query:"",path:""})},o.state={hasReduxStoreLoaded:!1,hasFocus:!1,query:"",path:s.path,querySuggestions:void 0,suggestionHighlightRow:-1},o}return r.__extends(s,t),s.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return l.searchNavigationManager.init(this.props.user),l.searchNavigationManager.addListener("update",this.handleUrlUpdate),l.searchNavigationManager.addListener("exit",this.handleUrlExit),l.searchNavigationManager.load(),0===document.location.pathname.indexOf("/search")?[3,2]:[4,u.waitForTTI()];case 1:e.sent(),e.label=2;case 2:return[4,this.loadConnectedInput()];case 3:return e.sent(),this.setState({hasReduxStoreLoaded:!0}),[2]}})})},s.prototype.componentWillReceiveProps=function(t){return r.__awaiter(this,void 0,void 0,function(){var n,s;return r.__generator(this,function(i){switch(i.label){case 0:return!this.state.hasReduxStoreLoaded||this.props.isActive||o.paths_are_equal(t.path,this.props.path)?[3,3]:[4,new Promise(function(t,r){e(["modules/clean/search/single_page/data/store"],t,r)}).then(r.__importStar)];case 1:return n=i.sent().getStoreForSearch,[4,new Promise(function(t,r){e(["modules/clean/search/single_page/data/action_creators"],t,r)}).then(r.__importStar)];case 2:s=i.sent().setPath,n().dispatch(s({path:t.path,viewport:"input"})),i.label=3;case 3:return[2]}})})},s.prototype.render=function(){return this.state.hasReduxStoreLoaded?this.renderInput():n.createElement(c.SearchInputComponent,r.__assign({},this.props,this.state,{setQuery:this.handleSetQuery,setPath:this.handleSetPath,clear:this.handleClear,onSearchEnter:this.handleSearchEnter,onSearchExit:this.handleSearchExit}))},s})(n.Component);t.SearchInput=i.requireCssWithComponent(p,["/static/css/search/input-vfluiom7T.css","/static/js/retrieval-components/index.web-vfl4qjaZj.css"])}),define("modules/clean/search/single_page/navigation",["require","exports","tslib","external/eventemitter3","modules/clean/browse_uri_interface","modules/clean/query_string_helpers","modules/clean/search/single_page/constants","modules/core/browser","modules/core/i18n"],function(e,t,r,n,s,o,i,a,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var l=(function(e){function t(t,r){var n=e.call(this)||this;return n.lastHistoryMs=0,n.initialPath="",n.setSearchUrl=function(e,t){e!==n.document.location.pathname+n.document.location.search&&(n.returnTo||i.SEARCH_URL_REGEX.test(n.document.location.pathname)||(n.returnTo=n.document.location.pathname+n.document.location.search),t||n.shouldPushHistory()?n.window.history.pushState({},c._("Search results - Dropbox"),e):n.window.history.replaceState({},c._("Search results - Dropbox"),e),n.lastHistoryMs=(new Date).getTime(),n.previousTitle||(n.previousTitle=n.document.title,n.document.title=c._("Search results - Dropbox")))},n.setNonSearchUrl=function(e){n.shouldRedirect(e)?a.redirect(e):(n.window.history.pushState({},n.previousTitle||"",e),n.previousTitle&&(n.document.title=n.previousTitle,n.previousTitle=void 0),n.emit("exit"))},n.handlePopState=function(){i.SEARCH_URL_REGEX.test(n.document.location.pathname)?(n.lastHistoryMs=(new Date).getTime(),n.emit("update",o.parseQueryString(n.document.location.search))):n.shouldRedirect(n.document.location.pathname)?a.reload():n.emit("exit")},n.shouldPushHistory=function(){return(new Date).getTime()-n.lastHistoryMs>=i.SEARCH_HISTORY_DELAY},n.shouldRedirect=function(e){return(!i.HOME_URL_REGEX.test(n.initialPath)||!i.HOME_URL_REGEX.test(e))&&(!i.BROWSE_URL_REGEX.test(n.initialPath)||!i.BROWSE_URL_REGEX.test(e))},n.document=t,n.window=r,n}return r.__extends(t,e),t.prototype.init=function(e){this.user=e,this.initialPath=this.document.location.pathname,this.window.addEventListener("popstate",this.handlePopState)},t.prototype.load=function(){if(i.SEARCH_URL_REGEX.test(this.document.location.pathname)){this.emit("update",o.parseQueryString(this.document.location.search));var e=o.parseQueryString(this.document.location.search);e.search_from&&!i.SEARCH_URL_REGEX.test(e.search_from)&&(this.returnTo=e.search_from)}},t.prototype.set=function(e,t){e&&(i.SEARCH_URL_REGEX.test(e)?this.setSearchUrl(e,t):this.setNonSearchUrl(e))},t.prototype.exit=function(){i.SEARCH_URL_REGEX.test(this.document.location.pathname)&&(this.returnTo&&!i.SEARCH_URL_REGEX.test(this.returnTo)||(this.returnTo=s.get_browse_root(this.user)),this.set(this.returnTo),this.returnTo=void 0)},t})(n.default);t.SearchNavigationManager=l,t.searchNavigationManager=new l(document,window)}),define("modules/clean/search/store_helpers",["require","exports"],function(e,t){"use strict";function r(e){return e.trim().replace(/\ +/g," ")}function n(e){return!r(e)}function s(e,t){return!(n(e)||!n(t))||e.length>=3&&1===t.length}function o(){for(var e="",t=0;t<32;t++){var r=Math.floor(10*Math.random());e+=String(r)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.normalize=r,t.isBlank=n,t.shouldStartNewSearchSession=s,t.generateRandomId=o}),define("modules/clean/search/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchResultTypes={FILE:"FILE",FILE_SHARED_WITH_ME:"FILE_SHARED_WITH_ME",PAPER:"PAPER",PAPER_FOLDER:"PAPER_FOLDER"};(function(e){e.ON="ON",e.OFF="OFF",e.CONTROL="CONTROL"})(t.DeletedFilterRightRailVariants||(t.DeletedFilterRightRailVariants={}));(function(e){e.ON="ON",e.OFF="OFF",e.CONTROL="CONTROL",e.HOLDOUT="HOLDOUT"})(t.SinglePageSearchVariants||(t.SinglePageSearchVariants={}));(function(e){e.POSTERIOR_ONLY_WITH_3_SUGGESTIONS="POSTERIOR_ONLY_WITH_3_SUGGESTIONS",e.POSTERIOR_ONLY_WITH_5_SUGGESTIONS="POSTERIOR_ONLY_WITH_5_SUGGESTIONS",e.PRIOR_ONLY_WITH_3_SUGGESTIONS="PRIOR_ONLY_WITH_3_SUGGESTIONS",e.PRIOR_ONLY_WITH_5_SUGGESTIONS="PRIOR_ONLY_WITH_5_SUGGESTIONS",e.PRIOR_ONLY_WITH_10_SUGGESTIONS="PRIOR_ONLY_WITH_10_SUGGESTIONS",e.FETCH_ONLY_WITH_3_SUGGESTIONS="FETCH_ONLY_WITH_3_SUGGESTIONS",e.FETCH_ONLY_WITH_5_SUGGESTIONS="FETCH_ONLY_WITH_5_SUGGESTIONS",e.OFF="OFF",e.CONTROL="CONTROL",e.HOLDOUT="HOLDOUT"})(t.QuerySuggestionsVariants||(t.QuerySuggestionsVariants={}));(function(e){e.NOT_LOADED="NOT_LOADED",e.LOADING="LOADING",e.LOADED="LOADED",e.DISMISSED="DISMISSED",e.FAILED="FAILED"})(t.QuerySuggestionsLoadingState||(t.QuerySuggestionsLoadingState={}));(function(e){e.V1="V1",e.V2="V2",e.V3="V3",e.OFF="OFF",e.CONTROL="CONTROL",e.HOLDOUT="HOLDOUT"})(t.BrowseSuccessBannerVariants||(t.BrowseSuccessBannerVariants={}));(function(e){e.ON="ON",e.OFF="OFF",e.CONTROL="CONTROL",e.HOLDOUT="HOLDOUT"})(t.PeopleFilterVariants||(t.PeopleFilterVariants={}));(function(e){e.ON="ON",e.OFF="OFF",e.CONTROL="CONTROL"})(t.FileTypeFilterVariants||(t.FileTypeFilterVariants={}));(function(e){e.ON="ON",e.PLACEHOLDER_TEXT="PLACEHOLDER_TEXT",e.HELP_CENTER_LINK="HELP_CENTER_LINK",e.OFF="OFF",e.CONTROL="CONTROL",e.HOLDOUT="HOLDOUT"})(t.ShowHelpLinkVariants||(t.ShowHelpLinkVariants={}));(function(e){e.IMAGE="image",e.DOCUMENT="document",e.PDF="pdf",e.SPREADSHEET="spreadsheet",e.PRESENTATION="presentation",e.AUDIO="audio",e.VIDEO="video",e.FOLDER="folder",e.PAPER="paper",e.OTHER="other"})(t.FileCategory||(t.FileCategory={}));(function(e){e.ON_VIEWED_DATE="ON_VIEWED_DATE",e.ON_MODIFIED_DATE="ON_MODIFIED_DATE",e.OFF="OFF",e.CONTROL="CONTROL",e.HOLDOUT="HOLDOUT"})(t.RecentFilesVariants||(t.RecentFilesVariants={}));(function(e){e.NOT_LOADED="NOT_LOADED",e.LOADING="LOADING",e.LOADED="LOADED",e.FAILED="FAILED"})(t.RecentItemsLoadingState||(t.RecentItemsLoadingState={}));(function(e){e.OFF="OFF",e.IMAGE_PANEL="IMAGE_PANEL",e.SNACKBAR="SNACKBAR",e.TAB="TAB",e.NONE="NONE"})(t.ImageSearchDiscoveryVariants||(t.ImageSearchDiscoveryVariants={}));(function(e){e.IMAGE_TN_ONLY="IMAGE_TN_ONLY",e.OFF="OFF",e.CONTROL="CONTROL",e.HOLDOUT="HOLDOUT"})(t.DropdownImagesThumbnailVariants||(t.DropdownImagesThumbnailVariants={}));(function(e){e.OFF="OFF",e.PREVIEW_ONLY="PREVIEW_ONLY",e.FILE_ACTIONS_1="FILE_ACTIONS_1",e.FILE_ACTIONS_2="FILE_ACTIONS_2",e.FILE_ACTIONS_3="FILE_ACTIONS_3"})(t.DetailsPaneVariants||(t.DetailsPaneVariants={}));(function(e){e.SEARCH_ALL="SEARCH_ALL",e.SCOPE_CHIPS="SCOPE_CHIPS",e.DELETED_FILES="DELETED_FILES"})(t.SearchBarDropdownHeaderItemType||(t.SearchBarDropdownHeaderItemType={}))}),define("modules/clean/sharing/access_level",["require","exports","tslib","external/lodash"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n);(function(e){e[e.ACCESS_NO_ACCESS=0]="ACCESS_NO_ACCESS",e[e.ACCESS_READER_NO_COMMENT=-10]="ACCESS_READER_NO_COMMENT",e[e.ACCESS_READER=1]="ACCESS_READER",e[e.ACCESS_WRITER=2]="ACCESS_WRITER",e[e.ACCESS_OWNER=3]="ACCESS_OWNER"})(t.NameSpaceAccess||(t.NameSpaceAccess={})),t.ACCESS_LEVEL={OWNER:"owner",WRITER:"writer",READER:"reader",READER_NO_COMMENT:"reader_no_comment"},t.ACCESS_VALUES=n.values(t.ACCESS_LEVEL);var s={reader_no_comment:-10,reader:1,writer:2,owner:3};t.isLowerAccess=function(e,r){var n=Object.keys(s);return e!==r&&n.indexOf(e)!==-1&&n.indexOf(r)!==-1&&t.getMaxAccess([e,r])===e},t.getMaxAccess=function(e){if(0===e.length)throw Error("Argument accessLevels are not valid.");for(var t=e[0],r=s[t],n=0;n<e.length;n++){var o=e[n],i=s[o];i>r&&(r=i,t=o)}return t}}),define("modules/clean/upsell/exception",["require","exports","tslib","modules/core/exception","modules/core/xhr"],function(e,t,r,n,s){"use strict";function o(e){var t=e.severity,r=void 0===t?n.SEVERITY.CRITICAL:t;s.sendXhr("/prompt/log_jse",{severity:r})}function reportException(e){var r=e.err,s=e.tags,o=void 0===s?[]:s,i=e.severity,a=void 0===i?n.SEVERITY.CRITICAL:i,c=e.exc_extra,l=void 0===c?{}:c;o.push(t.TAGS.PROMPT),o.push(t.TAGS.MEGAPHONE),n.reportException({err:r,tags:o,severity:a,exc_extra:l}),t.logExceptionRate({severity:a})}function i(e){var r=e.err,s=e.js_controller_options,o=void 0===s?{}:s,i=e.severity,a=void 0===i?n.SEVERITY.CRITICAL:i,c=e.tags,l=void 0===c?[]:c,u={"campaign-name":"campaignName",location:"campaignLocationId"};for(var _ in u)if(u.hasOwnProperty(_)){var p=u[_],d=o[p];d&&l.push("prompt-"+_+"-"+d)}t.reportException({err:r,tags:l,severity:a,exc_extra:o})}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),t.SEVERITY=n.SEVERITY,t.TAGS={MEGAPHONE:"megaphone",PROMPT:"prompt",PROMPT_ADMIN:"prompt-admin",PROMPT_INIT:"prompt-init",LEGACY_TOP_NOTIFICATIONS:"legacy-top-notifications"},t.logExceptionRate=o,t.reportException=reportException,t.reportJsControllerException=i}),define("modules/clean/upsell/legacy_prompt_event_logging",["require","exports","tslib","modules/core/uri","modules/clean/ajax_minimal"],function(e,t,r,n,s){"use strict";function o(e,t){var r={campaign_id:t.campaignId.toString()};if(t.versionId&&(r.campaign_id=t.versionId.toString(),r.version_id=t.versionId.toString()),"number"==typeof t.promptQueriedAtMs&&(r.prompt_queried_at_ms=t.promptQueriedAtMs.toString()),window&&window.performance&&window.performance.now){var s=Math.round(window.performance.now());r.delta_from_request_start_ms=s.toString()}return t.activeUserId&&(r._subject_uid=String(t.activeUserId)),t.requestId&&(r.prompt_parent_request_id=t.requestId),t.eventName&&(r.event_name=t.eventName),void 0!==t.remindMeLater&&(r.remind_me_later=(!!t.remindMeLater).toString()),t.csrfToken&&(r.csrf_token=encodeURIComponent(t.csrfToken)),t.csrfTokenType&&(r.csrf_token_type=encodeURIComponent(t.csrfTokenType)),new n.URI({path:e,query:r})}Object.defineProperty(t,"__esModule",{value:!0}),s=r.__importStar(s),t.LEGACY_EVENT_CONFIRM="db:prompt:confirm",t.LEGACY_EVENT_DISMISS="db:prompt:dismiss",t.LEGACY_EVENT_PRE_CONFIRM="db:prompt:pre-confirm",t.LEGACY_EVENT_PRE_DISMISS="db:prompt:pre-dismiss",t.LEGACY_EVENT_SHOW="db:prompt:show",t.getUpsellControllerURI=o;var i=(function(){function e(e){this.params=e}return e.prototype.logImpression=function(){var e=o("/prompt/log_impression",this.params);s.post(e.toString(),"")},e.prototype.logDismissal=function(){var e=o("/prompt/dismiss",this.params);s.post(e.toString(),"")},e})();t.LegacyEventLogger=i}),define("modules/clean/upsell/prompt_event_emitter",["require","exports","tslib","external/eventemitter3"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var s={ON_HA_LOADED:"ON_HA_LOADED",REACT_HA_DID_UPDATE:"REACT_HA_DID_UPDATE",ON_PROMPT_INITIALIZED:"ON_PROMPT_INITIALIZED"};t.Events=s;var o=new n.default;t.eventEmitter=o;var i=(function(e){function t(){var t=e.call(this)||this;return t.allEventBuffers={},t}return r.__extends(t,e),t.prototype.on=function(t,r){var n=this;e.prototype.on.call(this,t,r);var s=this.allEventBuffers[t];return void 0!==s&&s.forEach(function(e){n.emit(t,e)}),this},t.prototype.emit=function(t,r){return void 0===this.allEventBuffers[t]&&(this.allEventBuffers[t]=[]),this.allEventBuffers[t].push(r),e.prototype.emit.call(this,t,r)},t.prototype.reset=function(){this.allEventBuffers={},this.removeAllListeners()},t})(n.default);t.BufferedEventEmitter=i,window.ensemble&&!window.ensemble.bufferedEventEmitter&&(window.ensemble.bufferedEventEmitter=new i);var a=window.ensemble&&window.ensemble.bufferedEventEmitter?window.ensemble.bufferedEventEmitter:new i;t.promptBufferedEventEmitter=a}),define("modules/clean/upsell/prompt_event_logger",["require","exports","tslib","jquery","modules/clean/ajax","modules/clean/upsell/legacy_prompt_event_logging"],function(e,t,r,n,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importStar(s);var i=(function(){function e(e){this.campaignProps=e}return e.prototype.recordClientImpression=function(){var e=this.getUpsellControllerURI("/prompt/log_impression");this.recordAck(e)},e.prototype.recordConfirm=function(){var e=this.getUpsellControllerURI("/prompt/confirm");this.recordAck(e,"db:prompt:confirm")},e.prototype.recordDismiss=function(e){var t=this.getUpsellControllerURI("/prompt/dismiss",{remindMeLater:e});this.recordAck(t,"db:prompt:dismiss")},e.prototype.recordEvent=function(e){var t=this.getUpsellControllerURI("/prompt/log_event",{eventName:e});this.recordAck(t)},e.prototype.recordAck=function(e,t){var r=this;s.SilentBackgroundRequest({type:"POST",url:e.toString()}).done(function(e){t&&r.triggerExternalEvent(t)})},e.prototype.getUpsellControllerURI=function(e,t){return o.getUpsellControllerURI(e,{campaignId:this.campaignProps.campaign.campaignId,versionId:this.campaignProps.campaign.versionId,activeUserId:this.campaignProps.subjectUser,promptQueriedAtMs:this.campaignProps.promptQueriedAtMs,requestId:this.campaignProps.requestId,csrfToken:this.campaignProps.csrfToken,csrfTokenType:this.campaignProps.csrfTokenType,eventName:t&&t.eventName,remindMeLater:t&&t.remindMeLater})},e.prototype.triggerExternalEvent=function(e){n.default(document).trigger(e,{campaignName:this.campaignProps.campaign.campaignName})},e})();t.PromptEventLogger=i}),define("modules/clean/ux_analytics/UxAnalyticsDispatcher",["require","exports","tslib","modules/clean/ux_analytics/dispatch_custom_event","modules/core/exception"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),t.UXA_HISTORY_CHANGE_EVENT="historyChange";var o=null;t.UxAnalyticsDispatcher={initUrl:function(e){o=e},dispatchHistoryChange:function(e){s.assert(null!==o,"spaChangesToUxa needs an initial URL");var r=o;o=e;var i={detail:{previousUrl:r,url:o}};n.dispatchCustomEvent(t.UXA_HISTORY_CHANGE_EVENT,i)},reset:function(){o=null}}}),define("modules/clean/ux_analytics/dispatch_custom_event",["require","exports"],function(e,t){"use strict";function r(e,t){if(void 0===t&&(t={detail:null}),"function"==typeof CustomEvent)return new CustomEvent(e,t);var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,!0,!0,t.detail),r}function n(e,t){window.dispatchEvent(r(e,t))}Object.defineProperty(t,"__esModule",{value:!0}),t.createCustomEvent=r,t.dispatchCustomEvent=n}),define("modules/clean/web_user_action_events",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.ADD_COMMENT="add_comment",e.ARCHIVE="archive",e.ATTACHMENT_ADD_SUCCESS="attachment_add_success",e.ATTACHMENT_CLICKED="attachment_clicked",e.ATTACHMENT_REMOVED="attachment_removed",e.CALCULATE_SIZE="calculate_size",e.CALENDAR_TAB_CLICKED="calendar_tab_clicked",e.CALENDAR_SUGGESTIONS_REMOVED="calendar_suggestions_removed",e.CLICK_ADD_ATTACHMENT="click_add_attachment",e.CLICK_CONVERT_INDIVIDUAL_ACCOUNT="click_convert_individual_account",e.CLICK_LEARN_MORE_ACCOUNT_CONVERSION="click_learn_more_account_conversion",e.CLICK_PATH_LINK="click_path_link",e.CLICK_REVIEW_SUMMARY_DELETE_USER="click_review_summary_delete_user",e.CONTEXT_MENU="context_menu",e.COPY="copy",e.COPY_ACCEPT_CLICK="copy_accept_click",e.CREATE_FOLDER="create_folder",e.CREATE_FOLDER_CANCEL="create_folder_cancel",e.CREATE_FOLDER_ERROR="create_folder_error",e.CREATE_FOLDER_PENDING="create_folder_pending",e.CREATE_FOLDER_SUCCESS="create_folder_success",e.DISBAND_TEAM_KEEP="disband_team_keep",e.DISBAND_TEAM_LEARN_MORE="disband_team_learn_more",e.DISBAND_TEAM_VIEW="disband_team_view",e.DELETE="delete",e.DELETE_ACCEPT_CLICK="delete_accept_click",e.DOWNLOAD="download",e.EVENTS="events",
e.FILE_VIEW="file_view",e.FILE_UPLOAD_FSW_RETURNED="file_upload_fsw_returned",e.FOLDER_OPEN="folder_open",e.KEYBOARD_SHORTCUT="keyboard_shortcut",e.LEAVE_TEAM_CANCEL="leave_team_cancel",e.LEAVE_TEAM_LEARN_MORE="leave_team_learn_more",e.LEAVE_TEAM_VIEW="leave_team_view",e.LINK_GOOGLE_CAL_CLICKED="link_google_cal_clicked",e.LINK_GOOGLE_CAL_SUCCESS="link_google_cal_success",e.MOVE="move",e.MOVE_ACCEPT_CLICK="move_accept_click",e.OPEN_ADD_TO_COLLECTION_MODAL="open_add_to_collection_modal",e.OPEN_CALENDAR_FLYOUT="open_calendar_flyout",e.OPEN_COPY_MODAL="open_copy_modal",e.OPEN_DELETE_USER_MODAL="open_delete_user_modal",e.OPEN_MOVE_MODAL="open_move_modal",e.OPEN_ROW="open_row",e.PAPER_CONTEXT_MENU="paper_context_menu",e.PAPER_OPEN="paper_open",e.PERMANENT_DELETE="permanent_delete",e.PERMANENT_DELETE_ACCEPT_CLICK="permanent_delete_accept_click",e.RENAME="rename",e.RENAME_REQUEST_SUCCESS="rename_request_success",e.RENAME_REQUEST_FAIL="rename_request_fail",e.RENAME_UNDO="rename_undo",e.RENAME_UNDO_REQUEST_SUCCESS="rename_undo_request_success",e.RENAME_UNDO_REQUEST_FAIL="rename_undo_request_fail",e.RESTORE="restore",e.RESTORE_ACCEPT_CLICK="restore_accept_click",e.SELECT_ROW="select_row",e.SHARE="share",e.SHOW_IN_FOLDER="show_in_folder",e.SORT_RECORDS="sort_records",e.STAR="star",e.REMOVE_STAR="remove_star",e.SWITCH_ACCOUNT="switch_account",e.SWITCH_VIEW_TYPE="switch_view_type",e.TOGGLE_DELETED_FILES="toggle_deleted_files",e.UNMOUNTED_VIEW="unmounted_view",e.VERSIONS="versions",e.VIEW_SHARE_MODEL="view_share_model",e.OPEN_DESKTOP="open_via_unity",e.RESTORE_VERSION="restore_version",e.CONF_BY_REMOVE_MEMBER="conf_by_remove_member",e.CONF_BY_DOWNGRADE_MEMBER="conf_by_downgrade_member",e.CONF_BY_MANAGE_ACCESS="conf_by_manage_access",e.CONF_BY_UNDO_AFTER_RESTORE_ACCESS="conf_by_undo_after_restore_access",e.CONF_BY_CREATE_CONFIDENTIAL_FOLDER="conf_by_create_confidential_folder",e.ADD_MORE_FILES_CLICK="add_more_files_click",e.CLOSE_MODAL_CLICK="close_modal_click",e.DISMISS_INLINE_STATUS="dismiss_inline_status",e.UPLOAD_BUTTON_CLICK="upload_button_click",e.VIEW_DETAILS_CLICK="view_details_click",e.CANCEL_UPLOAD_CLICK="cancel_upload_click",e.UPLOAD_CLICK="upload_click",e.UPLOAD_FILES_CLICK="upload_files_click",e.UPLOAD_FOLDER_CLICK="upload_folder_click",e.CREATE_COLLECTION_SUCCESS="create_collection_success",e.CREATE_COLLECTION_FAIL="create_collection_fail",e.FILE_CREATE_OPEN_MENU="file_create_open_menu",e.FILE_CREATE_WORD="file_create_word",e.FILE_CREATE_POWERPOINT="file_create_powerpoint",e.FILE_CREATE_EXCEL="file_create_excel",e.FILE_CREATE_HOME_FOLDER_SELECTED="file_create_home_folder_selected",e.FILE_CREATE_SUCCESS="file_create_success",e.FILE_CREATE_PAPER="file_create_paper",e.FILE_CREATE_GOOGLE_DOC="file_create_google_doc",e.FILE_CREATE_GOOGLE_SHEET="file_create_google_sheet",e.FILE_CREATE_GOOGLE_SLIDES="file_create_google_slides",e.FILE_CREATE_SIMPLE_POINTER="file_create_simple_pointer",e.FILE_OPEN_PROMPT_ACTION="file_open_prompt_action",e.PREPARE_FOR_SIGNATURE="prepare_for_signature",e.FOLDER_OVERVIEW_TOGGLED="folder_overview_toggled",e.FOLDER_OVERVIEW_EDITED="folder_overview_edited",e.FOLDER_OVERVIEW_DESCRIPTION_SAVE="folder_overview_description_save",e.FOLDER_OVERVIEW_UNPIN="folder_overview_unpin",e.FOLDER_OVERVIEW_PIN="folder_overview_pin",e.FOLDER_OVERVIEW_PIN_CLICK="folder_overview_pin_click",e.PAGE_VIEW="page_view"})(t.WebUserActionLogEvent||(t.WebUserActionLogEvent={}));(function(e){e.SHARED_FOLDER="shared folder",e.FILE_FOLDER="file folder",e.EVERYONE_GROUP_VIEW_ACCESS="everyone group view access",e.SPECIFIC_PEOPLE="specific people",e.BROWSE="browse",e.CONTENT_MANAGER="content manager"})(t.WebUserActionLogExtraValue||(t.WebUserActionLogExtraValue={}));(function(e){e.OVERFLOW_MENU="overflow_menu",e.RIGHT_SIDEBAR="right_sidebar"})(t.ActionSurfaceLogValue||(t.ActionSurfaceLogValue={}))}),define("modules/clean/web_user_action_logger",["require","exports","tslib","modules/clean/ajax"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),t.MAX_ERRORS=3;var s=(function(){function e(){this.errorCount=0,this.lastError=Date.now(),this.shouldReport=!0}return e.prototype.log=function(e,r,s){var o=this;return this.shouldReport&&(this.errorCount<t.MAX_ERRORS||Date.now()-this.lastError>6e5)?new Promise(function(i,a){n.SilentBackgroundRequest({url:"/log/web_user_action",data:{_subject_uid:e,event_type:r,extra_params:JSON.stringify(s)},error:function(e){429===e.status?o.errorCount=t.MAX_ERRORS:o.errorCount++,o.lastError=Date.now(),a(e)},success:function(e){try{var t=JSON.parse(e);t&&!t.continue_sending&&(o.shouldReport=!1),o.errorCount=0,i(e)}catch(e){throw o.errorCount++,o.lastError=Date.now(),a(e),e}}})}):Promise.resolve({})},e})();t.WebUserActionLogClass=s,t.WebUserActionLog=new s});
//# sourceMappingURL=pkg-embedded_app.min.js-vflBOnwAn.map