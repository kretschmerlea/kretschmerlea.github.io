define(["require","exports","tslib","modules/clean/open_with","modules/clean/file_store/utils","modules/clean/react/file_viewer/constants","modules/clean/react/file_viewer/open_button/types","modules/clean/react/file_viewer/unity/unity_utils","modules/clean/react/file_viewer/open_with_helpers","modules/clean/react/paper/utils","modules/clean/react/file_viewer/data/actions","modules/core/i18n","modules/clean/react/extensions/utils","modules/clean/react/extensions/connect_flow","modules/clean/cloud_docs/open_with_utils"],function(e,n,i,t,o,r,l,s,u,a,p,c,d,f,_){"use strict";function h(e){var n=e.file,t=i.__rest(e,["file"]);return o.isBrowseFile(n)?m(i.__assign({file:n},t)):o.isSharedFile(n)?v(i.__assign({file:n},t)):[]}function O(e,n,t,o){var s;if(o.provider===_.OpenWithCloudDocProvider.GoogleDSS)s={type:l.OpenButtonAction.OPEN_WITH_CLOUD_DOC,userAction:r.UserAction.OpenWithCloudDocEditor};else{if(o.provider!==_.OpenWithCloudDocProvider.OfficeOnline)return null;s={type:l.OpenButtonAction.OPEN_WITH,userAction:r.UserAction.OpenInOfficeOnline}}return i.__assign({handler:function(){return o.handler(e,n,t)},spriteName:o.spriteName||null,iconUrl:o.iconUrl,text:o.text},s)}function v(e){for(var n=e.file,i=e.user,t=e.isOpenWithDisabled,o=[],r={gdd:!e.isCloudEditorDisabled,wopi:I({file:n,isOpenWithDisabled:t,user:i})},l=e.actionSource,s=_.getOpenWithCloudEditorInfo(n,i,r,l),u=0,a=s;u<a.length;u++){var p=a[u],c=O(n,i,l,p);c&&o.push(c)}return o}function m(e){var n=e.file,i=e.hasOpenInPaperSupport,t=e.isUnityDisabled,o=e.isOpenWithDisabled,s=e.isCloudEditorDisabled,u=e.unityInfo,a=e.extraOptions,h=e.user,v=e.sharingServiceInfo,m=e.refreshSharingServiceInfo,S=e.showOpenWithShare,E=e.onPresentInZoom,N=e.isCloudBasedDoc,W=e.actionSource,g=e.landingPagesEnabled;if(!u)return[];var F=[];i&&F.push({handler:b({file:n,user:h}),spriteName:"paper",text:c._("Copy to Paper"),type:l.OpenButtonAction.OPEN_IN_PAPER,userAction:r.UserAction.CopyToPaper}),!N&&A({isUnityDisabled:t,unityInfo:u})&&F.push({handler:U({file:n,user:h,isFolder:!1}),spriteName:"ow_desktop",text:w(u),type:l.OpenButtonAction.UNITY_FILE,userAction:r.UserAction.OpenInUnity});for(var P=I({file:n,isOpenWithDisabled:o,user:h}),C={gdd:!s,wopi:P},B=_.getOpenWithCloudEditorInfo(n,h,C,W),x=0,T=B;x<T.length;x++){var H=T[x],k=O(n,h,W,H);k&&F.push(k)}y({isUnityDisabled:t,unityInfo:u})&&F.push({handler:U({file:n,user:h,isFolder:!0}),spriteName:"ow_folder",text:D(u),type:l.OpenButtonAction.UNITY_FOLDER,userAction:r.UserAction.OpenInUnityFolder}),a&&a.forEach(function(e){e&&F.push(e)}),F.length||N||F.push({handler:function(){return p.download(n)},spriteName:null,text:c._("Download"),type:l.OpenButtonAction.DOWNLOAD,userAction:r.UserAction.Download});var L=!1,Z=!1;return S&&v&&(L=d.isSlackAvailable(v),Z=d.isZoomAvailable(v)),L&&v&&m&&F.push({handler:function(){return f.shareInSlackFlow(h,v,m,n,"open_with_button",void 0!==g?g:null)},spriteName:null,text:c._("Slack"),type:l.OpenButtonAction.SHARE_TO_SLACK,userAction:r.UserAction.ShareToSlack}),Z&&v&&E&&m&&F.push({handler:function(){return f.presentInZoomFlow(h,v,m,n,E,"open_with_button",void 0!==g?g:null)},spriteName:null,text:c._("Zoom"),type:l.OpenButtonAction.PRESENT_IN_ZOOM,userAction:r.UserAction.PresentInZoom}),F}function y(e){var n=e.isUnityDisabled,i=e.unityInfo;return null!=i&&!n&&s.UnityHelpers.isUnityFolderSupported(i)}function A(e){var n=e.isUnityDisabled,i=e.unityInfo;return null!=i&&!n&&s.UnityHelpers.isUnityFileSupported(i)}function I(e){var n=e.file,i=e.isOpenWithDisabled,t=e.user;return!i&&u.OpenWithHelpers.canOpenWith(n,t)}function w(e){var n=(e?e.open_application_name:void 0)||c._("Desktop");return c._("Open in %(app_name)s").format({app_name:n})}function D(e){var n=(null!==e?e.file_browser_display_name:void 0)||c._("File Browser");return c._("Show in %(file_browser)s").format({file_browser:n})}function U(e){var n=e.file,i=e.isFolder,t=e.user;return function(){s.UnityHelpers.openFile(n.ns_id,n.ns_path,t.id,i)}}function b(e){var n=e.file,i=e.user;return function(){a.openFileInPaper({file:n,user:i})}}function S(e,n){var i=e.map(function(e){return e.type}).includes(l.OpenButtonAction.UNITY_FILE),o=n&&t.default.is_adobe_app(n.open_application_identifier),r=e.map(function(e){return e.type}).includes(l.OpenButtonAction.OPEN_WITH);return i&&o||r}Object.defineProperty(n,"__esModule",{value:!0}),t=i.__importDefault(t),n.getOpenOptions=h,n.convertOpenWithCloudEditorInfo=O,n.getOpenOptionsSharedFile=v,n.shouldShowCoachmark=S});
//# sourceMappingURL=utils.min.js-vflEeA1dJ.map