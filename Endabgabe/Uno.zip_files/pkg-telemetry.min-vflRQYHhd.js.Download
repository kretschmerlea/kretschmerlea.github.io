define("modules/clean/logging/compression",["require","exports"],function(e,t){"use strict";function i(){return new s}Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(){}return e.prototype.inflate=function(e){return e},e.prototype.deflate=function(e){return e},e})();t.IdentityCodec=s,t.getBestCompressionCodec=i}),define("modules/clean/logging/hive/schemas/web-user-action",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(e){this.category="web-user-action",this.session_id=null,this.user_id=null,this.team_id=null,this.on_maestro=!0,this.extra={},this.ua_browser_name=null,this.ua_browser_version=null,this.ua_dist_name=null,this.ua_dist_version=null,this.ua_os_name=null,this.ua_os_version=null,this.authed_user_ids=null,this.identity_gid=null,this.anon_ip=null,this.active_user_id=null,this.team_type=null,this.locale_browser_header=null,this.locale_user_selected=null,this.referrer=null,this.user_agent=null,this.country=null,e.hasOwnProperty("event_name")&&void 0!==e.event_name&&(this.event_name=e.event_name),e.hasOwnProperty("session_id")&&void 0!==e.session_id&&(this.session_id=e.session_id),e.hasOwnProperty("source")&&void 0!==e.source&&(this.source=e.source),e.hasOwnProperty("user_id")&&void 0!==e.user_id&&(this.user_id=e.user_id),e.hasOwnProperty("team_id")&&void 0!==e.team_id&&(this.team_id=e.team_id),e.hasOwnProperty("on_maestro")&&void 0!==e.on_maestro&&(this.on_maestro=e.on_maestro),e.hasOwnProperty("extra")&&void 0!==e.extra&&(this.extra=e.extra),e.hasOwnProperty("ua_browser_name")&&void 0!==e.ua_browser_name&&(this.ua_browser_name=e.ua_browser_name),e.hasOwnProperty("ua_browser_version")&&void 0!==e.ua_browser_version&&(this.ua_browser_version=e.ua_browser_version),e.hasOwnProperty("ua_dist_name")&&void 0!==e.ua_dist_name&&(this.ua_dist_name=e.ua_dist_name),e.hasOwnProperty("ua_dist_version")&&void 0!==e.ua_dist_version&&(this.ua_dist_version=e.ua_dist_version),e.hasOwnProperty("ua_os_name")&&void 0!==e.ua_os_name&&(this.ua_os_name=e.ua_os_name),e.hasOwnProperty("ua_os_version")&&void 0!==e.ua_os_version&&(this.ua_os_version=e.ua_os_version),e.hasOwnProperty("authed_user_ids")&&void 0!==e.authed_user_ids&&(this.authed_user_ids=e.authed_user_ids),e.hasOwnProperty("identity_gid")&&void 0!==e.identity_gid&&(this.identity_gid=e.identity_gid),e.hasOwnProperty("timestamp")&&void 0!==e.timestamp&&(this.timestamp=e.timestamp),e.hasOwnProperty("anon_ip")&&void 0!==e.anon_ip&&(this.anon_ip=e.anon_ip),e.hasOwnProperty("active_user_id")&&void 0!==e.active_user_id&&(this.active_user_id=e.active_user_id),e.hasOwnProperty("team_type")&&void 0!==e.team_type&&(this.team_type=e.team_type),e.hasOwnProperty("locale_browser_header")&&void 0!==e.locale_browser_header&&(this.locale_browser_header=e.locale_browser_header),e.hasOwnProperty("locale_user_selected")&&void 0!==e.locale_user_selected&&(this.locale_user_selected=e.locale_user_selected),e.hasOwnProperty("referrer")&&void 0!==e.referrer&&(this.referrer=e.referrer),e.hasOwnProperty("user_agent")&&void 0!==e.user_agent&&(this.user_agent=e.user_agent),e.hasOwnProperty("country")&&void 0!==e.country&&(this.country=e.country),e.hasOwnProperty("view_type")&&void 0!==e.view_type&&(this.view_type=e.view_type),e.hasOwnProperty("file_nsid")&&void 0!==e.file_nsid&&(this.file_nsid=e.file_nsid),e.hasOwnProperty("file_sjid")&&void 0!==e.file_sjid&&(this.file_sjid=e.file_sjid),e.hasOwnProperty("file_id")&&void 0!==e.file_id&&(this.file_id=e.file_id),e.hasOwnProperty("file_name")&&void 0!==e.file_name&&(this.file_name=e.file_name),e.hasOwnProperty("file_path")&&void 0!==e.file_path&&(this.file_path=e.file_path),e.hasOwnProperty("file_size")&&void 0!==e.file_size&&(this.file_size=e.file_size),e.hasOwnProperty("file_extension")&&void 0!==e.file_extension&&(this.file_extension=e.file_extension),e.hasOwnProperty("request_id")&&void 0!==e.request_id&&(this.request_id=e.request_id),e.hasOwnProperty("upload_id")&&void 0!==e.upload_id&&(this.upload_id=e.upload_id),e.hasOwnProperty("all_fsw_ids")&&void 0!==e.all_fsw_ids&&(this.all_fsw_ids=e.all_fsw_ids),e.hasOwnProperty("filtered_fsw_ids")&&void 0!==e.filtered_fsw_ids&&(this.filtered_fsw_ids=e.filtered_fsw_ids),e.hasOwnProperty("browser_width")&&void 0!==e.browser_width&&(this.browser_width=e.browser_width),e.hasOwnProperty("browser_height")&&void 0!==e.browser_height&&(this.browser_height=e.browser_height),e.hasOwnProperty("device_width")&&void 0!==e.device_width&&(this.device_width=e.device_width),e.hasOwnProperty("device_height")&&void 0!==e.device_height&&(this.device_height=e.device_height),Object.seal(this)}return e})();t.WebUserActionRow=i}),define("modules/clean/logging/sender",["require","exports","tslib","modules/core/xhr","modules/clean/ajax","modules/clean/web_timing_logger"],function(e,t,i,s,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=i.__importStar(s);t.MAX_REPORT_ATTEMPTS=4;var o={NoContent:204},a=(function(){function e(e,t,i){var s=this;this.store=e,this.sendInterval=t,this.batchSize=i,this.numSuccessfulPublish=0,this.numFailedPublish=0,this.sentAtTTI=!1,this.scheduleNextSend(Date.now()),n.waitForTTI().then(function(){s.sendOnce(),s.sentAtTTI=!0})}return e.prototype.drainAllLogs=function(){null!=this.nextSendTimeoutId&&clearTimeout(this.nextSendTimeoutId),this.sendOnce(!0)},e.prototype.sendOnce=function(e){void 0===e&&(e=!1);var t=this.store.drain(this.batchSize);Object.keys(t).length>0&&this.publish(t,e);var i=Date.now();this.scheduleNextSend(i),this.lastSendTime=i},e.prototype.publish=function(e,t){var i=this;void 0===t&&(t=!1);var n={},a={};if(Object.keys(e).forEach(function(t){var i=e[t].map(function(e){return e.records()});n[t]=JSON.stringify([].concat.apply([],i))}),a["data-version"]="1",a.batches=JSON.stringify(n),a.stats=this.store.stats.getAndReset(),t&&"navigator"in window&&"sendBeacon"in window.navigator)return void r.SilentBackgroundBeaconRequest({url:"/log/telemetry",data:a});var _=function(t){t===o.NoContent?i.onSendSuccess(e):i.onSendFailure(e)};s.sendXhr("/log/telemetry",a,_)},e.prototype.scheduleNextSend=function(e){var t=this;this.nextSendTime=e+this.sendInterval,this.nextSendTimeoutId=setTimeout(function(){t.sendOnce()},this.sendInterval)},e.prototype.onSendSuccess=function(e){this.numSuccessfulPublish++,window.SECRET_LOGGING_FRAMEWORK_CALLBACK_DO_NOT_USE&&window.SECRET_LOGGING_FRAMEWORK_CALLBACK_DO_NOT_USE(e)},e.prototype.onSendFailure=function(e){this.numFailedPublish++;for(var i in e)if(e.hasOwnProperty(i))for(var s=0,r=e[i];s<r.length;s++){var n=r[s];n.markFailure(),n.numReportAttempts<t.MAX_REPORT_ATTEMPTS&&this.store.reEnqueueBatch(i,n)}},e})();t.Sender=a}),define("modules/clean/logging/storage",["require","exports","tslib"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_MESSAGES_IN_BATCH=100;var s=(function(){function e(){this.stats=new r}return e})();t.EventStorage=s;var r=(function(){function e(){this.rate_stats={}}return e.prototype._val=function(e,t){return e.hasOwnProperty(t)?e[t]:0},e.prototype.onPushEvent=function(e){for(var t=0,i=["*",e];t<i.length;t++){var s=i[t],r="enqueue:"+s;this.rate_stats[r]=this._val(this.rate_stats,r)+1}},e.prototype.onDrain=function(e){var t=0;for(var i in e)if(e.hasOwnProperty(i)){var s=e[i].map(function(e){return e.size()}).reduce(function(e,t){return e+t},0),r="dequeue:"+i;this.rate_stats[r]=this._val(this.rate_stats,r)+s,t+=s}this.rate_stats["dequeue:*"]=this._val(this.rate_stats,"dequeue:*")+t},e.prototype.onReEnqueueBatch=function(e,t){for(var i=0,s=["*",e];i<s.length;i++){var r=s[i],n="reEnqueue:"+r;this.rate_stats[n]=this._val(this.rate_stats,n)+t.size()}},e.prototype.getAndReset=function(){var e=JSON.stringify({"rate-stats":this.rate_stats});return this.rate_stats={},e},e})(),n=(function(e){function s(t){var i=e.call(this)||this;return i.compressionCodec=t,i.existing_batches={},i}return i.__extends(s,e),s.prototype._append_batch_to_category=function(e,t){this.existing_batches[e]||(this.existing_batches[e]=[]),this.existing_batches[e].push(t)},s.prototype._get_or_create_batch=function(e){var t=this.existing_batches[e];return t&&0!==t.length||(this._add_new_batch_for_category(e),t=this.existing_batches[e]),t[t.length-1]},s.prototype._add_new_batch_for_category=function(e){var i=new o(e,t.MAX_MESSAGES_IN_BATCH,this.compressionCodec);return this._append_batch_to_category(e,i),i},s.prototype.pushEvent=function(e,t){var i=JSON.parse(JSON.stringify(t));this.stats.onPushEvent(e),this._get_or_create_batch(e).tryAppend(i)||this._add_new_batch_for_category(e).tryAppend(i)},s.prototype.reEnqueueBatch=function(e,t){return this.stats.onReEnqueueBatch(e,t),this._append_batch_to_category(e,t)},s.prototype.drain=function(e){var t=e,i={};for(var s in this.existing_batches)if(this.existing_batches.hasOwnProperty(s)){if(t<=0)break;var r=this.existing_batches[s].splice(0,t);if(t-=r.length,r.length>0){for(var n=0,o=r;n<o.length;n++){var a=o[n];a.close()}i[s]=r}}return this.stats.onDrain(i),i},s})(s);t.WindowStorage=n;var o=(function(){function e(e,t,i){this.category=e,this.maxMessages=t,this.compressionCodec=i,this.numReportAttempts=0,this.messages=[]}return e.prototype.isFull=function(){return this.messages.length>=this.maxMessages},e.prototype.size=function(){return this.messages.length},e.prototype.tryAppend=function(e){return!this.isFull()&&!this.closed&&(this.messages.push(e),this.isFull()&&this.close(),!0)},e.prototype.close=function(){this.closed||(this.closed=!0)},e.prototype.records=function(){return this.messages},e.prototype.markFailure=function(){if(!this.closed)throw new Error("Attempted to send an open batch");this.numReportAttempts++},e})();t.MessageBatch=o}),define("modules/clean/logging/telemetry",["require","exports","tslib","modules/clean/logging/storage","modules/clean/logging/compression","modules/clean/logging/sender","modules/core/browser"],function(e,t,i,s,r,n,o){"use strict";function a(){return c||(c=new l),c}Object.defineProperty(t,"__esModule",{value:!0});var _=(function(){function e(e){this.prefix=e}return e.prototype.log=function(e){a().storage.pushEvent(this.prefix+e.category,e)},e})(),h=(function(e){function t(){return e.call(this,"js:")||this}return i.__extends(t,e),t})(_);t.JSEventLogger=h;var u=(function(e){function t(){return e.call(this,"hive:")||this}return i.__extends(t,e),t})(_);t.HiveLogger=u;var d=(function(e){function t(){return e.call(this,"vortexcombo:")||this}return i.__extends(t,e),t})(_);t.VortexComboLogger=d;var l=(function(){function e(){var e=this,t=r.getBestCompressionCodec();this.storage=new s.WindowStorage(t),this.sender=new n.Sender(this.storage,5e3,1),o.onBrowserRedirect(function(t){e.drainAllLogs()}),window.addEventListener("beforeunload",function(){e.drainAllLogs()})}return e.prototype.drainAllLogs=function(){this.sender.drainAllLogs()},e})();t.ClientTelemetry=l;var c;t.getGlobalTelemetrySingleton=a});
//# sourceMappingURL=pkg-telemetry.min.js-vfly2wRnx.map